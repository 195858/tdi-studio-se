<%@ jet 
    imports="
        org.talend.designer.codegen.config.NodesSubTree
        org.talend.core.model.process.INode
        java.util.List
        java.util.HashSet
        java.util.Set
        java.util.Map
        java.util.Vector
        org.talend.core.model.process.IProcess
        org.talend.core.model.process.EConnectionType
        org.talend.core.model.process.IConnection
        org.talend.core.model.metadata.IMetadataTable 
        org.talend.core.model.metadata.IMetadataColumn
        org.talend.designer.codegen.config.CodeGeneratorArgument
        org.talend.core.model.metadata.types.JavaTypesManager
        org.talend.core.model.metadata.types.JavaType
        org.talend.core.model.process.ElementParameterParser
        org.talend.core.model.process.IHashableInputConnections
        org.talend.core.model.process.IHashConfiguration
        org.talend.core.model.process.IHashableColumn
        org.talend.core.model.utils.NodeUtil
        org.talend.core.model.process.IConnectionCategory
        org.talend.core.model.process.AbstractNode
    " 
%>
	<%
    CodeGeneratorArgument codeGenArgument = (CodeGeneratorArgument) argument;
    Vector v = (Vector) codeGenArgument.getArgument();
    INode mrconn = (INode)v.get(0);
    NodesSubTree subTree = (NodesSubTree)v.get(1);
    AbstractNode abRootNode = (AbstractNode)subTree.getRootNode();

	INode firstNode = subTree.getNode(subTree.getName());
	List< ? extends IConnection> conns = firstNode.getOutgoingSortedConnections();
	String firstConnName = "";
	if(conns != null && conns.size()>0){
		IConnection conn = conns.get(0);
		if (conn.getLineStyle().hasConnectionCategory(IConnectionCategory.DATA)) {
			firstConnName = conn.getName();
		}
	}
	if(!"".equals(firstConnName)){
		if(subTree.getNodes().size() > 1){
		%>
			runMRJob(job, <%=abRootNode.getMRGroupId()%>, <%=abRootNode.getMrJobIDInGroup()%>);
		<%
		}
	}
	%>
	

