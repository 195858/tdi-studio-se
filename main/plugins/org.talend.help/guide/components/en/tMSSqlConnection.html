<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tMSSqlConnection</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tos-components-rg-en..html" title="Talend Open Studio Components"><link rel="up" href="ch-databases-traditional.html" title="Chapter&nbsp;7.&nbsp;Databases - traditional components"><link rel="prev" href="tMSSqlCommit.html" title="tMSSqlCommit"><link rel="next" href="tMSSqlInput.html" title="tMSSqlInput"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">tMSSqlConnection</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tMSSqlCommit.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;7.&nbsp;Databases - traditional components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="tMSSqlInput.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="tMSSqlConnection"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tMSSqlConnection"></a>tMSSqlConnection</h2></div></div></div><div class="mediaobject"><img src="../images/tMSSqlConnection_icon32.png"></div><div class="section" title="tMSSqlConnection properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e82990"></a>tMSSqlConnection properties</h3></div></div></div><p>This component is closely related to <span class="emphasis"><strong>tMSSqlCommit</strong></span> and
				<span class="emphasis"><strong>tMSSqlRollback</strong></span>. Both components are usually used
			with a <span class="emphasis"><strong>tMSSqlConnection</strong></span> component to open a connection
			for the current transaction.</p><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Component family</strong></span>
							</p>
						</td><td valign="top">
							<p>Databases/MSSQL</p>
						</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>tMSSqlConnection</strong></span> opens a
								connection to the database for a current transaction.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>This component allows you to commit all of the Job data to an
								output database in just a single transaction, once the data has been
								validated.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Property type</em></span>
							</p>
						</td><td valign="top">
							<p><span>Either <span class="emphasis"><strong>Built-in</strong></span> or <span class="emphasis"><strong>Repository</strong></span></span>.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><strong>Built-in</strong></span>: No property data stored
								centrally.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><strong>Repository</strong></span>: Select the repository
								file in which the properties are stored. The fields that follow are
								completed automatically using the data retrieved.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Host</em></span>
							</p>
						</td><td valign="top">
							<p>Database server IP address.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Port</em></span>
							</p>
						</td><td valign="top">
							<p>Listening port number of DB server. </p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Schema</em></span>
							</p>
						</td><td valign="top">
							<p>Schema name.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Database</em></span>
							</p>
						</td><td valign="top">
							<p>Name of the database.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Username</em></span> and
								<span class="emphasis"><em>Password</em></span></p>
						</td><td valign="top">
							<p>DB user authentication data.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Additional JDBC parameters</em></span>
							</p>
						</td><td valign="top">
							<p>Specify additional connection properties for the DB connection you
								are creating.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Use or register a shared DB Connection</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to share your connection or fetch a
								connection shared by a parent or child Job. This allows you to share
								one single DB connection among several DB connection components from
								different Job levels that can be either parent or child. </p>
							<div lang="" class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>This option is incompatible with the <span class="emphasis"><strong>Use dynamic job</strong></span>
            and <span class="emphasis"><strong>Use an independent process to run subjob</strong></span> options of
            the <span class="emphasis"><strong>tRunJob</strong></span> component. Using a shared database
            connection together with a <span class="emphasis"><strong>tRunJob</strong></span> component with
            either of these two options enabled will cause your Job to fail.</p></div>
							<p>
								<span class="emphasis"><strong>Shared DB Connection Name:</strong></span> set or
								type in the shared connection name.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Advanced settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Auto commit</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to automatically commit a transaction when
								it is completed.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>tStatCatcher Statistics</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to gather the job processing metadata at a
								Job level as well as at each component level.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>This component is to be used along with MSSql components,
								especially with <span class="emphasis"><strong>tMSSqlCommit</strong></span> and
									<span class="emphasis"><strong>tMSSqlRollback</strong></span>.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>
								<span>n/a</span></p>
							
						</td></tr></tbody></table></div></div><div class="section" title="Scenario: Inserting data into a database table and extracting useful information from it"><div class="titlepage"><div><div><h3 class="title"><a name="d0e83353"></a>Scenario: Inserting data into a database table and extracting useful information from
			it</h3></div></div></div><p>The scenario describes a Job that reads the employee data from a text file, inserts the data
			into a table of an MSSQL database, then extracts useful data from the table, and
			displays the information on the console.</p><p>
			</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection.png"></div><p>
		</p><p>This scenario involves the following components:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><strong>tMSSqlConnection</strong></span>: establishes a connection to
					the MSSQL server.</p></li><li class="listitem"><p><span class="emphasis"><strong>tFileInputDelimited</strong></span>: reads the input file,
					defines the data structure and sends it to the next component.</p></li><li class="listitem"><p><span class="emphasis"><strong>tMSSqlOutput</strong></span>: writes data it receives from
					the preceding component into a table of an MSSQL database.</p></li><li class="listitem"><p><span class="emphasis"><strong>tMSSqlInput</strong></span>: extracts data from the table
					based on an SQL query.</p></li><li class="listitem"><p><span class="emphasis"><strong>tLogRow</strong></span>: displays the information it receives
					from the preceding component on the console.</p></li><li class="listitem"><p><span class="emphasis"><strong>tMSSqlCommit</strong></span>: commits the transaction in the
					connected MSSQL server.</p></li></ul></div><div class="section" title="Setting up the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e83397"></a>Setting up the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop the following components from the <span class="emphasis"><strong>Palette</strong></span> onto the design workspace: <span class="emphasis"><strong>tMSSqlConnection</strong></span>, <span class="emphasis"><strong>tFileInputDelimited</strong></span>, <span class="emphasis"><strong>tMSSqlOutput</strong></span>, <span class="emphasis"><strong>tMSSqlInput</strong></span>,
							<span class="emphasis"><strong>tLogRow</strong></span>, and <span class="emphasis"><strong>tMSSqlCommit</strong></span>.</p></li><li class="step" title="Step 2"><p>Connect <span class="emphasis"><strong>tMSSqlConnection</strong></span> to <span class="emphasis"><strong>tFileInputDelimited</strong></span> using a <span class="emphasis"><strong>Trigger</strong></span> &gt; <span class="emphasis"><strong>OnSubjobOk</strong></span>
						link.</p></li><li class="step" title="Step 3"><p>Do the same to connect <span class="emphasis"><strong>tFileInputDelimited</strong></span> to <span class="emphasis"><strong>tMSSqlInput</strong></span> and <span class="emphasis"><strong>tMSSqlInput</strong></span>
						to <span class="emphasis"><strong>tMSSqlCommit</strong></span>.</p></li><li class="step" title="Step 4"><p>Connect <span class="emphasis"><strong>tFileInputDelimited</strong></span> to <span class="emphasis"><strong>tMSSqlOutput</strong></span> using a <span class="emphasis"><strong>Row</strong></span>
						&gt; <span class="emphasis"><strong>Main</strong></span> link.</p></li><li class="step" title="Step 5"><p>Do the same to connect <span class="emphasis"><strong>tMSSqlInput</strong></span> to
							<span class="emphasis"><strong>tLogRow</strong></span>.</p></li></ol></div></div><div class="section" title="Configuring the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e83479"></a>Configuring the components</h4></div></div></div><div class="procedure" title="Procedure&nbsp;7.1.&nbsp;Opening a connection to the MSSQL server"><a name="d0e83482"></a><p class="title"><b>Procedure&nbsp;7.1.&nbsp;Opening a connection to the MSSQL server</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tMSSqlConnection</strong></span>
						component to open its <span class="emphasis"><strong>Basic settings</strong></span> view
						in the<span class="emphasis"><strong>Component</strong></span> tab.</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection1.png"></div></li><li class="step" title="Step 2"><p>In the <span class="emphasis"><strong>Host</strong></span> field, type in the IP address
						or hostname of the MSSQL server, <span class="emphasis"><em>192.168.30.47</em></span> in this example.</p></li><li class="step" title="Step 3"><p>In the <span class="emphasis"><strong>Port</strong></span> field, type in the port
						number of the database server, <span class="emphasis"><em>1433</em></span> in
						this example.</p></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Schema</strong></span> field, type in the schema
						name, <span class="emphasis"><em>dbo</em></span> in this example.</p></li><li class="step" title="Step 5"><p>In the <span class="emphasis"><strong>Database</strong></span> field, type in the
						database name, <span class="emphasis"><em>talend</em></span> in this
						example.</p></li><li class="step" title="Step 6"><p>In the <span class="emphasis"><strong>Username</strong></span> and <span class="emphasis"><strong>Password</strong></span> fields, enter the credentials for the MSSQL
						connection.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;7.2.&nbsp;Reading the input data"><a name="d0e83545"></a><p class="title"><b>Procedure&nbsp;7.2.&nbsp;Reading the input data</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tFileInputDelimited</strong></span>
						component to open its <span class="emphasis"><strong>Component</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection2.png"></div></li><li class="step" title="Step 2"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to the <span class="emphasis"><strong>File Name/Stream</strong></span> field to browse to the input file. In this
						example, it is <span class="emphasis"><em>D:/Input/Employee_Wage.txt</em></span>. This text file holds three columns:
							<span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>name</em></span> and <span class="emphasis"><em>wage</em></span>.
						</p><pre class="programlisting">id;name;wage
51;Harry;2300
40;Ronald;3796
17;Theodore;2174
21;James;1986
2;George;2591
89;Calvin;2362
84;Ulysses;3383
4;Lyndon;2264
17;Franklin;1780
86;Lyndon;3999</pre></li><li class="step" title="Step 3"><p>In the <span class="emphasis"><strong>Header</strong></span> field, type in <span class="emphasis"><em>1</em></span> to skip the first row of the input
						file.</p></li><li class="step" title="Step 4"><p>Click <span class="emphasis"><strong>Edit schema</strong></span> to define the data to
						pass on to the <span class="emphasis"><strong>tMSSqlOutput</strong></span> component. In
						this example, we define <span class="emphasis"><em>id</em></span> as the key,
						and specify the length and precision for each column respectively.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to close the schema editor. A
						dialog box opens, and you can choose to propagate the schema to the next
						component.</p><p>
						</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection3.png"></div><p>
					</p><p>Related topic: <a class="xref" href="tFileInputDelimited.html" title="tFileInputDelimited">the section called &#8220;tFileInputDelimited&#8221;</a>.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;7.3.&nbsp;Writing the data into the database table"><a name="d0e83619"></a><p class="title"><b>Procedure&nbsp;7.3.&nbsp;Writing the data into the database table</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tMSSqlOutput</strong></span> component
						to open its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><p>
						</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection4.png"></div><p>
					</p></li><li class="step" title="Step 2"><p>Type in required information for the connection or use the existing connection you have
						configured before. In this example, we select the <span class="emphasis"><strong>Use
							an existing connection</strong></span> check box. If multiple connections are
						available, select the connection you want to use from the <span class="emphasis"><strong>Component List</strong></span> drop-down list.</p></li><li class="step" title="Step 3"><p>In the <span class="emphasis"><strong>Table</strong></span> field, type in the name of the table you
						want to write the data to: <span class="emphasis"><em>Wage_Info</em></span> in
						this example. You can also click the <span class="emphasis"><strong>[...]</strong></span>
						button next to the <span class="emphasis"><strong>Table</strong></span> field to open a
						dialog box and select a proper table.</p></li><li class="step" title="Step 4"><p>Select <span class="emphasis"><strong>Create table if not exists</strong></span> from
						the <span class="emphasis"><strong>Action on table</strong></span> drop-down list. </p></li><li class="step" title="Step 5"><p>Select <span class="emphasis"><strong>Insert if not exists</strong></span> from the
							<span class="emphasis"><strong>Action on data</strong></span> drop-down list.</p></li><li class="step" title="Step 6"><p>Click <span class="emphasis"><strong>Sync columns</strong></span> to retrieve the schema
						from the preceding component.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;7.4.&nbsp;Extracting useful information from the table"><a name="d0e83688"></a><p class="title"><b>Procedure&nbsp;7.4.&nbsp;Extracting useful information from the table</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tMSSqlInput</strong></span> component to
						open its <span class="emphasis"><strong>Basic settings</strong></span> view in the
							<span class="emphasis"><strong>Component</strong></span> tab.</p><p>
						</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection5.png"></div><p>
					</p></li><li class="step" title="Step 2"><p>Select the <span class="emphasis"><strong>Use an existing connection</strong></span> check box. If
						multiple connections are available, select the connection you want to use
						from the <span class="emphasis"><strong>Component List</strong></span> drop-down
						list.</p></li><li class="step" title="Step 3"><p>Click <span class="emphasis"><strong>Edit schema</strong></span> to define the data
						structure to be read from the table. In this example, we need to read all
						three columns from the table.</p><p>
						</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection6.png"></div><p>
					</p></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Table Name</strong></span> field, type in the name of the table
						you want to read the data from: <span class="emphasis"><em>Wage_Info</em></span>
						in this example.</p></li><li class="step" title="Step 5"><p>In the <span class="emphasis"><strong>Query</strong></span> field, fill in the SQL query
						to be executed on the table specified. To obtain the data of employees whose
						wages are above the average value and order them by id, enter the SQL query
						as
						follows:</p><pre class="programlisting">SELECT    * 
FROM      Wage_Info
WHERE     wage &gt;
(SELECT   avg(wage)
FROM      Wage_Info)
ORDER BY  id
</pre></li></ol></div><div class="procedure" title="Procedure&nbsp;7.5.&nbsp;Displaying information on the console"><a name="d0e83747"></a><p class="title"><b>Procedure&nbsp;7.5.&nbsp;Displaying information on the console</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tLogRow</strong></span> component to
						open its <span class="emphasis"><strong>Basic settings</strong></span> view.</p></li><li class="step" title="Step 2"><p>In the <span class="emphasis"><strong>Mode</strong></span> area, select <span class="emphasis"><strong>Table (print values in cells of a table)</strong></span>.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;7.6.&nbsp;Committing the transaction and closing the connection"><a name="d0e83768"></a><p class="title"><b>Procedure&nbsp;7.6.&nbsp;Committing the transaction and closing the connection</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tMSSqlCommit</strong></span> component
						to open its <span class="emphasis"><strong>Basic settings</strong></span> view.</p><p>
						</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection7.png"></div><p>
					</p></li><li class="step" title="Step 2"><p>Select the <span class="emphasis"><strong>Close Connection</strong></span> check
						box.</p></li></ol></div></div><div class="section" title="Saving and executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e83792"></a>Saving and executing the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save your Job.</p></li><li class="step" title="Step 2"><p>Execute the Job by pressing <span class="emphasis"><strong>F6</strong></span> or
						clicking <span class="emphasis"><strong>Run</strong></span> on the <span class="emphasis"><strong>Run</strong></span> tab.</p><p>The information of employees whose wages are above the average value ordered by id is
						displayed on the console.</p><p>
						</p><div class="mediaobject"><img src="../images/use_case_tmssqlconnection8.png"></div><p>
					</p></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tMSSqlCommit.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-databases-traditional.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="tMSSqlInput.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">tMSSqlCommit&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tos-components-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;tMSSqlInput</td></tr></table></div></body></html>