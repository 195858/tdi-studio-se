<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" "http://www.w3.org/MarkUp/Wilbur/HTML32.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="GENERATOR" content="Quadralay WebWorks Publisher Standard Edition 8.0.5337.0">
    <meta name="TEMPLATEBASE" content="Dynamic HTML">
    <meta name="LASTUPDATED" content="05/22/09 11:50:55">
    <title>A.3	FSLang</title>
  </head>

  <body link="#3366CC" vlink="#9999CC" text="#000000" alink="#0000CC" bgcolor="#FFFFFF">

    <!--table width="220" border="0" align="right" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a accesskey="4" href="Components05-3.html"><img id="LongDescNotReq1" src="images/prev.gif" border="0" alt="Previous" /></a><a accesskey="5" href="Components05-5.html"><img id="LongDescNotReq2" src="images/next.gif" border="0" alt="Next" /></a>
        </td>
      </tr>
    </table-->

    <!--img src="images/wwplogo.gif" width="122" height="63" alt="Put your logo here!">
    <hr align="left"-->

    <blockquote>
<a name="wp1538119"> </a><h2 class="pHeading1">
A.3	FSLang
</h2>
<a name="wp1535626"> </a><p class="pBodyRelative">
FSLang is the domain specific language which is embedded into FileScale. It allows to manipulate data during the sort process or to define specific option of the FileScale application. In particular, it helps to remove duplicates.
</p>
<a name="wp1535628"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 18pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
There are two ways to make FileScale interprets an FSLang program:
</div>
<a name="wp1535646"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 36pt; margin-right: 14pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: -11pt; text-transform: none">
·	using &quot;<code class="cCode">--stlang-file fn</code>&quot; command line option, the program is inside the file named &quot;<code class="cCode">fn</code>&quot;,
</div>
<a name="wp1535663"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 36pt; margin-right: 14pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: -11pt; text-transform: none">
·	using &quot;<code class="cCode">--stlang-string str</code>&quot; command line option, the program is written in the string &quot;<code class="cCode">str</code>&quot;.
</div>
<a name="wp1535669"> </a><h2 class="pHeading2">
A.3.1	Comment
</h2>
<a name="wp1535674"> </a><p class="pIndented1">
A comment begins with &quot;#&quot; and ends at the end of the line.
</p>
<a name="wp1535680"> </a><h2 class="pHeading2">
A.3.2	Data types
</h2>
<a name="wp1535683"> </a><p class="pIndented1">
Data types in FSLang are used to describe very precisely the extent of a value. The main purpose of this is to be able to compress data before sorting. This helps to have a more efficient sort process.
</p>
<a name="wp1535687"> </a><p class="pIndented1">
Most of the complex types can be written using general syntax or abbreviated syntax, which is a shorthand for a general syntax construct
</p>
<a name="wp1535694"> </a><h3 class="pHeading3">
Integers
</h3>
<a name="wp1535700"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">int&lt;low limit, high limit&gt;</code>&quot;. Low limit and high limit can be either an integer (e.g. &quot;1234567890&quot;) or undefined &quot;...&quot;. For example, &quot;<code class="cCode">int&lt;0, 1024&gt;</code>&quot; describe an integer between 0 and 1024.
</p>
<a name="wp1535707"> </a><p class="pIndented2">
There is no limit on integer, they can be as big as required. But you must take into account that there is a big performance drawback to use integer larger than the standard integer for the current CPU architecture. The solution is to use by default the &quot;<code class="cCode">int</code>&quot; abbreviated type (no &quot;<code class="cCode">&lt;&quot; and &quot;&gt;</code>&quot;)
</p>
<a name="wp1535718"> </a><p class="pIndented2">
Other abbreviated types are:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1535729"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">int</code>&quot;, &quot;<code class="cCode">uint</code>&quot;: integer that fits with CPU architecture (63 bits on 64 bits, 31 bits on 32 bits CPU),</li></div>
<a name="wp1535737"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">native_int</code>&quot;: natural size of integer (64 bits on 64 bits, 32 bits on 32 bits CPU),</li></div>
<a name="wp1535764"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">int8</code>&quot;, &quot;<code class="cCode">uint8</code>&quot;, &quot;<code class="cCode">int16</code>&quot;, &quot;<code class="cCode">uint16</code>&quot;, &quot;<code class="cCode">int32</code>&quot;, &quot;<code class="cCode">uint32</code>&quot;, &quot;<code class="cCode">int64</code>&quot;, &quot;<code class="cCode">uint64</code>&quot;: different bit length for signed and unsigned int,</li></div>
<a name="wp1535772"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">medium_int</code>&quot;: intermediate big integer, the extent depends on platform word size,</li></div>
<a name="wp1535780"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">big_int</code>&quot;: no limit.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1535786"> </a><p class="pIndented2">
Computing on integer in FSLang can only be done on &quot;<code class="cCode">int</code>&quot; and above values. Typically, it is not possible to add two big_int or two int64 on 32 bits CPU.
</p>
<a name="wp1535794"> </a><h3 class="pHeading3">
Strings
</h3>
<a name="wp1535800"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">string&lt;size_min, size_max&gt;</code>&quot;. The minimum size must be an integer and the maximum size can be undefined &quot;<code class="cCode">...</code>&quot; or an integer. For example: &quot;<code class="cCode">string&lt;0, 10&gt;</code>&quot; describes a string with 0 to 10 characters. 
</p>
<a name="wp1535818"> </a><p class="pIndented2">
The only abbreviated type is &quot;<code class="cCode">string</code>&quot; which is a shorthand for &quot;<code class="cCode">string&lt;0, ...</code>&gt;&quot;.
</p>
<a name="wp1535824"> </a><h3 class="pHeading3">
Floats
</h3>
<a name="wp1535831"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">float</code>&quot;.
</p>
<a name="wp1535834"> </a><p class="pIndented2">
Floating number is IEEE 754 standard, with 53 bits of mantissa and an exponent ranging from -1022 to 1023. This is a double precision floating point.
</p>
<a name="wp1535838"> </a><p class="pIndented2">
You must be aware, that this is a CPU floating point number and not fixed point number. Computing with it should add errors to the result, due to related IEEE standard. Typically, trying to add very different floating numbers can lead to a loss. For example &quot;3.0E100 + 1.0 = 3.0E100&quot;. However, sorting with it does not add errors.
</p>
<a name="wp1535846"> </a><h3 class="pHeading3">
Bool
</h3>
<a name="wp1535853"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">bool</code>&quot;. 
</p>
<a name="wp1535864"> </a><p class="pIndented2">
Boolean value can only take two values: &quot;<code class="cCode">true</code>&quot; and &quot;<code class="cCode">false</code>&quot;.
</p>
<a name="wp1535870"> </a><h3 class="pHeading3">
Enum
</h3>
<a name="wp1535880"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">enum&lt;val1, val2, ..., valX</code>&gt;&quot;, where &quot;<code class="cCode">valX</code>&quot; are strings.
</p>
<a name="wp1535883"> </a><p class="pIndented2">
The purpose of this data type is to define a subset of strings. It can be used as a string and in this case, the associated type is &quot;<code class="cCode">string&lt;min_size, max_size&gt;</code>&quot;, with &quot;<code class="cCode">min_size</code>&quot; and &quot;<code class="cCode">max_size</code>&quot; representing the minimum and maximum length of &quot;<code class="cCode">valX</code>&quot;.
</p>
<a name="wp1535910"> </a><p class="pIndented2">
For example: &quot;<code class="cCode">enum&lt;&quot;TRUE&quot;, &quot;FALSE&quot;&gt;</code>&quot; is a string that can only be &quot;<code class="cCode">TRUE</code>&quot; or &quot;<code class="cCode">FALSE</code>&quot;
</p>
<a name="wp1535916"> </a><h3 class="pHeading3">
Characters
</h3>
<a name="wp1535924"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">char</code>&quot;. It can be any of the ASCII characters.
</p>
<a name="wp1535930"> </a><h3 class="pHeading3">
Array
</h3>
<a name="wp1535942"> </a><p class="pIndented2">
The general syntax is &quot;<code class="cCode">type[max_size]</code>&quot; where &quot;<code class="cCode">max_size</code>&quot; can be undefined &quot;<code class="cCode">...</code>&quot; or an integer and &quot;<code class="cCode">type</code>&quot; is another data type.
</p>
<a name="wp1535958"> </a><p class="pIndented2">
For example: &quot;<code class="cCode">string[10]</code>&quot; is an array of a 10 &quot;<code class="cCode">string</code>&quot;.
</p>
<a name="wp1535964"> </a><h2 class="pHeading2">
A.3.3	statement
</h2>
<a name="wp1535967"> </a><p class="pIndented1">
An FSLang program is made of a suite of statements, each separated by &quot;;&quot;. You can have function definitions, procedure definitions and flow control structure as in a usual programming language.
</p>
<a name="wp1535971"> </a><p class="pIndented1">
Some statements can only appear outside a function or a procedure. These are called top level statements.
</p>
<a name="wp1535978"> </a><h3 class="pHeading3">
Expression
</h3>
<a name="wp1535981"> </a><p class="pIndented2">
An expression is a combination of data, variable and operation that end up with a value. For example &quot;<code class="cCode">1 + 1</code>&quot; is an expression that return a value &quot;<code class="cCode">2</code>&quot;. The type of the resulting value is computed by merging the return value of each sub-expression.
</p>
<a name="wp1535991"> </a><p class="pIndented2">
By default, no transtyping is done into FSLang. If an operator applies to two floats and a float and an integer are provided, its an error. You must define your own transtyping using built-in functions (float_of_int, ceil, floor).
</p>
<a name="wp1535996"> </a><p class="pIndented2">
Available operators are:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536008"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">or</code>&quot;, &quot;<code class="cCode">and</code>&quot;: takes 2 boolean values and combines them into one boolean value,</li></div>
<a name="wp1536029"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">&lt;=</code>&quot;, &quot;<code class="cCode">&gt;=</code>&quot;, &quot;<code class="cCode">&lt;</code>&quot;, &quot;<code class="cCode">&gt;</code>&quot;, &quot;<code class="cCode">=</code>&quot;, &quot;<code class="cCode">!=</code>&quot;: comparison between two integers or two floats, return a boolean value,</li></div>
<a name="wp1536040"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">eq</code>&quot;, &quot;<code class="cCode">ne</code>&quot;: comparison between two strings, return a boolean value,</li></div>
<a name="wp1536056"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">+</code>&quot;, &quot;<code class="cCode">-</code>&quot;, &quot;<code class="cCode">*</code>&quot;, &quot;<code class="cCode">/</code>&quot;: operation on two floats or two integers, return a float or an integer,</li></div>
<a name="wp1536064"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">not</code>&quot;: boolean negation, takes a boolean and returns a boolean.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536067"> </a><p class="pIndented2">
A previously defined variable can be used in an expression. For array, you can access a specific element in an array using the general syntax &quot;<code class="cCode">varname[expr]</code>&quot; where &quot;<code class="cCode">expr</code>&quot; will be evaluated to define the numeric index.
</p>
<a name="wp1536078"> </a><p class="pIndented2">
Raw values can be used in an expression:
</p>
<a name="wp1536090"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 72pt; margin-right: 14pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: -11pt; text-transform: none">
·	<code class="cCode">[0-9]*</code> is an integer, e.g. &quot;<code class="cCode">1234</code>&quot;,
</div>
<a name="wp1536103"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 72pt; margin-right: 14pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: -11pt; text-transform: none">
·	<code class="cCode">[0-9]+.[0-9]*(E[0-9]+)?</code> is a float, e.g <code class="cCode">&quot;1.0</code>&quot; and &quot;<code class="cCode">3.1E10</code>&quot;,
</div>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536125"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">...</code>&quot; is a string, using &quot;<code class="cCode">\</code>&quot; to escape characters like &quot;<code class="cCode">\n</code>&quot;, &quot;<code class="cCode">\t</code>&quot;, &quot;<code class="cCode">\</code>&quot;&quot;, &quot;<code class="cCode">\\</code>&quot;,</li></div>
<a name="wp1536132"> </a><div class="pSmartList3"><li>&#39;<code class="cCode">.</code>&#39; is a character, escaped the same way as strings,</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536140"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 72pt; margin-right: 14pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: -11pt; text-transform: none">
·	<code class="cCode">[...; ...]</code> is an array,
</div>
<a name="wp1536144"> </a><p class="pIndented2">
The type assigned by the type checker follows a short list of rules:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536152"> </a><div class="pSmartList3"><li>a raw value is assigned to the smaller possible type, e.g. integer &quot;<code class="cCode">1234</code>&quot; assigned type is &quot;<code class="cCode">int&lt;1234, 1234&gt;</code>&quot;, string &quot;<code class="cCode">abcd</code>&quot; assigned type is &quot;<code class="cCode">enum&lt;&quot;abcd&quot;&gt;</code>&quot;,</li></div>
<a name="wp1536168"> </a><div class="pSmartList3"><li>an array uses the smallest possible merge of underlying type: array &quot;<code class="cCode">[1; 2; 3]</code>&quot; assigned type is &quot;<code class="cCode">int&lt;1, 3&gt;</code>&quot;, array &quot;<code class="cCode">[&quot;a&quot;; &quot;bcd&quot;]</code>&quot; assigned type is &quot;<code class="cCode">enum&lt;&quot;a&quot;, &quot;bcd&quot;&gt;[2]</code>&quot;,</li></div>
<a name="wp1536182"> </a><div class="pSmartList3"><li>a function is assigned to its return type,</li></div>
<a name="wp1536197"> </a><div class="pSmartList3"><li>the operator can have an effect on range: &quot;<code class="cCode">a + b</code>&quot; where &quot;<code class="cCode">a</code>&quot; is &quot;<code class="cCode">int&lt;0, 10&gt;</code>&quot; and &quot;<code class="cCode">b</code>&quot; is &quot;<code class="cCode">int&lt;2, 15&gt;</code>&quot; is assigned to type &quot;<code class="cCode">int&lt;2, 25&gt;</code>&quot;.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536208"> </a><p class="pIndented2">
The rule about operator is very important since the division can lead to a division by zero meaning that you can really get big resulting value. However, result of integer arithmetic is always limited to &quot;int&quot; (meaning that infinity does not exist, it is always a value within &quot;int&quot;).
</p>
<a name="wp1536216"> </a><h3 class="pHeading3">
Function and procedure
</h3>
<a name="wp1536221"> </a><p class="pIndented2">
The general syntax of a function is &quot;<code class="cCode">function type name (type_arg1 arg1, type_arg2 arg2, ...) { blk }</code>&quot; where &quot;<code class="cCode">type</code>&quot; is the return type of the function and each &quot;<code class="cCode">type_argX&quot;/&quot;argX</code>&quot; defines a type and a variable for an argument.
</p>
<a name="wp1536234"> </a><p class="pIndented2">
The general syntax of a procedure is &quot;<code class="cCode">procedure name (type_arg1 arg1, type_arg2 arg2, ...) { blk }</code>&quot;. A procedure does not return anything.
</p>
<a name="wp1536239"> </a><p class="pIndented2">
A function should always return data. It should use a return statement to return data, and a return statement should always appear in every possible control flow of a function. The general syntax for a return is &quot;<code class="cCode">return expr</code>&quot;. It is an error to have a return statement outside a function.
</p>
<a name="wp1536249"> </a><p class="pIndented2">
A function can be called within an expression using the general syntax &quot;<code class="cCode">name(expr1, expr2, ...)</code>&quot; where &quot;<code class="cCode">name</code>&quot; is the name of the function to call and &quot;<code class="cCode">exprX</code>&quot; the value of its argument.
</p>
<a name="wp1536259"> </a><p class="pIndented2">
A procedure is called the same way as a function but cannot be included in an expression, it must be a statement.
</p>
<a name="wp1536267"> </a><h3 class="pHeading3">
Variable definition and assignment
</h3>
<a name="wp1536276"> </a><p class="pIndented2">
The general syntax to define a variable is &quot;<code class="cCode">type name = expr</code>&quot; where &quot;<code class="cCode">expr</code>&quot; is an expression which result will be assigned to the variable &quot;<code class="cCode">name</code>&quot;.
</p>
<a name="wp1536287"> </a><p class="pIndented2">
The general syntax to assign a variable is &quot;<code class="cCode">name = expr</code>&quot;.
</p>
<a name="wp1536290"> </a><p class="pIndented2">
Note that the type is statically checked when assigning an expression value to a variable. The variable must have a type compatible with the value.
</p>
<a name="wp1536298"> </a><h3 class="pHeading3">
Control flow branch
</h3>
<a name="wp1536307"> </a><p class="pIndented2">
The general syntax of an if statement is &quot;<code class="cCode">if expr then { blk1 } else { blk2 }</code>&quot; where &quot;<code class="cCode">expr</code>&quot; is a boolean expression and &quot;<code class="cCode">blk1</code>&quot; and &quot;<code class="cCode">blk2</code>&quot; are lists of statements executed depending on the boolean value.
</p>
<a name="wp1536321"> </a><h3 class="pHeading3">
Control flow loop
</h3>
<a name="wp1536327"> </a><p class="pIndented2">
The general syntax of a for statement is &quot;<code class="cCode">for name = expr1 to expr2 do { blk } done</code>&quot; where &quot;<code class="cCode">name</code>&quot; is the name of an &quot;<code class="cCode">int</code>&quot; variable and &quot;<code class="cCode">expr1</code>&quot; is the initial value of this variable and &quot;<code class="cCode">expr2</code>&quot; is its final value, &quot;<code class="cCode">blk</code>&quot; is a list of statements to be executed.
</p>
<a name="wp1536351"> </a><p class="pIndented2">
The variable &quot;<code class="cCode">name</code>&quot; will be incremented by 1 at each loop.
</p>
<a name="wp1536357"> </a><h3 class="pHeading3">
Toplevel
</h3>
<a name="wp1536360"> </a><p class="pIndented2">
Toplevel statement are fields, keys, procedure and function definitions. It is also possible to use an <em class="cEmphasis">include statement</em> that will include textually another file into the current file.
</p>
<a name="wp1536377"> </a><p class="pIndented2">
The general syntax of an <em class="cEmphasis">include statement </em>is &quot;<code class="cCode">include &quot;file</code>&quot;&quot; where <em class="cEmphasis">file</em> is the file to include.
</p>
<a name="wp1536380"> </a><p class="pIndented2">
The file to include is looked for in default locations, knowing that the first default location is always the directory of the current file.
</p>
<a name="wp1536388"> </a><h3 class="pHeading3">
Builtin functions
</h3>
<a name="wp1536392"> </a><p class="pIndented2">
A built-in function is a classical function which is defined by default into the language.
</p>
<a name="wp1536396"> </a><p class="pIndented2">
Here is the list of built-in functions:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536404"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">append</code>&quot;: add a value at the end of an array and return the resulting array, the initial array is left untouched, example &quot;<code class="cCode">int a[...] = append([1], 2);</code>&quot;,</li></div>
<a name="wp1536418"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">array_length</code>&quot;: return the size of an array, example &quot;<code class="cCode">array_length([1; 2])</code>&quot;,</li></div>
<a name="wp1536427"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">sprintf</code>&quot;, &quot;<code class="cCode">printf</code>&quot;: these two functions take a constant string format as the first argument that defines the type and number of their arguments. This string format is then used to compose a string with the argument and return a string or print data to standard error output. Available format arguments are &quot;<code class="cCode">%d</code>&quot;, &quot;<code class="cCode">%f</code>&quot;, &quot;<code class="cCode">%b</code>&quot;, &quot;<code class="cCode">%s</code>&quot;, &quot;<code class="cCode">%c</code>&quot;, &quot;<code class="cCode">%%</code>&quot; which represents an integer, a float, a bool, a string, a char or a &quot;<code class="cCode">%</code>&quot;. Example &quot;<code class="cCode">sprintf(&quot;%d-%f&quot;, 1, 2.0)</code>&quot;,</li></div>
<a name="wp1536491"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">sqrt</code>&quot;, &quot;<code class="cCode">exp</code>&quot;, &quot;<code class="cCode">log</code>&quot;, &quot;<code class="cCode">log10</code>&quot;, &quot;<code class="cCode">cos</code>&quot;, &quot;<code class="cCode">sin</code>&quot;, &quot;<code class="cCode">tan</code>&quot;, &quot;<code class="cCode">acos</code>&quot;, &quot;<code class="cCode">asin</code>&quot;, &quot;<code class="cCode">atan</code>&quot;, &quot;<code class="cCode">cosh</code>&quot;, &quot;<code class="cCode">sinh</code>&quot;, &quot;<code class="cCode">tanh</code>&quot;, &quot;<code class="cCode">ceil</code>&quot;, &quot;<code class="cCode">floor</code>&quot;, &quot;<code class="cCode">abs_float</code>&quot;: standard operations on floating point numbers,</li></div>
<a name="wp1536512"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">float_of_int</code>&quot;: converts an integer to a float.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536518"> </a><p class="pIndented2">

</p>
<a name="wp1536524"> </a><h2 class="pHeading2">
A.3.4	Sort definition
</h2>
<a name="wp1536528"> </a><p class="pIndented1">
FSLang provides two keywords to define how to sort a file:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<a name="wp1536534"> </a><div class="pSmartList2"><li>field: define a field, as in a key, that is the extent of a key in a record,</li></div>
<a name="wp1536539"> </a><div class="pSmartList2"><li>key: define a sorting key.</li></div>
</ul></div>
</ul></div>
<a name="wp1536545"> </a><h3 class="pHeading3">
Field
</h3>
<a name="wp1536554"> </a><p class="pIndented2">
The general syntax of a field is &quot;<code class="cCode">field type name { varname = value; ... }</code>&quot; where &quot;<code class="cCode">type</code>&quot; is the type of field and the &quot;<code class="cCode">varname&quot;/&quot;value</code>&quot; pair is data associated to a field.
</p>
<a name="wp1536562"> </a><p class="pIndented2">
The type of a field can only be a string, enum, integer or float.
</p>
<a name="wp1536566"> </a><p class="pIndented2">
The possible variable names are:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536575"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">start_field</code>&quot;: the field in the record to start at,</li></div>
<a name="wp1536584"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">start_char</code>&quot;: offset in the <em class="cEmphasis">start_field</em> to start at, first character is numbered 1 and is the default one,</li></div>
<a name="wp1536592"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">start_ignore_blank</code>&quot;: if set to true, it ignores blank when looking for the first character,</li></div>
<a name="wp1536599"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">end_field</code>&quot;: field in the record to end at,</li></div>
<a name="wp1536608"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">end_char</code>&quot;: offset in the <em class="cEmphasis">end_field</em> to end at, if not set, it will go by default to the last character of the end_field,</li></div>
<a name="wp1536616"> </a><div class="pSmartList3"><li>&quot;e<code class="cCode">nd_ignore_blank</code>&quot;: if set to true, it ignores blank when looking for the first character,</li></div>
<a name="wp1536625"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">open_ended</code>&quot;: if set to true and <em class="cEmphasis">end_field</em> is not set, it ends at the end of the record, the by default is to end at the start field if <em class="cEmphasis">end_field</em> is not set.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536636"> </a><p class="pIndented2">
There is a link between key definition and POSIX &quot;<code class="cCode">-k</code>&quot; option. If we accept POSIX option related to sort order, we have a direct match between POSIX key definition and field definition.
</p>
<a name="wp1536686"> </a><p class="pBodyRelative">
</p>
<div align="center">
<table border="1" id="wp1536642table1536640">
  <caption></caption>
  <tr align="center">    <th><a name="wp1536642"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: bold; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: center; text-decoration: none; text-indent: 0pt; text-transform: none">
FSLang
</div>
</th>
    <th><a name="wp1536644"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: bold; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: center; text-decoration: none; text-indent: 0pt; text-transform: none">
POSIX
</div>
</th>
</tr>
  <tr align="left">    <td><a name="wp1536646"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<code class="cCode">field string zip<br />{<br />     start_field = 1;<br />};</code>
</div>
</td>
    <td><a name="wp1536654"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 24pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<br /><code class="cCode">-k 1,1</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp1536656"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<code class="cCode">field int zip<br />{<br />     start_field = 1;<br />     start_ignore_blank = true;<br />};</code>
</div>
</td>
    <td><a name="wp1536664"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<br /><code class="cCode"><br />-k 1b,1</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp1536666"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<code class="cCode">field string line<br />{<br />     start_field = 1;<br />     open_ended = true;<br />};</code>
</div>
</td>
    <td><a name="wp1536674"> </a><div class="pCellBody">
<br /><br /><code class="cCode">-k 1</code>
</div>
</td>
</tr>
  <tr align="left">    <td><a name="wp1536676"> </a><div style="color: #000000; font-size: 10pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 0pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<code class="cCode">field string second_field_third_char<br />{<br />     start_field = 1;<br />     start_char = 3;<br />     };</code>
</div>
</td>
    <td><a name="wp1536684"> </a><div class="pCellBody">
<br /><code class="cCode">-k 1.3</code>
</div>
</td>
</tr>
</table>
</div>
<p class="pBodyRelative">

</p>
<a name="wp1536689"> </a><p class="pIndented2">
A field can be also used as a function. In this case, a field declaration is equivalent to a function definition, taking a single argument &quot;<code class="cCode">string record</code>&quot; and returning data of the type of the field.
</p>
<a name="wp1536700"> </a><h3 class="pHeading3">
Key
</h3>
<a name="wp1536707"> </a><p class="pIndented2">
The general syntax of a key is &quot;<code class="cCode">key name { varname = value; ... }</code>&quot;.
</p>
<a name="wp1536711"> </a><p class="pIndented2">
Possible variables attached to a key are:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536723"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">key_field</code>&quot;: field associated to the key, this must be the name of a defined &quot;<code class="cCode">field</code>&quot;,</li></div>
<a name="wp1536729"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">priority</code>&quot;: higher priority means that the key is more significant to the sort order. If two keys have the same priority, FileScale uses the one defined first.</li></div>
<a name="wp1536739"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">type</code>&quot;: how to sort, this can be &quot;<code class="cCode">ascii</code>&quot; to sort following standard ASCII order or &quot;<code class="cCode">numeric</code>&quot; to sort using numeric value. It is possible to sort an integer field with an ASCII order. Numeric order is the POSIX &quot;<code class="cCode">-n</code>&quot; option,</li></div>
<a name="wp1536752"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">only_blank_alpha</code>&quot;: takes into consideration only blank and alphanumeric chars, this is the POSIX &quot;<code class="cCode">-d</code>&quot; option,</li></div>
<a name="wp1536762"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">case_insensitive</code>&quot;: transforms ASCII char into lowercase before comparing it, this is the POSIX &quot;<code class="cCode">-f</code>&quot; option,</li></div>
<a name="wp1536775"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">ignore_non_printable</code>&quot;: ignores char that cannot be printerd, this is the POSIX &quot;<code class="cCode">-i</code>&quot; option,</li></div>
<a name="wp1536788"> </a><div class="pSmartList3"><li>&quot;<code class="cCode">reverse</code>&quot;: reverses order of comparison, this is the POSIX &quot;<code class="cCode">-r</code>&quot; option.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536794"> </a><h3 class="pHeading3">
Entrypoints
</h3>
<a name="wp1536797"> </a><p class="pIndented2">
These are functions that can be called during the sort process. If one of these functions is defined in an FSLang file, it will replace the default behavior.
</p>
<a name="wp1536802"> </a><p class="pIndented2">
There are three entrypoints in FSLang:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<a name="wp1536808"> </a><div class="pSmartList3"><li>input functions,</li></div>
<a name="wp1536812"> </a><div class="pSmartList3"><li>reduce functions,</li></div>
<a name="wp1536817"> </a><div class="pSmartList3"><li>output functions.</li></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536823"> </a><h4 class="pHeading4">
Input/output functions
</h4>
<a name="wp1536829"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 72pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<code class="cCode">function bool input_filter (string record)</code><br /><code class="cCode">function string input_process (string record)</code><br /><code class="cCode">function bool output_filter (string record)</code><br /><code class="cCode">unction string output_process (string record)</code>
</div>
<a name="wp1536848"> </a><p class="pIndented3">
where &quot;<code class="cCode">record</code>&quot; is a string representing the current record, &quot;<code class="cCode">duplicates</code>&quot; is an array containing all records which keys are equal, and &quot;<code class="cCode">cur_duplicates</code>&quot; is the index of the current record into &quot;<code class="cCode">duplicates</code>&quot;.
</p>
<a name="wp1536858"> </a><p class="pIndented3">
Input and output functions will be applied when reading and writing data from a file. They can be used to filter what is read/written and also to change some key before taking it into account for the sorting process.
</p>
<a name="wp1536866"> </a><h4 class="pHeading4">
Reduce functions
</h4>
<a name="wp1536872"> </a><div style="color: #000000; font-size: 11pt; font-style: normal; font-variant: normal; font-weight: normal; margin-bottom: 0pt; margin-left: 72pt; margin-right: 0pt; margin-top: 8pt; text-align: left; text-decoration: none; text-indent: 0pt; text-transform: none">
<code class="cCode">function bool reduce_filter (string record, int cur_duplicate, string[...] duplicates)</code><br /><code class="cCode">function string reduce_process (string record, int cur_duplicate, string[...] duplicates)</code>
</div>
<a name="wp1536885"> </a><p class="pIndented3">
where &quot;<code class="cCode">record</code>&quot; is a string representing the current record, &quot;<code class="cCode">duplicates</code>&quot; is an array containing all records which keys are equal and &quot;<code class="cCode">cur_duplicates</code>&quot; is the index of the current record in &quot;<code class="cCode">duplicates</code>&quot;.
</p>
<a name="wp1536904"> </a><p class="pIndented3">
The &quot;<code class="cCode">reduce_filter</code>&quot; function is applied first. If it returns &quot;<code class="cCode">true</code>&quot;, &quot;<code class="cCode">reduce_filter</code>&quot; will be applied and the result will be written in the output file. By default, &quot;<code class="cCode">reduce_filte</code>r&quot; always returns &quot;<code class="cCode">true</code>&quot; and &quot;<code class="cCode">reduce_process</code>&quot; returns the untouched record.
</p>
<a name="wp1536917"> </a><p class="pIndented3">
Reduce functions will be applied at least once, but can be applied many times as well. These functions should left data of sort key untouched, otherwise the behavior is undefined.
</p>
<a name="wp1536922"> </a><p class="pIndented3">
These functions can be very useful to aggregate data:
</p>
<div class="pSmartList1"><ul class="pSmartList1">
<div class="pSmartList2"><ul class="pSmartList2">
<div class="pSmartList3"><ul class="pSmartList3">
<div class="pSmartList4"><ul class="pSmartList4">
<a name="wp1536928"> </a><div class="pSmartList4"><li>counting for duplicate,</li></div>
<a name="wp1536935"> </a><div class="pSmartList4"><li>summarizing duplicate info.</li></div>
</ul></div>
</ul></div>
</ul></div>
</ul></div>
<a name="wp1536941"> </a><h3 class="pHeading3">
External variables
</h3>
<a name="wp1536944"> </a><p class="pIndented2">
These are variables defined by FileScale that help to define general behavior of sorting/merging/checking.
</p>
    </blockquote>
    <hr>

    <!--table align="right" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td align="right"><font size="1">
          <a href="http://www.webworks.com"><img src="images/webworks.gif" width="150" height="20" border="0"></a><br>
            Quadralay Corporation<br>
            http://www.webworks.com<br>
            Voice: (512) 719-3399<br>
            Fax: (512) 719-3606<br>
          <a href="mailto:sales@webworks.com">sales@webworks.com</a><br>
        </font></td>
      </tr>
    </table-->

    <!--table width="220" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a accesskey="4" href="Components05-3.html"><img id="LongDescNotReq3" src="images/prev.gif" border="0" alt="Previous" /></a><a accesskey="5" href="Components05-5.html"><img id="LongDescNotReq4" src="images/next.gif" border="0" alt="Next" /></a>
        </td>
      </tr>
    </table-->
  </body>
</html>
