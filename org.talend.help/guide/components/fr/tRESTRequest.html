<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tRESTRequest</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch10.html" title="Chapitre&nbsp;10.&nbsp;Composants ESB"><link rel="prev" href="tESBProviderResponse.html" title="tESBProviderResponse"><link rel="next" href="tRESTResponse.html" title="tRESTResponse"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="fr" class="section" title="tRESTRequest"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tRESTRequest"></a>tRESTRequest</h2></div></div></div><div class="mediaobject"><img src="../images/tRESTRequest_icon32_white.png"></div><div class="section" title="Propri&eacute;t&eacute;s du tRESTRequest"><div class="titlepage"><div><div><h3 class="title"><a name="d0e183060"></a>Propri&eacute;t&eacute;s du tRESTRequest</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
                                                  <p><span class="bold"><strong>Famille de
                                                  composant</strong></span></p>
                                                </td><td valign="top">
                                                  <p>ESB/REST</p>
                                                </td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
                                                  <p><span class="bold"><strong>Fonction</strong></span></p>
                                                </td><td colspan="2" valign="top">
                                                  <p>Le <span class="bold"><strong>tRestRequest</strong></span> est un composant c&ocirc;t&eacute;
                                                  serveur acceptant les requ&ecirc;tes HTTP et/ou HTTPS
                                                  des clients et supportant les m&eacute;thodes HTTP GET,
                                                  POST, PUT et DELETE.</p>
                                                  <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Pour activer le support de l'HTTPS, vous
                                                  devez g&eacute;n&eacute;rer un keystore et ajouter quelques
                                                  propri&eacute;t&eacute;s li&eacute;es &agrave; la configuration de s&eacute;curit&eacute;
                                                  HTTPS dans le fichier <span class="italic">org.ops4j.pax.web.cfg</span> de votre
                                                  conteneur Talend Runtime. Pour plus
                                                  d'informations, consultez le <span class="italic">Talend ESB Container Administration
                                                  Guide</span> (en anglais).</p></td></tr></table></div>
                                                </td></tr><tr><td valign="top">
                                                  <p><span class="bold"><strong>Objectif</strong></span></p>
                                                </td><td colspan="2" valign="top">
                                                  <p>Ce composant vous permet de recevoir les
                                                  requ&ecirc;tes GET/POST/PUT/DELETE des clients, du c&ocirc;t&eacute;
                                                  serveur.</p>
                                                </td></tr><tr><td valign="top">
                                                  <p><span class="bold"><strong>Basic
                                                  settings</strong></span></p>
                                                </td><td valign="top">
                                                  <p><span class="emphasis"><em>REST Endpoint</em></span></p>
                                                </td><td valign="top">
                                                  <p>Renseignez ce champ en saisissant
                                                  l'emplacement de l'URI o&ugrave; le service Web RESTful
                                                  sera accessible pour les requ&ecirc;tes.</p>
                                                  <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Si vous voulez que votre service soit
                                                  disponible &agrave; la fois sur HTTP et HTTPS, renseignez
                                                  ce champ avec un chemin relatif.</p></td></tr></table></div>
                                                </td></tr><tr><td>
                                                  <p>&nbsp;</p>
                                                </td><td valign="top">
                                                  <p><span class="emphasis"><em>REST API Mapping</em></span></p>
                                                </td><td valign="top">
                                                  <p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> sous la table de mapping pour
                                                  ajouter des lignes pour sp&eacute;cifier des requ&ecirc;tes
                                                  HTTP :</p>
                                                  <p><span class="bold"><strong>Output Flow</strong></span>
                                                  : Cliquez sur le bouton <span class="bold"><strong>[...]</strong></span> afin de sp&eacute;cifier le nom d'un
                                                  flux de sortie et configurez le sch&eacute;ma du flux de
                                                  sortie dans la bo&icirc;te de dialogue qui suit.</p>
                                                  <p>Le sch&eacute;ma n'est pas obligatoire, donc, si
                                                  vous ne devez pas passer des param&egrave;tres
                                                  suppl&eacute;mentaires au composant <span class="bold"><strong>tRESTRequest</strong></span>, vous pouvez laisser le
                                                  sch&eacute;ma vide. Cependant, vous devez alimenter le
                                                  sch&eacute;ma si vous avez des param&egrave;tres URI Path
                                                  d&eacute;finis dans le champ <span class="bold"><strong>URI
                                                  Pattern</strong></span> ou si vous devez ajouter des
                                                  param&egrave;tres facultatifs de requ&ecirc;tes, tels que URI
                                                  Query, HTTP Header ou Form parameters &agrave; l'URI
                                                  sp&eacute;cifi&eacute;e dans le champ <span class="bold"><strong>REST
                                                  Endpoint</strong></span>. Si vous sp&eacute;cifiez des
                                                  param&egrave;tres d'URI dans le sch&eacute;ma du flux de sortie,
                                                  vous devez d&eacute;finir le type de param&egrave;tre dans le
                                                  champ <span class="bold"><strong>Comment</strong></span> du
                                                  sch&eacute;ma. Par d&eacute;faut, si vous laissez le champ
                                                  <span class="bold"><strong>Comment</strong></span> vide, le
                                                  param&egrave;tre est consid&eacute;r&eacute; comme un param&egrave;tre Path.
                                                  Voici une liste des valeurs support&eacute;es dans
                                                  <span class="bold"><strong>Comment</strong></span> :</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>vide ou <span class="italic">path</span> correspond au param&egrave;tre par
                                                  d&eacute;faut @PathParam, </p></li><li class="listitem"><p><span class="italic">query</span>
                                                  correspond &agrave; @QueryParam, </p></li><li class="listitem"><p><span class="italic">form</span>
                                                  correspond &agrave; @FormParam, </p></li><li class="listitem"><p><span class="italic">header</span>
                                                  correspond &agrave; @HeaderParam.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Il est recommand&eacute; de d&eacute;finir les valeurs par
                                                  d&eacute;faut de vos param&egrave;tres facultatifs (Header,
                                                  Query, Form). pour ce faire, renseignez les
                                                  colonnes <span class="bold"><strong>Default</strong></span>
                                                  du sch&eacute;ma.</p></td></tr></table></div>
                                                  <p><span class="bold"><strong>HTTP Verb</strong></span> :
                                                  S&eacute;lectionnez une m&eacute;thode HTTP
                                                  (GET/POST/PUT/DELETE) dans la liste.</p>
                                                  <p><span class="bold"><strong>URI pattern</strong></span>
                                                  : Renseignez ce champ avec les URIs RESTful
                                                  d&eacute;crivant la ressource.</p>
                                                </td></tr><tr><td>
                                                  <p>&nbsp;</p>
                                                </td><td valign="top">
                                                  <p>
                                                  <span class="emphasis"><em>Use HTTP Basic Authentication</em></span>
                                                  </p>
                                                </td><td valign="top">
                                                  <p>Cochez cette case pour activer la m&eacute;thode
                                                  d'authentification HTTP Basic dans ce
                                                  service.</p>
                                                </td></tr><tr><td valign="top">
                                                  <p><span class="bold"><strong>Advanced
                                                  settings</strong></span></p>
                                                </td><td valign="top">
                                                  <p><span class="emphasis"><em>tStatCatcher
                                                  Statistics</em></span></p>
                                                </td><td valign="top">
                                                  <p>Cochez cette case pour collecter les donn&eacute;es
                                                  de log, aussi bien au niveau du Job qu&#8217;au niveau
                                                  de chaque composant.</p>
                                                </td></tr><tr><td valign="top">
                                                  <p><span class="bold"><strong>Utilisation</strong></span></p>
                                                </td><td colspan="2" valign="top">
                                                  <p>Ce composant permet d'exposer un Job Talend en tant que service et de
                                                  transmettre une requ&ecirc;te &agrave; un service dans un Job
                                                  puis retourne les r&eacute;sultats du Job en tant que
                                                  r&eacute;ponse du service.</p>
                                                  <p>Le composant <span class="bold"><strong>tRESTRequest</strong></span> doit &ecirc;tre utilis&eacute; avec le
                                                  <span class="bold"><strong>tRESTResponse</strong></span>
                                                  afin de fournir les r&eacute;sultats d'un Job en tant que
                                                  r&eacute;ponse, dans le cas d'une communication de style
                                                  requ&ecirc;te-r&eacute;ponse. </p>
                                                </td></tr><tr><td valign="top">
                                                  <p><span class="bold"><strong>Limitation</strong></span></p>
                                                </td><td colspan="2" valign="top">
                                                  <p>n/a</p>
                                                </td></tr></tbody></table></div></div><div class="section" title="Sc&eacute;nario 1 : Service REST acceptant une requ&ecirc;te HTTP et envoyant une r&eacute;ponse"><div class="titlepage"><div><div><h3 class="title"><a name="fhan-20111104-esb-trestrequest-scenario"></a>Sc&eacute;nario 1 : Service REST acceptant une requ&ecirc;te HTTP et envoyant une
                        r&eacute;ponse</h3></div></div></div><p>Ce sc&eacute;nario d&eacute;crit le processus d'acceptation d'une requ&ecirc;te HTTP du client,
                        son traitement et l'envoi de sa r&eacute;ponse.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1.png" align="middle"></div><div class="section" title="Configurer le composant tRESTRequest"><div class="titlepage"><div><div><h4 class="title"><a name="d0e183323"></a>Configurer le composant tRESTRequest</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>D&eacute;posez les composants suivants de la <span class="bold"><strong>Palette</strong></span> dans l'espace de
                                                mod&eacute;lisation graphique : <span class="bold"><strong>tRESTRequest</strong></span>, <span class="bold"><strong>tXMLMap</strong></span> et <span class="bold"><strong>tRESTResponse</strong></span>.</p></li><li class="step" title="&Eacute;tape 2"><p>Double-cliquez sur le composant <span class="bold"><strong>tRESTRequest</strong></span> dans l'espace de
                                                mod&eacute;lisation graphique afin d'afficher sa vue
                                                  <span class="bold"><strong>Basic
                                                settings</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest2.png" align="middle"></div></li><li class="step" title="&Eacute;tape 3"><p>Dans le champ <span class="bold"><strong>REST
                                                  Endpoint</strong></span>, saisissez l'URI &agrave; laquelle le
                                                service Web REST sera accessible pour les requ&ecirc;tes,
                                                par exemple <span class="italic">"http://192.168.0.235:8088/user"</span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>Si vous voulez que votre service soit
                                                  disponible &agrave; la fois sur HTTP et HTTPS, renseignez
                                                  ce champ avec un chemin relatif. Par exemple, si
                                                  vous saisissez <span class="italic">"/test"</span>, votre service sera disponible
                                                  &agrave; la fois sur <span class="italic">http://&lt;EndpointHTTPParD&eacute;faut&gt;/test</span>
                                                  et <span class="italic">https://&lt;EndpointHTTPSParD&eacute;faut&gt;/test</span>,
                                                  &agrave; condition que vous ayez configur&eacute; votre
                                                  conteneur d'ex&eacute;cution pour supporter l'HTTPS. Pour
                                                  plus d'informations, consultez le <span class="italic">Talend ESB Container Administration
                                                  Guide</span> (en anglais).</p></td></tr></table></div></li><li class="step" title="&Eacute;tape 4"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> pour ajouter une ligne dans la
                                                table <span class="bold"><strong>REST API
                                                  Mapping</strong></span>.</p></li><li class="step" title="&Eacute;tape 5"><p>S&eacute;lectionnez la nouvelle ligne et cliquez sur le
                                                bouton <span class="bold"><strong>[...]</strong></span> de la
                                                colonne <span class="bold"><strong>Output Flow</strong></span>
                                                afin d'ajouter un sch&eacute;ma pour le flux de
                                                sortie.</p><p>Dans ce sc&eacute;nario, nommez le flux de sortie
                                                  <span class="emphasis"><em>GetOneUser</em></span>. </p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest3.png" align="middle"></div></li><li class="step" title="&Eacute;tape 6"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> afin d'ajouter une ligne
                                                  <span class="emphasis"><em>id</em></span> au sch&eacute;ma. Cliquez sur
                                                  <span class="bold"><strong>OK</strong></span> pour
                                                sauvegarder le sch&eacute;ma.</p></li><li class="step" title="&Eacute;tape 7"><p>S&eacute;lectionnez <span class="bold"><strong>GET</strong></span> dans
                                                la colonne <span class="bold"><strong>HTTP
                                                  Verb</strong></span>.</p></li><li class="step" title="&Eacute;tape 8"><p>Dans la colonne <span class="bold"><strong>URI
                                                  Pattern</strong></span>, saisissez
                                                  <code class="code">"/{id}/"</code>.</p></li></ol></div></div><div class="section" title="Configurer le tXMLMap"><div class="titlepage"><div><div><h4 class="title"><a name="d0e183440"></a>Configurer le tXMLMap</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Reliez le composant <span class="bold"><strong>tRESTRequest</strong></span> au <span class="bold"><strong>tXMLMap</strong></span> &agrave; l'aide d'un lien <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>GetOneUser</strong></span>.</p></li><li class="step" title="&Eacute;tape 2"><p>Double-cliquez sur le <span class="bold"><strong>tXMLMap</strong></span> dans l'espace de mod&eacute;lisation
                                                graphique pour ouvrir le <span class="bold"><strong>Map
                                                  Editor</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest4.png" align="middle"></div></li><li class="step" title="&Eacute;tape 3"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> en haut &agrave; droite afin d'ajouter
                                                une table de sortie et nommez-la
                                                  <span class="emphasis"><em>ResponseUsers</em></span>.</p></li><li class="step" title="&Eacute;tape 4"><p>Cliquez sur le bouton<span class="bold"><strong>
                                                  [+]</strong></span> en bas &agrave; droite pour ajouter deux
                                                colonnes en sortie.</p><p>Nommez la premi&egrave;re colonne <span class="emphasis"><em>body</em></span>
                                                et, dans la colonne <span class="bold"><strong>Type</strong></span>, s&eacute;lectionnez <span class="bold"><strong>Document</strong></span>.</p><p>Nommez la seconde colonne <span class="emphasis"><em>string</em></span>
                                                et, dans la colonne <span class="bold"><strong>Type</strong></span>, s&eacute;lectionnez <span class="bold"><strong>String</strong></span>.</p></li><li class="step" title="&Eacute;tape 5"><p>Cliquez-droit sur le n&#339;ud <span class="bold"><strong>root</strong></span> et s&eacute;lectionnez <span class="bold"><strong>Create Sub-Element</strong></span> pour
                                                cr&eacute;er un sous-&eacute;l&eacute;ment.</p><div class="mediaobject"><img src="../images/use_case-trestrequest5.png"></div><p>Nommez le sous-&eacute;l&eacute;ment <span class="emphasis"><em>foo</em></span> dans
                                                la bo&icirc;te de dialogue qui s'ouvre.</p></li><li class="step" title="&Eacute;tape 6"><p>Cliquez-droit sur le n&#339;ud <span class="emphasis"><em>foo</em></span> et
                                                s&eacute;lectionnez <span class="bold"><strong>As loop
                                                  element</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest6.png" align="middle"></div></li><li class="step" title="&Eacute;tape 7"><p>S&eacute;lectionnez la colonne <span class="italic">id</span> de la table <span class="italic">GetOneUser</span> et d&eacute;posez-la dans le champ
                                                  <span class="bold"><strong>Expression</strong></span> du
                                                n&#339;ud <span class="italic">foo</span> dans la
                                                table <span class="italic">ResponseUsers</span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest9.png" align="middle"></div></li><li class="step" title="&Eacute;tape 8"><p>Cliquez sur <span class="bold"><strong>OK</strong></span> afin
                                                de sauvegarder les param&egrave;tres.</p></li></ol></div></div><div class="section" title="Configurer le composant tRESTResponse"><div class="titlepage"><div><div><h4 class="title"><a name="d0e183564"></a>Configurer le composant tRESTResponse</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Reliez le <span class="bold"><strong>tXMLMap</strong></span> au
                                                  <span class="bold"><strong>tRESTResponse</strong></span> &agrave;
                                                l'aide d'un lien <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>ResponseUsers</strong></span>.</p></li><li class="step" title="&Eacute;tape 2"><p>Cliquez sur le bouton <span class="bold"><strong>Sync
                                                  columns</strong></span> pour r&eacute;cup&eacute;rer le sch&eacute;ma du
                                                composant pr&eacute;c&eacute;dent.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest7.png" align="middle"></div></li><li class="step" title="&Eacute;tape 3"><p>S&eacute;lectionnez <span class="bold"><strong>OK(200)</strong></span>
                                                dans la liste <span class="bold"><strong>Return status
                                                  code</strong></span>.</p></li><li class="step" title="&Eacute;tape 4"><p>Laissez les autres param&egrave;tres tels qu'ils sont.</p></li></ol></div></div><div class="section" title="Sauvegarder et ex&eacute;cuter le Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e183604"></a>Sauvegarder et ex&eacute;cuter le Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Sauvegardez le Job et appuyez sur <span class="bold"><strong>F6</strong></span>
                                pour l'ex&eacute;cuter.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest8.png" align="middle"></div></li><li class="step" title="&Eacute;tape 2"><p>Ouvrez votre navigateur si vous souhaitez tester le service.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest10.png" align="middle"></div></li></ol></div><p> La requ&ecirc;te HTTP demandant l'ID d'un utilisateur est accept&eacute;e par le
                                service REST et la r&eacute;ponse HTTP est retourn&eacute;e au serveur.</p></div></div><div class="section" title="Sc&eacute;nario&nbsp;2 : Utiliser les param&egrave;tres URI Query pour explorer les donn&eacute;es d'une base de donn&eacute;es"><div class="titlepage"><div><div><h3 class="title"><a name="mlelandais-20120329-esb-trestrequest-scenario2"></a>Sc&eacute;nario&nbsp;2 : Utiliser les param&egrave;tres URI Query pour explorer les donn&eacute;es d'une base
                        de donn&eacute;es</h3></div></div></div><p>Ce sc&eacute;nario d&eacute;crit comment utiliser les param&egrave;tres URI query dans le <span class="bold"><strong>tRESTRequest</strong></span> afin d'explorer les donn&eacute;es
                        d'une base de donn&eacute;es et d'envoyer la r&eacute;ponse via le <span class="bold"><strong>tRESTResponse</strong></span>.</p><p>Pour ce faire, vous devez cr&eacute;er deux sous-jobs connect&eacute;s &agrave; l'aide d'un  lien <span class="bold"><strong>OnSubjobOk</strong></span>. Ainsi, les deux sous-jobs seront
                        ex&eacute;cut&eacute;s s&eacute;quentiellement. Pour plus d'informations concernant les
                        connexions Trigger, consultez le <span class="italic">Guide utilisateur
                                de</span>
                        <span class="emphasis"><em>Talend Open Studio</em></span>. Le premier sous-job cr&eacute;e et
                        alimente la base de donn&eacute;es. Le second permet d'explorer la base de donn&eacute;es
                        via le service REST.</p><div class="mediaobject"><img src="../images/use_case-trestrequest1-1.png"></div><div class="section" title="Cr&eacute;er le premier sous-job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e183650"></a>Cr&eacute;er le premier sous-job</h4></div></div></div><p>Pour ce faire, proc&eacute;dez comme suit :</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>D&eacute;posez les composants suivants de la
                                                  <span class="bold"><strong>Palette</strong></span> dans
                                                  l'espace de mod&eacute;lisation graphique : <span class="bold"><strong>tFixedFlowInput</strong></span> de la
                                                  famille <span class="bold"><strong>Misc</strong></span> et
                                                  <span class="bold"><strong>tMysqlOutput</strong></span> de
                                                  la famille <span class="bold"><strong>Databases</strong></span> &gt; <span class="bold"><strong>Mysql</strong></span>.</p></li><li class="step" title="&Eacute;tape 2"><p>Reliez le <span class="bold"><strong>tFixedFlowInput</strong></span> au <span class="bold"><strong>tMysqlOutput</strong></span> &agrave; l'aide d'un
                                                  lien <span class="bold"><strong>Row</strong></span> &gt;
                                                  <span class="bold"><strong>Main</strong></span>.</p></li><li class="step" title="&Eacute;tape 3"><p>Double-cliquez sur le <span class="bold"><strong>tFixedFlowInput</strong></span> pour afficher sa vue
                                                  <span class="bold"><strong>Basic settings</strong></span> :</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-2.png" align="middle"></div></li><li class="step" title="&Eacute;tape 4"><p>Cliquez sur le bouton <span class="bold"><strong>[...]</strong></span> &agrave; c&ocirc;t&eacute; du champ <span class="bold"><strong>Edit schema</strong></span> pour ouvrir
                                                  l'&eacute;diteur du sch&eacute;ma.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-3.png" align="middle"></div></li><li class="step" title="&Eacute;tape 5"><p>Dans l'&eacute;diteur du sch&eacute;ma, cliquez trois fois
                                                  sur le bouton <span class="bold"><strong>[+]</strong></span>
                                                  afin d'ajouter trois lignes. Param&eacute;trez-les comme
                                                  dans la capture d'&eacute;cran.</p></li><li class="step" title="&Eacute;tape 6"><p>Cliquez sur <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="&Eacute;tape 7"><p>Retournez dans les propri&eacute;t&eacute;s du <span class="bold"><strong>tFixedFlowInput</strong></span>, dans sa
                                                  vue <span class="bold"><strong>Basic
                                                  settings</strong></span>. Dans la zone <span class="bold"><strong>Mode</strong></span>, s&eacute;lectionnez l'option
                                                  <span class="bold"><strong>Use inline
                                                  table</strong></span>.</p></li><li class="step" title="&Eacute;tape 8"><p>Sous le tableau, cliquez trois fois sur le
                                                  bouton <span class="bold"><strong>[+]</strong></span> afin
                                                  d'ajouter trois lignes.</p></li><li class="step" title="&Eacute;tape 9"><p>Dans le tableau, cliquez sur le champ
                                                  <span class="italic">id</span> de la
                                                  premi&egrave;re ligne et saisissez <span class="italic">1</span>.</p></li><li class="step" title="&Eacute;tape 10"><p>Cliquez sur le champ <span class="italic">firstname</span> de la premi&egrave;re ligne,
                                                  appuyez sur les touches <span class="bold"><strong>Ctrl+Espace</strong></span> pour afficher la liste
                                                  d'autocompl&eacute;tion et s&eacute;lectionnez la variable
                                                  <span class="bold"><strong>TalendDataGenerator.getFirstName()</strong></span>
                                                  dans la liste.</p></li><li class="step" title="&Eacute;tape 11"><p>Cliquez sur le champ <span class="italic">lastname</span> de la premi&egrave;re ligne, appuyez
                                                  sur les touches <span class="bold"><strong>Ctrl+Espace</strong></span> pour afficher la liste
                                                  d'autocompl&eacute;tion et s&eacute;lectionnez la variable
                                                  <span class="bold"><strong>TalendDataGenerator.getLastName()</strong></span> dans
                                                  la liste.</p></li><li class="step" title="&Eacute;tape 12"><p>R&eacute;p&eacute;tez l'op&eacute;ration pour les lignes suivantes,
                                                  afin d'obtenir les m&ecirc;mes param&egrave;tres que dans la
                                                  capture d'&eacute;cran.</p></li><li class="step" title="&Eacute;tape 13"><p>Double-cliquez sur le <span class="bold"><strong>tMysqlOutput</strong></span> pour afficher sa vue
                                                  <span class="bold"><strong>Basic settings</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-4.png" align="middle"></div></li><li class="step" title="&Eacute;tape 14"><p>Dans la liste <span class="bold"><strong>Property
                                                  Type</strong></span>, laissez s&eacute;lectionn&eacute; le mode
                                                  <span class="bold"><strong>Built-in</strong></span> et
                                                  renseignez les champs <span class="bold"><strong>Host</strong></span>, <span class="bold"><strong>Port</strong></span>, <span class="bold"><strong>Database</strong></span>, <span class="bold"><strong>Username</strong></span> et <span class="bold"><strong>Password</strong></span> manuellement. Si vous avez
                                                  centralis&eacute; vos informations de connexion &agrave; la base
                                                  de donn&eacute;es dans le n&#339;ud <span class="bold"><strong>Metadata</strong></span> &gt; <span class="bold"><strong>DB
                                                  Connections</strong></span> du <span class="bold"><strong>Repository</strong></span>, vous pouvez s&eacute;lectionner
                                                  <span class="bold"><strong>Repository</strong></span> dans
                                                  la liste. Les champs seront automatiquement
                                                  renseign&eacute;s.</p><p>Pour plsu d'informations concernant le
                                                  stockage des m&eacute;tadonn&eacute;es, consultez le <span class="italic">Guide utilisateur de</span>
                                                  <span class="emphasis"><em>Talend Open Studio</em></span>.</p></li><li class="step" title="&Eacute;tape 15"><p>Dans le champ <span class="bold"><strong>Table</strong></span>, saisissez le nom de la table
                                                  dans laquelle les donn&eacute;es vont &ecirc;tre charg&eacute;es, par
                                                  exemple : <span class="italic">users</span>.</p></li><li class="step" title="&Eacute;tape 16"><p>Dans la liste <span class="bold"><strong>Action on
                                                  table</strong></span>, s&eacute;lectionnez <span class="bold"><strong>Drop table if exists and
                                                  create</strong></span>, puis s&eacute;lectionnez <span class="bold"><strong>Insert</strong></span> dans la liste
                                                  <span class="bold"><strong>Action on
                                                  data</strong></span>.</p></li><li class="step" title="&Eacute;tape 17"><p>Cliquez sur <span class="bold"><strong>Sync
                                                  columns</strong></span> pour r&eacute;cup&eacute;rer le sch&eacute;ma
                                                  provenant du composant pr&eacute;c&eacute;dent.</p></li></ol></div></div><div class="section" title="Cr&eacute;er le second sous-job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e183871"></a>Cr&eacute;er le second sous-job</h4></div></div></div><p>Pour ce faire, proc&eacute;dez comme suit :</p><div class="procedure"><ul class="procedure"><li class="step" title="&Eacute;tape 1"><p>Glissez-d&eacute;posez les composants suivants, comme
                                                  dans la premi&egrave;re capture d'&eacute;cran. </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>Un <span class="bold"><strong>tRESTRequest</strong></span> et un <span class="bold"><strong>tRESTResponse</strong></span> de la famille
                                                  <span class="bold"><strong>ESB</strong></span> &gt; <span class="bold"><strong>REST</strong></span>,</p></li><li class="listitem"><p>un <span class="bold"><strong>tFlowToIterate</strong></span> de la famille <span class="bold"><strong>Orchestration</strong></span>,</p></li><li class="listitem"><p>un <span class="bold"><strong>tMysqlInput</strong></span> de la famille <span class="bold"><strong>Databases</strong></span> &gt; <span class="bold"><strong>Mysql</strong></span>,</p></li><li class="listitem"><p>un <span class="bold"><strong>tXMLMap</strong></span>
                                                  de la famille <span class="bold"><strong>Processing</strong></span>.</p></li></ul></div></li></ul></div><div class="section" title="Configurer le composant tRESTRequest"><div class="titlepage"><div><div><h5 class="title"><a name="d0e183926"></a>Configurer le composant tRESTRequest</h5></div></div></div><p>Pour ce faire, proc&eacute;dez comme suit :</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Double-cliquez sur le <span class="bold"><strong>tRESTRequest</strong></span> dans l'espace de
                                                  mod&eacute;lisation graphique afin d'afficher sa vue
                                                  <span class="bold"><strong>Basic settings</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-5.png" align="middle"></div><p>
                                                  </p></li><li class="step" title="&Eacute;tape 2"><p>Renseignez le champ <span class="bold"><strong>REST Endpoint</strong></span> avec l'emplacement de
                                                  l'URI o&ugrave; le service Web REST-ful sera accessible
                                                  pour les requ&ecirc;tes. Par exemple, <span class="italic">"http://localhost:8088/users"</span>.</p></li><li class="step" title="&Eacute;tape 3"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> pour ajouter une ligne dans le
                                                  tableau <span class="bold"><strong>REST API
                                                  Mapping</strong></span>.</p></li><li class="step" title="&Eacute;tape 4"><p>S&eacute;lectionnez la nouvelle ligne et cliquez
                                                  sur le bouton <span class="bold"><strong>[...]</strong></span> dans la colonne <span class="bold"><strong>Output Flow</strong></span> afin d'ajouter
                                                  un sch&eacute;ma au flux de sortie.</p></li><li class="step" title="&Eacute;tape 5"><p>Dans la bo&icirc;te de dialogue, nommez le flux de
                                                  sortie <span class="italic">getUsers</span>. Un &eacute;diteur de sch&eacute;ma s'ouvre.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-6.png" align="middle"></div></li><li class="step" title="&Eacute;tape 6"><p>Dans l'&eacute;diteur de sch&eacute;ma, cliquez deux fois
                                                  sur le bouton <span class="bold"><strong>[+]</strong></span>
                                                  pour ajouter deux lignes et param&eacute;trez-les comme
                                                  dans la capture d'&eacute;cran ci-dessus. </p></li><li class="step" title="&Eacute;tape 7"><p>Cliquez sur <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="&Eacute;tape 8"><p>Retournez dans les propri&eacute;t&eacute;s du <span class="bold"><strong>tRESTRequest</strong></span>, dans sa vue
                                                  <span class="bold"><strong>Basic settings</strong></span>,
                                                  s&eacute;lectionnez <span class="bold"><strong>GET</strong></span>
                                                  dans la liste de la colonne <span class="bold"><strong>HTTP Verb</strong></span>.</p></li><li class="step" title="&Eacute;tape 9"><p>Laissez la colonne <span class="bold"><strong>URI
                                                  Pattern</strong></span> telle qu'elle est.</p></li></ol></div><p>Vous avez cr&eacute;&eacute; le flux de sortie du <span class="bold"><strong>tRESTRequest</strong></span>, vous pouvez donc utiliser
                                        le lien correspondant pour le connecter au composant suivant :</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Connectez le <span class="bold"><strong>tRESTRequest</strong></span> au <span class="bold"><strong>tFlowToIterate</strong></span> &agrave; l'aide d'un lien
                                                  <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>getUsers</strong></span>.</p></li><li class="step" title="&Eacute;tape 2"><p>Laissez les param&egrave;tres du <span class="bold"><strong>tFlowToIterate</strong></span> tels qu'ils
                                                  sont.</p></li><li class="step" title="&Eacute;tape 3"><p>Connectez le <span class="bold"><strong>tFlowToIterate</strong></span> au <span class="bold"><strong>tMysqlInput</strong></span> &agrave; l'aide d'un
                                                  lien <span class="bold"><strong>Row</strong></span> &gt;
                                                  <span class="bold"><strong>Iterate</strong></span>.</p></li></ol></div></div><div class="section" title="Configurer le composant tMysqlInput"><div class="titlepage"><div><div><h5 class="title"><a name="d0e184062"></a>Configurer le composant tMysqlInput</h5></div></div></div><p>Pour ce faire, proc&eacute;dez comme suit :</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Double-cliquez sur le <span class="bold"><strong>tMysqlInput</strong></span> pour afficher sa vue
                                                  <span class="bold"><strong>Basic
                                                  settings</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-7.png" align="middle"></div></li><li class="step" title="&Eacute;tape 2"><p>Dans la liste <span class="bold"><strong>Property
                                                  Type</strong></span>, s&eacute;lectionnez <span class="bold"><strong>Built-in</strong></span> et renseignez les
                                                  champs <span class="bold"><strong>Host</strong></span>,
                                                  <span class="bold"><strong>Port</strong></span>, <span class="bold"><strong>Database</strong></span>, <span class="bold"><strong>Username</strong></span> et <span class="bold"><strong>Password</strong></span> manuellement. Si
                                                  vous avez centralis&eacute; vos informations de connexion
                                                  dans le n&#339;ud <span class="bold"><strong>Metadata</strong></span> &gt; <span class="bold"><strong>DB
                                                  Connections</strong></span> du <span class="bold"><strong>Repository</strong></span>, vous pouvez s&eacute;lectionner
                                                  <span class="bold"><strong>Repository</strong></span> dans
                                                  la liste. Les champs seront automatiquement
                                                  renseign&eacute;s.</p><p>Pour plus d'informations concernant le
                                                  stockage des m&eacute;tadonn&eacute;es, consultez le <span class="italic">Guide utilisateur de</span>
                                                  <span class="emphasis"><em>Talend Open Studio</em></span>.</p></li><li class="step" title="&Eacute;tape 3"><p>Dans la liste <span class="bold"><strong>Schema</strong></span>, s&eacute;lectionnez <span class="bold"><strong>Built-in</strong></span> et cliquez sur le
                                                  bouton <span class="bold"><strong>[...]</strong></span> &agrave;
                                                  c&ocirc;t&eacute; du champ <span class="bold"><strong>Edit
                                                  schema</strong></span>.</p></li><li class="step" title="&Eacute;tape 4"><p>Dans l'&eacute;diteur de sch&eacute;ma, d&eacute;finissez le
                                                  sch&eacute;ma exactement comme celui du <span class="bold"><strong>tFixedFlowInput</strong></span>.</p></li><li class="step" title="&Eacute;tape 5"><p>Dans le champ <span class="bold"><strong>Table
                                                  Name</strong></span>, renseignez le nom de la table
                                                  dans laquelle les donn&eacute;es sont stock&eacute;es :
                                                  <span class="italic">users</span>.</p></li><li class="step" title="&Eacute;tape 6"><p>Dans la liste <span class="bold"><strong>Query
                                                  Type</strong></span>, s&eacute;lectionnez <span class="bold"><strong>Built-in</strong></span> et renseignez le
                                                  champ <span class="bold"><strong>Query</strong></span> avec
                                                  la requ&ecirc;te SQL suivante, permettant d'explorer les
                                                  donn&eacute;es de la base de donn&eacute;es via la requ&ecirc;te d'URI
                                                  d&eacute;finie dans le composant <span class="bold"><strong>tRESTRequest</strong></span>
                                                  </p><pre class="programlisting">"select * from users where id &gt;= " + globalMap.get("getUsers.from") + " and  id &lt;= " + globalMap.get("getUsers.to")</pre></li></ol></div></div><div class="section" title="Configurer le composant tXMLMap"><div class="titlepage"><div><div><h5 class="title"><a name="d0e184171"></a>Configurer le composant tXMLMap</h5></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Cliquez-droit sur le composant <span class="bold"><strong>tMysqlInput</strong></span>, maintenez et d&eacute;posez sur
                                                  le <span class="bold"><strong>tXMLMap</strong></span> afin
                                                  de connecter les deux composants.</p></li><li class="step" title="&Eacute;tape 2"><p>Double-cliquez sur le <span class="bold"><strong>tXMLMap</strong></span> dans
                                                  l'espace de mod&eacute;lisation graphique pour ouvrir le
                                                  <span class="bold"><strong>Map Editor</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-8.png" align="middle"></div></li><li class="step" title="&Eacute;tape 3"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> dans le
                                                  coin sup&eacute;rieur droit afin d'ajouter une sortie.
                                                  Nommez-la <span class="italic">ResponseUsers</span>.</p></li><li class="step" title="&Eacute;tape 4"><p>Cliquez sur le bouton <span class="bold"><strong>[+]</strong></span> en bas &agrave;
                                                  droite pour ajouter deux colonnes de sortie. </p><p>Nommez la premi&egrave;re colonne <span class="italic">body</span> et
                                                  param&eacute;trez son <span class="bold"><strong>Type</strong></span> &agrave; <span class="bold"><strong>Document</strong></span>. </p><p>Nommez la seconde colonne <span class="italic">string</span> et
                                                  param&eacute;trez son <span class="bold"><strong>Type</strong></span> &agrave; <span class="bold"><strong>String</strong></span>.</p></li><li class="step" title="&Eacute;tape 5"><p>Cliquez-droit sur le n&#339;ud <span class="bold"><strong>root</strong></span>,
                                                  s&eacute;lectionnez <span class="bold"><strong>Rename</strong></span> dans la liste et renommez-le
                                                  <span class="italic">users</span></p></li><li class="step" title="&Eacute;tape 6"><p>Cliquez-droit sur le n&#339;ud <span class="bold"><strong>root</strong></span> et
                                                  s&eacute;lectionnez <span class="bold"><strong>Create
                                                  Sub-Element</strong></span> afin de cr&eacute;er un
                                                  sous-&eacute;l&eacute;ment.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-9.png" align="middle"></div><p>Nommez le sous-&eacute;l&eacute;ment <span class="emphasis"><em>user</em></span> dans la bo&icirc;te de
                                                  dialogue qui appara&icirc;t.</p></li><li class="step" title="&Eacute;tape 7"><p>Cliquez-droit sur le n&#339;ud <span class="emphasis"><em>user</em></span> cr&eacute;&eacute; &agrave; l'&eacute;tape
                                                  pr&eacute;c&eacute;dente et s&eacute;lectionnez <span class="bold"><strong>As loop element</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-10.png" align="middle"></div></li><li class="step" title="&Eacute;tape 8"><p>S&eacute;lectionnez la colonne <span class="italic">id</span> de la
                                                  table <span class="italic">row2</span>, &agrave;
                                                  gauche, et d&eacute;posez-la sur le n&#339;ud <span class="italic">user</span> de la table
                                                  <span class="italic">ResponseUsers</span>,
                                                  &agrave; droite.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-11.png" align="middle"></div></li><li class="step" title="&Eacute;tape 9"><p>Dans la bo&icirc;te de dialogue <span class="bold"><strong>[Selection]</strong></span>, s&eacute;lectionnez l'option
                                                  <span class="bold"><strong>Create as attribute of
                                                  target</strong></span> puis cliquez sur <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="&Eacute;tape 10"><p>S&eacute;lectionnez les colonnes <span class="italic">firstname</span>
                                                  et <span class="italic">lastname</span> de
                                                  la table <span class="italic">row2</span>et
                                                  d&eacute;posez-les sur le n&#339;ud <span class="italic">user</span> de la table <span class="italic">ResponseUsers</span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-12.png" align="middle"></div></li><li class="step" title="&Eacute;tape 11"><p>Dans la bo&icirc;te de dialogue <span class="bold"><strong>[Selection]</strong></span>, s&eacute;lectionnez l'option
                                                  <span class="bold"><strong>Create as sub-element of
                                                  target node</strong></span> et cliquez sur <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="&Eacute;tape 12"><p>Cliquez sur l'ic&ocirc;ne de cl&eacute; anglaise, en haut de la table <span class="italic">ResponseUsers</span> pour ouvrir
                                                  le panneau de param&eacute;trage.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-13.png" align="middle"></div></li><li class="step" title="&Eacute;tape 13"><p>Param&eacute;trez la fonctionnalit&eacute; <span class="bold"><strong>All in
                                                  one</strong></span> &agrave; <span class="bold"><strong>true</strong></span>. Ainsi, toutes les donn&eacute;es XML
                                                  sont &eacute;crites dans un seul flux.</p></li><li class="step" title="&Eacute;tape 14"><p>Cliquez sur <span class="bold"><strong>OK</strong></span> afin de sauvegarder
                                                  les param&egrave;tres.</p></li></ol></div></div><div class="section" title="Configurer le composant tRESTResponse"><div class="titlepage"><div><div><h5 class="title"><a name="d0e184360"></a>Configurer le composant tRESTResponse</h5></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Connectez le <span class="bold"><strong>tXMLMap</strong></span> au <span class="bold"><strong>tRESTResponse</strong></span> &agrave; l'aide d'un
                                                  lien <span class="bold"><strong>Row</strong></span> &gt;
                                                  <span class="bold"><strong>ResponseUsers</strong></span>.</p></li><li class="step" title="&Eacute;tape 2"><p>Double-cliquez sur le <span class="bold"><strong>tRESTResponse</strong></span>
                                                  dans l'espace de mod&eacute;lisation graphique pour
                                                  afficher sa vue <span class="bold"><strong>Basic
                                                  settings</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-14.png" align="middle"></div></li><li class="step" title="&Eacute;tape 3"><p>Cliquez sur <span class="bold"><strong>Sync columns</strong></span> afin de
                                                  r&eacute;cup&eacute;rer le sch&eacute;ma d&eacute;fini dans le composant
                                                  pr&eacute;c&eacute;dent.</p></li><li class="step" title="&Eacute;tape 4"><p>Laissez les autres param&egrave;tres tels qu'ils sont.</p></li></ol></div></div></div><div class="section" title="Connecter les deux sous-jobs"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184400"></a>Connecter les deux sous-jobs</h4></div></div></div><p>Les deux sous-jobs sont cr&eacute;&eacute;s, vous pouvez donc les connecter.</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Cliquez-droit sur le composant <span class="bold"><strong>tFixedFlowInput</strong></span> du premier
                                                  sous-job.</p></li><li class="step" title="&Eacute;tape 2"><p>S&eacute;lectionnez <span class="bold"><strong>Trigger</strong></span> &gt; <span class="bold"><strong>OnSubjobOk</strong></span> dans la liste.</p></li><li class="step" title="&Eacute;tape 3"><p>Cliquez sur le composant <span class="bold"><strong>tRESTRequest</strong></span> du second
                                                  sous-job.</p></li></ol></div><p>Ainsi, lors de l'ex&eacute;cution du Job, le second sous-job est ex&eacute;cut&eacute; uniquement si
                                l'ex&eacute;cution du premier s'est d&eacute;roul&eacute;e correctement.</p></div><div class="section" title="Sauvegarder et ex&eacute;cuter le Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184429"></a>Sauvegarder et ex&eacute;cuter le Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="&Eacute;tape 1"><p>Sauvegardez le Job et appuyez sur <span class="bold"><strong>F6</strong></span> pour
                                                l'ex&eacute;cuter.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-15.png" align="middle"></div></li><li class="step" title="&Eacute;tape 2"><p>Ouvrez votre navigateur si vous souhaitez tester le service. </p><p>Par exemple, utilisez la requ&ecirc;te d'URI <code class="code">?to=2</code> afin de
                                                r&eacute;cup&eacute;rer les donn&eacute;es des deux premiers
                                                utilisateurs.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-16.png" align="middle"></div><p> La requ&ecirc;te HTTP pour l'ID d'un utilisateur est accept&eacute;e par le service
                                                REST et la r&eacute;ponse HTTP est retourn&eacute;e au
                                                serveur.</p></li></ol></div></div></div></div></body></html>