<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tXMLMap</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tos-components-rg-en..html" title="Talend Open Studio Components"><link rel="up" href="ch-processing.html" title="Chapter&nbsp;18.&nbsp;Processing components"><link rel="prev" href="tWriteJSONField.html" title="tWriteJSONField"><link rel="next" href="ch-system.html" title="Chapter&nbsp;19.&nbsp;System components"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">tXMLMap</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tWriteJSONField.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;18.&nbsp;Processing components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="ch-system.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="tXMLMap"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tXMLMap"></a>tXMLMap</h2></div></div></div><div class="mediaobject"><img src="../images/txmlmap_icon32_white.png"></div><div class="section" title="tXMLMap properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e266950"></a>tXMLMap properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Component family</strong></span>
							</p>
						</td><td valign="top">
							<p>Processing/XML</p>
						</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>tXMLMap</strong></span> is an advanced component
								fine-tuned for transforming and routing XML data flow (data of the
									<span class="emphasis"><strong>Document</strong></span> type), especially when
								processing numerous XML data sources, with or without joining flat
								data. </p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>tXMLMap</strong></span> transforms and routes
								data from single or multiple sources to single or multiple
								destinations. </p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Basic settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Map editor</em></span>
							</p>
						</td><td valign="top">
							<p>It allows you to define the <span class="emphasis"><strong>tXMLMap</strong></span> routing and transformation
								properties.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Advanced settings</strong></span>
							</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>tStatCatcher Statistics</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box to gather the Job processing metadata at the
								Job level as well as at each component level. </p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>Possible uses are from a simple reorganization of fields to the
								most complex jobs of data multiplexing or demultiplexing
								transformation, concatenation, inversion, filtering and so on. </p>
							<p>When needs be, you can define sophisticated outputting strategy
								for the output XML flows using group element, aggregate element,
								empty element and many other features such as <span class="emphasis"><strong>All in one</strong></span>. For further information about these
								features, see <span class="emphasis"><em>Talend Open Studio
									User Guide</em></span>. </p>
							<p>It is used as an intermediate component and fits perfectly the
								process requiring many XML data sources, such as, the ESB
								request-response processes.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>The limitations to be kept in mind are:</p>
							<p> - The use of this component supposes minimum Java and XML
								knowledge in order to fully exploit its functionalities.</p>
							<p> - This component is a junction step, and for this reason cannot
								be a start nor end component in the Job.</p>
							<p> - At least one loop element is required for each XML data flow
								involved.</p>
						</td></tr></tbody></table></div><p>The following sections present several generic use cases about how to use the
				<span class="emphasis"><strong>tXMLMap</strong></span> component, while if you need some specific
			examples using this component along with the <span class="emphasis"><strong>ESB</strong></span>
			components to build data services, see the user guide for the <span class="emphasis"><em>Talend ESB Studio</em></span>.</p><p>If you need further information about the principles of mapping multiple input and
			output flows, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p></div><div class="section" title="Scenario 1: Mapping and transforming XML data"><div class="titlepage"><div><div><h3 class="title"><a name="Raa61298"></a>Scenario 1: Mapping and transforming XML data</h3></div></div></div><p>In this scenario, a three-component Job is run to map and transform data from one XML
			source, <span class="emphasis"><em>customer.xml</em></span> and generate a XML output flow which could be
			reused for various purposes in the future, such as, for a ESB request.</p><p>These three components are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><strong>tFileInputXML</strong></span>: this component is used to
					provide input data to <span class="emphasis"><strong>tXMLMap</strong></span>.</p></li><li class="listitem"><p><span class="emphasis"><strong>tXMLMap</strong></span>: this component maps and transforms
					the received XML data flows into one single XML data flow.</p></li><li class="listitem"><p><span class="emphasis"><strong>tLogRow</strong></span>: this component is used to display
					the output data.</p></li></ul></div><div class="mediaobject"><img src="../images/Use_Case_tXMLMapBasicJob.png"></div><p>To replicate this scenario, proceed as the following sections illustrate.</p><div class="section" title="Dropping and linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e267156"></a>Dropping and linking the components</h4></div></div></div><p>To do this, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>From the <span class="emphasis"><strong>Palette</strong></span>, drop <span class="emphasis"><strong>tFileInputXML</strong></span>, <span class="emphasis"><strong>tXMLMap</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span> into
						the <span class="emphasis"><strong>Design</strong></span> workspace.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>A component used in the workspace can be labelled the way you need. In
							this scenario, this input component is labelled
								<span class="emphasis"><em>Customers</em></span> for <span class="emphasis"><strong>tFileInputXML</strong></span>. For further information about how label a
							component, see <span class="emphasis"><em>Talend Open Studio User
								Guide</em></span></p></div></li><li class="listitem"><p>Double click the <span class="emphasis"><strong>tFileInputXML</strong></span> component
						labelled <span class="emphasis"><em>Customers</em></span> to open its contextual menu.</p></li><li class="listitem"><p>From this menu, select <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span> link to connect this component to <span class="emphasis"><strong>tXMLMap</strong></span>..</p></li><li class="listitem"><p>Repeat this operation to connect <span class="emphasis"><strong>tXMLMap</strong></span>
						to <span class="emphasis"><strong>tLogRow</strong></span> using <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>*New output*
							(Main)</strong></span> link. A dialog box pops up to prompt you to name this
						output link. In this scenario, name it as
							<span class="emphasis"><em>Customer_States</em></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap8.png"></div></li></ol></div><p>Then you can continue to configure each component.</p></div><div class="section" title="Configuring the input flow"><div class="titlepage"><div><div><h4 class="title"><a name="d0e267235"></a>Configuring the input flow</h4></div></div></div><p>To do this, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Double-click the <span class="emphasis"><strong>tFileInputXML</strong></span> component
						labelled <span class="emphasis"><em>Customers</em></span> to display its <span class="emphasis"><strong>Basic settings </strong></span>view.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap2.png"></div></li><li class="listitem"><p>Next to <span class="emphasis"><strong>Edit schema</strong></span>, click the three-dot
						button to open the schema editor.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap3.png"></div></li><li class="listitem"><p>In the schema editor, click the plus button to add one row.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Column</strong></span> column, type in a new name
						for this row. In this scenario, it is <span class="emphasis"><em>Customer</em></span>.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Type</strong></span> column, select the data type
						of this row. In this scenario, it is <span class="emphasis"><em>Document</em></span>. The
						document data type is essential for making full use of <span class="emphasis"><strong>tXMLMap</strong></span>. For further information about this data type, see
							<span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate this editing and
						accept the propagation prompted by the popup dialog box. One row is added
						automatically to the <span class="emphasis"><strong>Mapping </strong></span>table.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>File name / Stream</strong></span> field, browse
						to, or type in the path to the XML source that provides the customer
						data.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Loop XPath query</strong></span> field, type in
							<code class="code">&#8220;/&#8221;</code> to replace the default one. This means the source data
						is queried from the root.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>XPath query</strong></span> column of the
							<span class="emphasis"><strong>Mapping</strong></span> table, type in the XPath. In
						this scenario, type in <code class="code">&#8220;.&#8221;</code>, meaning that all of the data from
						source are queried.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Get Nodes</strong></span> column of the <span class="emphasis"><strong>Mapping</strong></span> table, select the check box.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In order to build the <span class="emphasis"><strong>Document</strong></span> type
							data flow, it is necessary to get the nodes from this component.</p></div></li></ol></div></div><div class="section" title="Configuring tXMLMap for transformation"><div class="titlepage"><div><div><h4 class="title"><a name="d0e267343"></a>Configuring tXMLMap for transformation</h4></div></div></div><p>To do this, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Double-click the <span class="emphasis"><strong>tXMLMap</strong></span> component to
						open the <span class="emphasis"><strong>Map Editor</strong></span>. </p><p> Note that the input area is already filled with the defined input tables
						and that the top table is the main input table.</p></li><li class="listitem"><p>In the left table, right-click <span class="emphasis"><strong>Customer</strong></span>
						to open the contextual menu. </p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap5.png"></div></li><li class="listitem"><p>From this contextual menu, select <span class="emphasis"><strong>Import From
							File</strong></span> and in the pop-up dialog box, browse to the
						corresponding source file in order to import therefrom the XML structure
						used by the data to be received by <span class="emphasis"><strong>tXMLMap</strong></span>.
						In this scenario, the source file is <span class="emphasis"><em>Customer.xml</em></span>,
						which is the data input to <span class="emphasis"><strong> tFileInputXML</strong></span>
							(<span class="emphasis"><em>Customers</em></span>).</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>You can also import an XML tree from an XSD file. When importing
							either an input or an output XML tree structure from an XSD file, you
							can choose an element as the root of your XML tree. For more information
							on importing an XML tree from an XSD file, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>. </p></div></li><li class="listitem"><p>In the imported XML tree, right click the <span class="emphasis"><em>Customer</em></span>
						node and select <span class="emphasis"><strong>As loop element</strong></span> to set it
						as the loop element.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap7.png"></div></li><li class="listitem"><p>On the lower part of this map editor, click the <span class="emphasis"><strong>schema editor</strong></span> tab to display the corresponding view.</p></li><li class="listitem"><p>On the right side of this view, click the plus button to add one row to
						the <span class="emphasis"><em>Customer</em></span> table and rename this row as
							<span class="emphasis"><em>Customer_States</em></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap11.png"></div></li><li class="listitem"><p>In the <span class="emphasis"><strong>Type</strong></span> column of this
							<span class="emphasis"><em>Customer_States</em></span> row, select <span class="emphasis"><strong>Document</strong></span> as the data type. The corresponding XML root is
						added automatically to the top table on the right side which represents the
						output flow.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap12.png"></div></li><li class="listitem"><p>On the right side in the top table labelled
							<span class="emphasis"><em>Customer_States</em></span>, import the XML data structure that
						you need to use from the corresponding XML source file. In this scenario, it
						is <span class="emphasis"><em>Customer_State.xml</em></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap9.png"></div></li><li class="listitem"><p>Right click the <span class="emphasis"><em>customer</em></span> node and select <span class="emphasis"><strong>As loop element</strong></span> from the contextual menu.</p><p>Then you can begin to map the input flow to the output flow.</p></li><li class="listitem"><p>In the top table on the input side (left) of the map editor, click
							the<span class="emphasis"><em> id</em></span> node and drop it to the <span class="emphasis"><strong>Expression</strong></span> column in the row corresponding to the
						output row you need map. In this scenario, it is the
							<span class="emphasis"><em>@id</em></span> node.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapBasicMap.png"></div></li><li class="listitem"><p>Do the same to map <span class="emphasis"><em>CustomerName</em></span> to
							<span class="emphasis"><em>CustomerName</em></span>, <span class="emphasis"><em>CustomerAddress</em></span>
						to <span class="emphasis"><em>CustomerAddress</em></span> and <span class="emphasis"><em>idState</em></span> to
							<span class="emphasis"><em>idState</em></span> from the left side to the right
						side.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In the real project, you may have to keep empty elements in your
							output XML tree. If so, you can use <span class="emphasis"><strong>tXMLMap</strong></span> to manage them. For further information about
							how to manage empty elements using <span class="emphasis"><strong>tXMLMap</strong></span>, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p></div></li><li class="listitem"><p>If required to generate single XML flow, click the wrench icon on top of
						the output side to open the setting panel and set the <span class="emphasis"><strong>All in one</strong></span> feature as <span class="emphasis"><strong>true</strong></span>.
						In this example, this option is set as <span class="emphasis"><strong>true</strong></span>. For further information about the <span class="emphasis"><strong>All in one</strong></span> feature, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p><div class="mediaobject"><img src="../images/use_case-txmlmap_all_in_one.png"></div></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate the mappings and
						close the <span class="emphasis"><strong>Map Editor</strong></span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you close the <span class="emphasis"><strong>Map Editor</strong></span> without
							having set the required loop elements as described earlier in this
							scenario, the root element will be automatically set as loop
							element.</p></div></li></ol></div><p>Then you can run this Job.</p></div><div class="section" title="Executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e267547"></a>Executing the Job</h4></div></div></div><p>To execute this Job, Press <span class="emphasis"><strong>F6</strong></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapBasicExecution.png"></div></div></div><div class="section" title="Scenario 2: Launching a lookup in a second XML flow to join complementary data"><div class="titlepage"><div><div><h3 class="title"><a name="Raa28805"></a>Scenario 2: Launching a lookup in a second XML flow to join complementary
			data</h3></div></div></div><p>Based on the previous scenario, this scenario shows how to use lookup in an XML flow
			to join the data of interest to a given XML flow. The XML data for lookup is held in the
				<span class="emphasis"><em>USstates.xml</em></span> file.</p><p>To do this, a <span class="emphasis"><strong>tFileInputXML</strong></span> component is added to the
			previous Job in order to load and send the complementary data to <span class="emphasis"><strong>tXMLMap</strong></span>. Thus this Job looks like as follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap1.png"></div><p>To replicate this scenario, proceed as the following sections illustrate.</p><div class="section" title="Configuring the data flow for lookup"><div class="titlepage"><div><div><h4 class="title"><a name="d0e267579"></a>Configuring the data flow for lookup</h4></div></div></div><p>To do this, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>From the <span class="emphasis"><strong>Palette</strong></span>, drop <span class="emphasis"><strong>tFileInputXML</strong></span> into the Design workspace.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>A component used in the workspace can be labelled the way you need. In
							this scenario, the newly added <span class="emphasis"><strong>tFileInputXML</strong></span> is labelled <span class="emphasis"><em>USstates</em></span>.
							For further information about how to label a component, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span></p></div></li><li class="listitem"><p>Double click the <span class="emphasis"><strong>tFileInputXML</strong></span> component
						labelled <span class="emphasis"><em>USstates</em></span> to open its contextual menu and
						select <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span> connection to connect this component to <span class="emphasis"><strong>tXMLMap</strong></span>. As you create this connection in the
						second place, this connection is of type <span class="emphasis"><strong>Lookup</strong></span>.</p></li><li class="listitem"><p>Double click the <span class="emphasis"><strong>tFileInputXML</strong></span> component
						labelled <span class="emphasis"><em>USstates</em></span> to open its <span class="emphasis"><strong>Component</strong></span> view.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap4.png"></div></li><li class="listitem"><p>Next to <span class="emphasis"><strong>Edit schema</strong></span>, click the three-dot
						buttons to open the schema editor.</p></li><li class="listitem"><p>Click the plus button to add one rows and rename it, for example, as
							<span class="emphasis"><em>USState</em></span>.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Type</strong></span> column, select the <span class="emphasis"><strong>Document</strong></span> option from the drop-down list.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap13.png"></div></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate this editing and
						accept the propagation prompted by the pop-up dialog box.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>File name/Stream</strong></span> field, browse to
						or type in the path to the <span class="emphasis"><em>USStates.xml</em></span> file.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>The input schemas could be stored in the <span class="emphasis"><strong>Metadata</strong></span> node of the <span class="emphasis"><strong>Repository</strong></span> tree view for easy retrieval. For further
							information regarding metadata creation in the Repository, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p></div></li><li class="listitem"><p>In the <span class="emphasis"><strong>Loop XPath query</strong></span> field, type in
							<code class="code">"/"</code> to replace the default value. This means the loop is
						based on the root.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Mapping</strong></span> table, where one row is
						already added automatically, enter <code class="code">"."</code> in the <span class="emphasis"><strong>XPath query</strong></span> column to retrieve US States data
						from the source file.</p></li><li class="listitem"><p>In the <span class="emphasis"><strong>Get Nodes</strong></span> column, select the check
						box. This retrieves the XML structure for the <span class="emphasis"><strong>Document</strong></span> type data.</p></li></ol></div></div><div class="section" title="Configuring the transformation"><div class="titlepage"><div><div><h4 class="title"><a name="d0e267722"></a>Configuring the transformation</h4></div></div></div><p>To do this, proceed as follows</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Double-click the <span class="emphasis"><strong>tXMLMap</strong></span> component to
						open the <span class="emphasis"><strong>Map Editor</strong></span>. </p><p> Note that the input area is already filled with the defined input tables
						and that the top table is the main input table.</p></li><li class="listitem"><p>In the top table, click the <span class="emphasis"><em>idState </em></span>node and drop it,
						in the lower table, to the <span class="emphasis"><strong>Exp.key</strong></span> column
						in the row corresponding to the <span class="emphasis"><em>idState</em></span> row. This
						creates a join between the two tables on the <span class="emphasis"><em>idState</em></span>
						data, among which the <span class="emphasis"><em>idState</em></span> node from the main flow
						provides the lookup key.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap6.png"></div><p>Then you can begin to modify the mapping you have done in the previous
						scenario to join the complementary data into the input flow. This mapping
						then should look like as follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap10b.png"></div></li><li class="listitem"><p>In the <span class="emphasis"><strong>lookup</strong></span> table on the input side
						(left) of the map editor, click the<span class="emphasis"><em> LabelState</em></span> row and
						drop it on the <span class="emphasis"><em>customer</em></span> node on the output side. A
						dialog box pops up.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap14.png"></div></li><li class="listitem"><p>In this dialog box, select <span class="emphasis"><strong>Create as sub-element of
							target node</strong></span> and click <span class="emphasis"><strong>OK</strong></span>.
						This operation adds a new sub-element to the output XML tree and maps it
						with <span class="emphasis"><em>LabelState</em></span> on the input inside at the same
						time.</p></li><li class="listitem"><p>If required to generate single XML flow, click the wrench icon on top of
						the output side to open the setting panel and set the <span class="emphasis"><strong>All in one</strong></span> feature as <span class="emphasis"><strong>true</strong></span>.
						In this example, this option is set as <span class="emphasis"><strong>true</strong></span>. For further information about the <span class="emphasis"><strong>All in one</strong></span> feature, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p><div class="mediaobject"><img src="../images/use_case-txmlmap_all_in_one.png"></div></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate the mappings and
						close the <span class="emphasis"><strong>Map Editor</strong></span>.</p></li><li class="listitem"><p>Press <span class="emphasis"><strong>F6</strong></span> to run this Job.</p></li></ol></div><p>The <span class="emphasis"><strong>Run</strong></span> view presents the execution result which
				may read as follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap15.png"></div><p>The US state labels that correspond to the state IDs provided as the lookup key by the main
				data flow are selected and outputted.</p><p>A step-by-step tutorial related to this Join topic is available on the Talend Technical
				Community Site. For further information, see <a class="link" href="http://talendforge.org/tutorials/tutorial.php?language=english&amp;idTuto=101" target="_top">http://talendforge.org/tutorials/tutorial.php?language=english&amp;idTuto=101</a>. </p></div></div><div class="section" title="Scenario 3: Mapping data using a filter"><div class="titlepage"><div><div><h3 class="title"><a name="Raa13617"></a>Scenario 3: Mapping data using a filter</h3></div></div></div><p>Based on <a class="xref" href="tXMLMap.html#Raa28805" title="Scenario 2: Launching a lookup in a second XML flow to join complementary data">the section called &#8220;Scenario 2: Launching a lookup in a second XML flow to join complementary
			data&#8221;</a>, this scenario presents how to apply filter
			condition(s) to select the data of interest using <span class="emphasis"><strong>tXMLMap</strong></span>.</p><p>For example, you need to select the customer data where the state id is
				<span class="emphasis"><em>9</em></span>.</p><p>To replicate this scenario, proceed as follows: </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In your Studio, open the Job used in the previous scenario to display it in
					the Design workspace.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap1.png"></div></li><li class="listitem"><p>Double click <span class="emphasis"><strong>tXMLMap</strong></span> to open its editor. In
					this editor, the input and output data flows have been mapped since the
					replication of the previous scenario.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap10b.png"></div></li><li class="listitem"><p>On the output side (right), click the <span class="inlinemediaobject"><img src="../images/Expression_Filter.png"></span> button to open the filter area.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapFilter1.png"></div></li><li class="listitem"><p>In this filter area, drop the <span class="emphasis"><em>idState</em></span> node from the tree
					view of the input data flow. The Xpath of <span class="emphasis"><em>idState</em></span> is added
					automatically to this filter area.</p></li><li class="listitem"><p>Still in this area, write down the filter condition of interest in Java. In
					this scenario, this condition reads:
						<code class="code">"9".equals([row1.Customer:/Customers/Customer/Address/idState])</code>
				</p></li><li class="listitem"><p>If required to generate single XML flow, click the wrench icon on top of the
					output side to open the setting panel and set the <span class="emphasis"><strong>All in
						one</strong></span> feature as <span class="emphasis"><strong>true</strong></span>. In this
					example, this option is set as <span class="emphasis"><strong>true</strong></span>. For
					further information about the <span class="emphasis"><strong>All in one</strong></span>
					feature, see <span class="emphasis"><em>Talend Open Studio</em></span>
					<span class="emphasis"><em>User Guide</em></span>.</p><div class="mediaobject"><img src="../images/use_case-txmlmap_all_in_one.png"></div></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate this editing and close
					this editor.</p></li><li class="listitem"><p>Press <span class="emphasis"><strong>F6</strong></span> to run this Job.</p></li></ol></div><p>The execution result is displayed in the <span class="emphasis"><strong>Run</strong></span> view as
			follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapFilter2.png"></div><p>The result says that the customer <span class="emphasis"><em>Pivot Point College</em></span> is selected
			as its state ID is <span class="emphasis"><em>9</em></span>, representing the <span class="emphasis"><em>Florida</em></span>
			state in this scenario.</p></div><div class="section" title="Scenario 4: Catching the data rejected by lookup and filter"><div class="titlepage"><div><div><h3 class="title"><a name="Xaa4534890"></a>Scenario 4: Catching the data rejected by lookup and filter</h3></div></div></div><p>The data rejected by the lookup and filter conditions you set in <span class="emphasis"><strong>tXMLMap</strong></span> can be caught and outputted by this component itself.</p><p>Based on <a class="xref" href="tXMLMap.html#Raa13617" title="Scenario 3: Mapping data using a filter">the section called &#8220;Scenario 3: Mapping data using a filter&#8221;</a>, this scenario presents how to catch the data
			rejected by the lookup and the filter set up in the previous sections.</p><p>In this scenario, another <span class="emphasis"><strong>tLogRow</strong></span> component is added
			to the Job used in the previous scenario and thus the Job displays as follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject1.png"></div><p>To replicate this scenario, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In your Studio, open the Job used in the previous scenario to display it in
					the Design workspace.</p></li><li class="listitem"><p>From the <span class="emphasis"><strong>Palette</strong></span>, drop the <span class="emphasis"><strong>tLogRow</strong></span> component on the workspace.</p></li><li class="listitem"><p>Right-click <span class="emphasis"><strong>tXMLMap</strong></span> to open its contextual
					menu and select <span class="emphasis"><strong>Row &gt; *New Output* (Main)</strong></span> to
					connect this component to the newly added <span class="emphasis"><strong>tLogRow</strong></span> component. A dialog box pops up to prompt you to name
					this output link. In this scenario, name it as
					<span class="emphasis"><em>Reject</em></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject2.png"></div></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate this creation.</p></li><li class="listitem"><p>Double click the <span class="emphasis"><strong>tXMLMap</strong></span> component to open
					its editor. An empty<span class="emphasis"><em> Reject</em></span> table has been added to the
					output side to represent the output data flow carrying the rejected data. You
					need to complete this table to make this editor look like as follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject3.png"></div></li><li class="listitem"><p>Select this empty <span class="emphasis"><em>Reject</em></span> table.</p></li><li class="listitem"><p>In the lower part of this editor, click the <span class="emphasis"><strong>Schema
						editor</strong></span> tab to open the corresponding view.</p></li><li class="listitem"><p>On the right part of this <span class="emphasis"><strong>Schema editor</strong></span> view,
					click the plus button to add the rows you need to use. In this scenario, click
					four times to add four rows to the <span class="emphasis"><em>Reject</em></span> table.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject4.png"></div></li><li class="listitem"><p>In the <span class="emphasis"><em>Reject</em></span> table presented on the right part of this
						<span class="emphasis"><strong>Schema editor</strong></span> view, rename each of the four
					newly added rows. They are: <span class="emphasis"><em>ID</em></span>,
						<span class="emphasis"><em>Customer</em></span>, <span class="emphasis"><em>idState</em></span>,
						<span class="emphasis"><em>LabelState</em></span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In this scenario, the <span class="emphasis"><em>Reject </em></span>output flow uses flat
						data type. However, you can create an XML tree view for this flow using the
							<span class="emphasis"><strong>Document</strong></span> data type. For further
						information about how to use this <span class="emphasis"><strong>Document</strong></span>
						type, see <a class="xref" href="tXMLMap.html#Raa61298" title="Scenario 1: Mapping and transforming XML data">the section called &#8220;Scenario 1: Mapping and transforming XML data&#8221;</a>.</p></div><p>The <span class="emphasis"><em>Reject</em></span> table is completed and thus you have defined
					the schema of the output flow used to carry the captured rejected data. Then you
					need to set up the condition(s) to catch the rejected data of interest.</p></li><li class="listitem"><p>On the upper part of the output side in this <span class="emphasis"><strong>Map
						editor</strong></span>, select the <span class="emphasis"><em>Reject</em></span> table.</p></li><li class="listitem"><p>At the top of this table, click the <span class="inlinemediaobject"><img src="../images/Map_setting.png"></span> button to open the setting area.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject5.png"></div></li><li class="listitem"><p>In the <span class="emphasis"><strong>Catch Output Reject</strong></span> row of the setting
					area, select <span class="emphasis"><strong>true</strong></span> from the drop-down list. Thus
						<span class="emphasis"><strong>tXMLMap</strong></span> outputs the data rejected by the
					filter set up in the previous scenario for the <span class="emphasis"><em>Customer</em></span>
					output flow.</p></li><li class="listitem"><p>Do the same thing to switch the <span class="emphasis"><strong>Catch Lookup Inner Join
						Reject</strong></span> row to the <span class="emphasis"><strong>true</strong></span>
					option.</p></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate this editing and close
					this editor.</p></li><li class="listitem"><p>Press <span class="emphasis"><strong>F6</strong></span> to run this Job.</p></li></ol></div><p>The captured data rejected by the filter and the lookup reads as follows in the
				<span class="emphasis"><strong>Run</strong></span> view:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject6.png"></div><p>None of the State IDs of these customers is <span class="emphasis"><em>9</em></span>. The customer
				<span class="emphasis"><em>BBQ Smith&#8217;s Tex Mex</em></span> is marked with the state ID
				<span class="emphasis"><em>60</em></span>. This number does not exist in the
				<span class="emphasis"><em>idState</em></span> column of <span class="emphasis"><em>USState.txt</em></span> where the
			defined lookup was done, so the data of this customer is rejected by the lookup and the
			other data rejected by the filter.</p><p>The data selected by the filter you set up in the previous scenario reads as follows
			in XML format.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapReject7.png"></div></div><div class="section" title="Scenario 5: Mapping data using a group element"><div class="titlepage"><div><div><h3 class="title"><a name="Raa18177"></a>Scenario 5: Mapping data using a group element</h3></div></div></div><p>Based on the Job used in <a class="xref" href="tXMLMap.html#Raa28805" title="Scenario 2: Launching a lookup in a second XML flow to join complementary data">the section called &#8220;Scenario 2: Launching a lookup in a second XML flow to join complementary
			data&#8221;</a>, this scenario presents how to set
			up an element as <span class="emphasis"><strong>group element</strong></span> in the <span class="emphasis"><strong>Map editor</strong></span> of <span class="emphasis"><strong>tXMLMap</strong></span> to
			group the output data.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap1.png"></div><p>To replicate this scenario, you can reuse the Job in <a class="xref" href="tXMLMap.html#Raa28805" title="Scenario 2: Launching a lookup in a second XML flow to join complementary data">the section called &#8220;Scenario 2: Launching a lookup in a second XML flow to join complementary
			data&#8221;</a>. </p><p>In this Job, double click <span class="emphasis"><strong>tXMLMap</strong></span> to open the
				<span class="emphasis"><strong>Map editor</strong></span>.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap10b.png"></div><p>The objective of this scenario is to group the customer id and the customer name
			information according to the States the customers come from. To do this, you need to
			adjust the XML structure with considering the following factors:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The elements tagging the customer id and the customer name information should
					be located under the loop element. Thus they are the sub-elements of the loop
					element.</p></li><li class="listitem"><p>The loop element and its sub-elements should be dependent directly on the
					group element.</p></li><li class="listitem"><p>The element tagging the States used as grouping condition should be dependent
					directly on the group element.</p></li><li class="listitem"><p>The group element cannot be the root element.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>To put a group element into effect, the XML data to be processed should have been
				sorted, for example via your XML tools, around the element you need to use as the
				grouping condition. The figure below presents part of the sorted source data used in
				this scenario. The customers possessing the same State id is already put
				together.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap-sorted_source.png" align="middle"></div></div><p>Based on this analysis, the structure of the output data should read as
			follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapGroup1.png"></div><p>In this figure, the <span class="emphasis"><em>customers</em></span> node is the root, the
				<span class="emphasis"><em>Customer</em></span> element is set as <span class="emphasis"><strong>group
				element</strong></span> and the output data is grouped according to the
				<span class="emphasis"><em>LabelState</em></span> element.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>To set a group element, two restrictions must be respected: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>the root node cannot be set as <span class="emphasis"><strong>group
								element</strong></span>;</p></li><li class="listitem"><p>the <span class="emphasis"><strong>group element</strong></span> must be the parent
							of the loop element.</p></li></ul></div><p>Once the group element is set, the first element except the loop one is used as
				condition to group the output data.</p></div><p>To perform the adjustment according to this analysis, proceed as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>In the XML tree view of the output side, right-click the <span class="emphasis"><em>customer
						(loop:true)</em></span> node to open the contextual menu and select <span class="emphasis"><strong>Delete</strong></span>. Thus all of the elements under the root
						<span class="emphasis"><em>customers</em></span> are removed. Then you can reconstruct the XML
					tree view to have the best structure used to group the output data of
					interest.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapGroup2.png"></div></li><li class="listitem"><p>Again in the XML tree view of the output side, right-click the root node
						<span class="emphasis"><em>customers</em></span> to open the contextual menu and select
						<span class="emphasis"><strong>Create sub-element</strong></span>. Then a dialog box pops
					up.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapGroup3.png"></div></li><li class="listitem"><p>Type in the name of the new sub-element. In this scenario, it is
						<span class="emphasis"><em>Customer</em></span>.</p></li><li class="listitem"><p>Repeat the previous operations to create two more sub-elements under this
						<span class="emphasis"><em>Customer</em></span> node. They are:
						<span class="emphasis"><em>LabelState</em></span> and <span class="emphasis"><em>Name</em></span>.</p></li><li class="listitem"><p>Do these operations again to create two more sub-elements under this newly
					created <span class="emphasis"><em>Name</em></span> node. They are: <span class="emphasis"><em>id</em></span> and
						<span class="emphasis"><em>CustomerName</em></span>.</p></li><li class="listitem"><p>Right-click the <span class="emphasis"><em>Name</em></span> node to open the contextual menu and
					select <span class="emphasis"><strong>As loop element</strong></span> to set this element as
					loop.</p></li><li class="listitem"><p>Right-click the <span class="emphasis"><em>Customer</em></span> node to open its contextual menu
					and select <span class="emphasis"><strong>As group element</strong></span>. This means that
					the output data is grouped according to the <span class="emphasis"><em>LabelState</em></span>
					element.</p></li><li class="listitem"><p>From the lookup data flow on the input side, click and drop the
						<span class="emphasis"><em>LabelState</em></span> row to the row of the
						<span class="emphasis"><em>LabelState</em></span> node in the <span class="emphasis"><strong>Expression</strong></span> column on the output side. Thus the corresponding
					data is mapped.</p></li><li class="listitem"><p>Do the same to map the <span class="emphasis"><em>id</em></span> element and the
						<span class="emphasis"><em>CustomerName</em></span> elements between both sides. Then this
					modification is done.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapGroup4.png"></div></li><li class="listitem"><p>If required to generate single XML flow, click the wrench icon on top of the
					output side to open the setting panel and set the <span class="emphasis"><strong>All in
						one</strong></span> feature as <span class="emphasis"><strong>true</strong></span>. In this
					example, this option is set as <span class="emphasis"><strong>true</strong></span>. For
					further information about the <span class="emphasis"><strong>All in one</strong></span>
					feature, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate this modification and
					close this editor.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you close the <span class="emphasis"><strong>Map Editor</strong></span> without
						having set the required loop elements as described earlier in this scenario,
						the root element will be automatically set as loop element.</p></div></li><li class="listitem"><p>Press <span class="emphasis"><strong>F6</strong></span> to run this Job.</p></li></ol></div><p>The execution result reads as follows in the <span class="emphasis"><strong>Run</strong></span>
			view.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapGroup5.png"></div><p>The <span class="emphasis"><em>id</em></span> element and the <span class="emphasis"><em>CustomerName</em></span> element
			contained in the loop are grouped according to the <span class="emphasis"><em>LabelState</em></span>
			element. The group element <span class="emphasis"><em>Customer</em></span> tags the start and the end of
			each group.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><span class="emphasis"><strong>tXMLMap</strong></span> provides <span class="emphasis"><strong>group
					element</strong></span> and <span class="emphasis"><strong>aggregate element</strong></span> to
				classify data in the XML tree structure. When handling one row of data ( one
				complete XML flow), the behavioral difference between them is:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <span class="emphasis"><strong>group element</strong></span> processes the data
							always within one single flow.</p></li><li class="listitem"><p>The <span class="emphasis"><strong>aggregate element</strong></span> splits this
							flow into separate and complete XML flows.</p></li></ul></div></div></div><div class="section" title="Scenario 6: classing the output data with aggregate element"><div class="titlepage"><div><div><h3 class="title"><a name="d0e268455"></a>Scenario 6: classing the output data with aggregate element</h3></div></div></div><p>Based on the Job used in <a class="xref" href="tXMLMap.html#Raa18177" title="Scenario 5: Mapping data using a group element">the section called &#8220;Scenario 5: Mapping data using a group element&#8221;</a>, this scenario presents how to set
			up an element as <span class="emphasis"><strong>aggregate element</strong></span> in the <span class="emphasis"><strong>Map editor</strong></span> of <span class="emphasis"><strong>tXMLMap</strong></span> in
			order to class the output data into separate XML flows.</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMap1.png"></div><p>On the Design workspace, double-click the <span class="emphasis"><strong>tXMLMap</strong></span>
			component to open its <span class="emphasis"><strong>Map editor</strong></span>. There the output side
			reads as follows:</p><div class="mediaobject"><img src="../images/Use_Case_tXMLMapGroup4.png"></div><p>The objective of this scenario is to class the customer information using aggregate
			element in accordance with the States they come from and then to send these classes
			separately in different XML flows to the component that follows.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>To put an aggregate element into effect, the XML data to be processed should have
				been sorted, for example via your XML tools, around the element you need to use as
				the aggregating condition. The figure below presents part of the sorted source data
				used in this scenario. The customers possessing the same State id is already put
				together.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap-sorted_source.png" align="middle"></div></div><p>To do this, adjust the output XML tree as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>Right-click the <span class="emphasis"><strong>Customer</strong></span> element to open
						its contextual menu and from this menu, select <span class="emphasis"><strong>Remove
							group element</strong></span>.</p></li><li class="listitem"><p>Click the wrench icon on top of the output side to open the setting panel
						and set the <span class="emphasis"><strong>All in one</strong></span> feature as <span class="emphasis"><strong>false</strong></span>.</p></li><li class="listitem"><p>Right-click the <span class="emphasis"><strong>LabelState</strong></span> element to
						open its context menu and from this menu, select <span class="emphasis"><strong>As
							aggregate element</strong></span>. This element tags the State information of
						each customer and the customer information will be classed under the State
						information.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>To make the aggregate element available, ensure that the <span class="emphasis"><strong>All in one</strong></span> feature is set as <span class="emphasis"><strong>false</strong></span>. For further information about the
								<span class="emphasis"><strong>All in one</strong></span> feature, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>
						</p></div></li><li class="listitem"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate these changes and
						close the <span class="emphasis"><strong>Map editor</strong></span>.</p></li><li class="listitem"><p>Press <span class="emphasis"><strong>F6</strong></span> to run this Job.</p></li></ol></div><p>Once done, the <span class="emphasis"><strong>Run</strong></span> view is opened automatically,
			where you can check the execution result.</p><div class="mediaobject"><img src="../images/use_case-txmlmap_aggregate.png"></div><p><span class="emphasis"><strong>tXMLMap</strong></span> outputs three separate XML flows, each of
			which carries the information of one State and the customers from that State.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p><span class="emphasis"><strong>tXMLMap</strong></span> provides <span class="emphasis"><strong>group
					element</strong></span> and <span class="emphasis"><strong>aggregate element</strong></span> to
				classify data in the XML tree structure. When handling one row of data ( one
				complete XML flow), the behavioral difference between them is:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The <span class="emphasis"><strong>group element</strong></span> processes the data
							always within one single flow.</p></li><li class="listitem"><p>The <span class="emphasis"><strong>aggregate element</strong></span> splits this
							flow into separate and complete XML flows.</p></li></ul></div></div></div><div class="section" title="Scenario 7: Restructuring products data using multiple loop elements"><div class="titlepage"><div><div><h3 class="title"><a name="d0e268589"></a>Scenario 7: Restructuring products data using multiple loop elements</h3></div></div></div><p>This scenario uses a four-component Job to restructure the products data given by a
			document flow using multiple loop elements.</p><div class="mediaobject" align="center"><img src="../images/txmlmap-multiloop3.png" align="middle"></div><p>The components used are:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><strong>tFileInputXML</strong></span>: it reads the source product
					data and pass them to the tXMLMap component.</p></li><li class="listitem"><p><span class="emphasis"><strong>tXMLMap</strong></span>: it transforms the input flows with
					the expected structure streamlined.</p></li><li class="listitem"><p><span class="emphasis"><strong>tLogRow</strong></span>: it presents the execution result in
					the console.</p></li><li class="listitem"><p><span class="emphasis"><strong>tFileOutputDelimited</strong></span>: it generates the output
					flow into an XML file.</p></li></ul></div><p>The input flow reads as follows:</p><div class="mediaobject" align="center"><img src="../images/txmlmap-multiloop1.png" align="middle"></div><p>The objective of this restructuring is to streamline the presentation of the products
			information to serve the manufacturing operations.</p><p>The output flow is expected to read as follows:</p><div class="mediaobject" align="center"><img src="../images/txmlmap-multiloop2.png" align="middle"></div><p>In the output flow, the root element is changed to <span class="emphasis"><em>manufactures</em></span>, the sales information is selected and consolidated into
			the <span class="emphasis"><em>sale</em></span> element and the <span class="emphasis"><em>manufacture</em></span> element is reduced to one single level.</p><p>To replicate this scenario, proceed as follows:</p><div class="section" title="Dropping and linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e268645"></a>Dropping and linking the components</h4></div></div></div><p>To do this, perform the following operations:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>On the workspace, drop <span class="emphasis"><strong>tFileInputXML</strong></span>,<span class="emphasis"><strong> tXMLMap</strong></span>,
							<span class="emphasis"><strong>tLogRow</strong></span> and <span class="emphasis"><strong>tFileOutputDelimited</strong></span> from the <span class="emphasis"><strong>Palette</strong></span>.</p></li><li class="step" title="Step 2"><p>Right-click <span class="emphasis"><strong>tFileInputXML</strong></span> to open its
						contextual menu and select the <span class="emphasis"><strong>Row</strong></span> &gt;
							<span class="emphasis"><strong>Main</strong></span> link from this menu to connect
						this component to the <span class="emphasis"><strong>tXMLMap</strong></span>
						component.</p></li><li class="step" title="Step 3"><p>Repeat this operation to connect <span class="emphasis"><strong>tXMLMap</strong></span>
						to <span class="emphasis"><strong>tLogRow</strong></span> using <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>*New output*
							(Main)</strong></span> link. A dialog box pops up to prompt you to name this
						output link. In this scenario, name it as
						<span class="emphasis"><em>outDoc</em></span>.</p></li><li class="step" title="Step 4"><p>Do the same to connect <span class="emphasis"><strong>tLogRow</strong></span> to
							<span class="emphasis"><strong>tFileOutputDelimited</strong></span> using the
							<span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span> link.</p></li></ol></div></div><div class="section" title="Configuring the input flow"><div class="titlepage"><div><div><h4 class="title"><a name="d0e268717"></a>Configuring the input flow</h4></div></div></div><p>To do this, do the following:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tFileInputXML</strong></span> to open its
							<span class="emphasis"><strong>Component</strong></span> view.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop4.png" align="middle"></div></li><li class="step" title="Step 2"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop5.png" align="middle"></div></li><li class="step" title="Step 3"><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add one row to
						the editor and rename it as <span class="emphasis"><em>doc</em></span>.</p></li><li class="step" title="Step 4"><p>In the <span class="emphasis"><strong>Type</strong></span> column, select <span class="emphasis"><strong>Document</strong></span> from the drop-down list as the type of
						the input flow.</p></li><li class="step" title="Step 5"><p> In the <span class="emphasis"><strong>File name / Stream</strong></span> field, browse
						to, or type in the path to the XML source that provides the customer
						data.</p></li><li class="step" title="Step 6"><p>In the <span class="emphasis"><strong>Loop XPath query</strong></span> field, type in
							<code class="code">&#8220;/&#8221;</code> to replace the default one. This means the source data
						is queried from the root.</p></li><li class="step" title="Step 7"><p>In the <span class="emphasis"><strong>XPath query</strong></span> column of the
							<span class="emphasis"><strong>Mapping</strong></span> table, type in the XPath. In
						this scenario, type in <code class="code">&#8220;.&#8221;</code>, meaning that all of the data from
						source are queried.</p></li><li class="step" title="Step 8"><p>In the <span class="emphasis"><strong>Get Nodes</strong></span> column of the <span class="emphasis"><strong>Mapping</strong></span> table, select the check box.</p></li></ol></div></div><div class="section" title="Configuring tXMLMap with multiple loops"><div class="titlepage"><div><div><h4 class="title"><a name="d0e268801"></a>Configuring tXMLMap with multiple loops</h4></div></div></div><p>To do this, proceed as follows:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="emphasis"><strong>tXMLMap</strong></span> component to
						open the <span class="emphasis"><strong>Map Editor</strong></span>. </p><p> Note that the input area is already filled with the default basic XML
						structure and that the top table is the main input table.</p></li><li class="step" title="Step 2"><p>In the left table, right-click <span class="emphasis"><em>doc</em></span> to
						open the contextual menu. </p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop6.png" align="middle"></div></li><li class="step" title="Step 3"><p>From this contextual menu, select <span class="emphasis"><strong>Import From File</strong></span> and
						in the pop-up dialog box, browse to the corresponding source file in order
						to import therefrom the XML structure used by the data to be received by
							<span class="emphasis"><strong>tXMLMap</strong></span>. In this scenario, the source
						file is <span class="emphasis"><em>input2.xml</em></span>, which provides the data read and
						loaded by <span class="emphasis"><strong>tFileInputXML</strong></span>.</p></li><li class="step" title="Step 4"><p>In the imported XML tree, right-click the <span class="emphasis"><em>manufacture</em></span>
						node and select <span class="emphasis"><strong>As loop element</strong></span> to set it
						as the loop element. Then do the same to set the <span class="emphasis"><em>types</em></span> node and the <span class="emphasis"><em>sale</em></span>
						node as loop element, respectively.</p></li><li class="step" title="Step 5"><p>On the lower part of this map editor, click the <span class="emphasis"><strong>schema editor</strong></span> tab to display the corresponding view.</p></li><li class="step" title="Step 6"><p>On the right side of this view, click the <span class="emphasis"><strong>[+]</strong></span> button to add one row to the <span class="emphasis"><em>outDoc</em></span> table and rename this row as <span class="emphasis"><em>outDoc</em></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop7.png" align="middle"></div></li><li class="step" title="Step 7"><p>In the <span class="emphasis"><strong>Type</strong></span> column of this
							<span class="emphasis"><em>outDoc</em></span> row, select <span class="emphasis"><strong>Document</strong></span> as the data type. The corresponding XML root is
						added automatically to the top table on the right side which represents the
						output flow.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop8.png" align="middle"></div></li><li class="step" title="Step 8"><p>On the right side in the top table labelled <span class="emphasis"><em>outDoc</em></span>, import the XML data structure that you need to use
						from the corresponding XML source file. In this scenario, it is <span class="emphasis"><em>ref.xml</em></span>. This file provides the expected XML
						structure mentioned earlier.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop9.png" align="middle"></div></li><li class="step" title="Step 9"><p>Right-click the <span class="emphasis"><em>manufacture</em></span> node and select <span class="emphasis"><strong>As loop element</strong></span> from the contextual menu. Then do
						the same to set the <span class="emphasis"><em>types</em></span> node and the
							<span class="emphasis"><em>sale</em></span> node as loop element,
						respectively.</p><p>Then you can begin to map the input flow to the output flow.</p></li><li class="step" title="Step 10"><p>In the top table on the input side (left) of the map editor, click the<span class="emphasis"><em> @category</em></span> node and drop it to the <span class="emphasis"><strong>Expression</strong></span> column in the row corresponding to the
						output row you need to map. In this scenario, it is the <span class="emphasis"><em>@category</em></span> node.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop10.png" align="middle"></div></li><li class="step" title="Step 11"><p>Do the same to map: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="emphasis"><em>@name</em></span> to <span class="emphasis"><em>@name</em></span></p></li><li class="listitem"><p><span class="emphasis"><em>@unit</em></span> under the <span class="emphasis"><em>summary</em></span> node to <span class="emphasis"><em>@unit</em></span></p></li><li class="listitem"><p><span class="emphasis"><em>@id</em></span> to <span class="emphasis"><em>@id</em></span> and
									to <span class="emphasis"><em>manufacture id</em></span>,
									respectively</p></li><li class="listitem"><p><span class="emphasis"><em>@date</em></span> to <span class="emphasis"><em>@date</em></span></p></li><li class="listitem"><p><span class="emphasis"><em>name</em></span> to <span class="emphasis"><em>@name</em></span></p></li><li class="listitem"><p><span class="emphasis"><em>type</em></span> to <span class="emphasis"><em>type</em></span></p></li><li class="listitem"><p><span class="emphasis"><em>@type</em></span> to <span class="emphasis"><em>@sales_type</em></span></p></li><li class="listitem"><p><span class="emphasis"><em>income</em></span> to <span class="emphasis"><em>sale (loop)</em></span></p></li></ul></div></li><li class="step" title="Step 12"><p>If required to generate single XML flow, click the wrench icon on top of
						the output side to open the setting panel and set the <span class="emphasis"><strong>All in one</strong></span> feature as <span class="emphasis"><strong>true</strong></span>.
						In this example, this option is set as <span class="emphasis"><strong>true</strong></span>. For further information about the <span class="emphasis"><strong>All in one</strong></span> feature, see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p></li><li class="step" title="Step 13"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to the <span class="emphasis"><strong>types</strong></span> loop element to open the loop sequence table. In this
						table, ensure that the <span class="emphasis"><em>types</em></span> input loop
						is the primary loop, meaning that its sequence number is <span class="emphasis"><em>1</em></span>. This way, the relative part of the output
						flow will be sorted with regards to the values of the <span class="emphasis"><em>type</em></span> element.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop11.png" align="middle"></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>When a loop element receives mappings from more than one loop element of the input flow,
							a <span class="emphasis"><strong>[...]</strong></span> button appears next to this
							receiving loop element and allows you to set the sequence of the input
							loops. For example, in this scenario the <span class="emphasis"><em>types</em></span> loop element of the output flow is mapped with
								<span class="emphasis"><em>@id</em></span> and<span class="emphasis"><em>
								type</em></span> which belong to the <span class="emphasis"><em>manufacture</em></span> loop element and the <span class="emphasis"><em>types</em></span> loop element, respectively, so the <span class="emphasis"><strong>[...]</strong></span> button appears beside this<span class="emphasis"><em> types</em></span> loop element.</p><p>If the receiving flow is flat data, once it receives mappings from more than one loop
							element, this <span class="emphasis"><strong>[...]</strong></span> button appears as
							well, on the head of the table representing the flat data flow,
							though.</p></div></li><li class="step" title="Step 14"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate the mappings and
						close the <span class="emphasis"><strong>Map Editor</strong></span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>If you close the <span class="emphasis"><strong>Map Editor</strong></span> without
							having set the required loop elements as described earlier in this
							scenario, the root element will be automatically set as loop
							element.</p></div></li></ol></div></div><div class="section" title="Configuring the output flow"><div class="titlepage"><div><div><h4 class="title"><a name="d0e269090"></a>Configuring the output flow</h4></div></div></div><p>To do this, proceed as follows:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tLogRow</strong></span> to open its <span class="emphasis"><strong>Component</strong></span> view.</p></li><li class="step" title="Step 2"><p>If this component does not have the same schema of the preceding component, a warning
					icon appears. In this case, click the <span class="emphasis"><strong>Sync
						columns</strong></span> button to retrieve the schema from the
						preceding one and once done, the warning icon disappears. </p></li><li class="step" title="Step 3"><p>Click <span class="emphasis"><strong>OK</strong></span> to validate these changes and accept the
				propagation prompted by the pop-up dialog box.</p></li><li class="step" title="Step 4"><p>Double-click <span class="emphasis"><strong>tFileOutputDelimited</strong></span> to open its
				<span class="emphasis"><strong>Component</strong></span> view.</p></li><li class="step" title="Step 5"><p>In the <span class="emphasis"><strong>File Name</strong></span> field, browse to, or enter the path to the
						file you need to generate the output flow in.</p></li></ol></div></div><div class="section" title="Executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e269132"></a> Executing the Job </h4></div></div></div><p>To execute this Job, press <span class="emphasis"><strong>F6</strong></span>. </p><p>Once done, the <span class="emphasis"><strong>Run</strong></span> view is opened automatically,
				where you can check the execution result.</p><div class="mediaobject" align="center"><img src="../images/use_case-txmlmap_multiloop12.png" align="middle"></div><p>Open the file generated, and you will see the expected products data restructured for manufacturing.</p></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tWriteJSONField.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-processing.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="ch-system.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">tWriteJSONField&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tos-components-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;19.&nbsp;System components</td></tr></table></div></body></html>