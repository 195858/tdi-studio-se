<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tSOAP</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="ch12.html" title="Chapter&nbsp;12.&nbsp;Internet components"><link rel="prev" href="tSocketOutput.html" title="tSocketOutput"><link rel="next" href="tWebServiceInput.html" title="tWebServiceInput"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="tSOAP"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tSOAP"></a>tSOAP</h2></div></div></div><div class="mediaobject"><img src="../images/tSOAP_icon32.png"></div><div class="section" title="tSOAP properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e221700"></a>tSOAP properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top"><p><span class="bold"><strong>Component family</strong></span></p>
                  </td><td valign="top"><p>Internet </p>
                  </td><td valign="top">&nbsp;</td></tr><tr><td valign="top"><p><span class="bold"><strong>Function</strong></span></p>
                  </td><td colspan="2" valign="top"><p><span class="bold"><strong>tSOAP</strong></span> sends the defined SOAP message with the given
                        parameters to the invoked Web service and returns the value as defined,
                        based on the given parameters.</p>
                  </td></tr><tr><td valign="top"><p><span class="bold"><strong>Purpose</strong></span></p>
                  </td><td colspan="2" valign="top"><p>This component calls a method
                        via a Web service in order to retrieve the values of the parameters defined
                        in the component editor.</p>
                  </td></tr><tr><td valign="top"><p><span class="bold"><strong>Basic settings</strong></span></p>
                  </td><td valign="top"><p><span class="emphasis"><em>Schema</em></span> and <span class="emphasis"><em>Edit
                           schema</em></span></p>
                  </td><td valign="top"><p>A schema is a row description, i.e., it defines the
                        number of fields that will be processed and passed on to the next component.
                        </p><p>This component always uses a built-in, read-only schema. </p>
                     <p>By default, the schema contains three <span class="bold"><strong>String</strong></span> type columns:</p><p> - <span class="bold"><strong>Header</strong></span>: stores the
                        SOAP message header of the response from the server end.</p><p> -
                           <span class="bold"><strong>Body</strong></span>: stores the SOAP message body of
                        the response from the server end.</p><p> - <span class="bold"><strong>Fault</strong></span>: stores the error information when an error occurs
                        during the SOAP message processing.</p>
                     <p>If the <span class="bold"><strong>Output in Document</strong></span> check box is
                        selected, the schema then contains only one <span class="bold"><strong>Document</strong></span> type column named <span class="bold"><strong>Soap</strong></span>, which stores the whole response SOAP message in the XML
                        format.</p><p> </p><p> Click <span class="bold"><strong>Edit schema</strong></span> to view the schema structure.</p>
                     <div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>Changing the schema type may result in loss of the schema
                              structure and therefore failure of the component.</em></span></p></td></tr></table></div>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>Use NTLM</em></span></p>
                  </td><td valign="top"><p>Select this check box if you want to use the NTLM
                        authentication protocol.</p><p>
                        <span class="bold"><strong>Domain</strong></span>: Name of the client domain.</p>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>Need authentication</em></span></p>
                  </td><td valign="top"><p>Select this check box and enter a user name and a
                        password in the corresponding fields if this is necessary to access the
                        service.</p>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>Use http proxy</em></span></p>
                  </td><td valign="top"><p>Select this check box if you are using a proxy server
                        and fill in the necessary information.</p>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>Trust server with SSL</em></span></p>
                  </td><td valign="top"><p>Select this check box to validate the server certificate
                        to the client via an SSL protocol and fill in the corresponding
                        fields:</p><p>
                        <span class="bold"><strong>TrustStore file</strong></span>: enter the path (including
                        filename) to the certificate TrustStore file that contains the list of
                        certificates that the client trusts.</p><p>
                        <span class="bold"><strong>TrustStore password</strong></span>: enter the password
                        used to check the integrity of the TrustStore data. </p>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>ENDPOINT</em></span></p>
                  </td><td valign="top"><p>Type in the URL address of the invoked Web
                        server.</p>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>SOAP Action</em></span></p>
                  </td><td valign="top"><p>Type in the URL address of the SOAPAction HTTP header
                        field to be used to identify the intent of the SOAP HTTP request.</p>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>SOAP version</em></span></p>
                  </td><td valign="top"><p>Select the version of the SOAP system you are
                        using.</p><p> </p>
                     <div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p><span class="emphasis"><em>The required SOAP Envelope varies among
                           versions.</em></span></p></td></tr></table></div>
                  </td></tr><tr><td>&nbsp;</td><td valign="top"><span class="italic">Use a message from the input
                        schema</span></td><td valign="top">
                     <p>Select this check box to read a SOAP message from the preceding component
                        to send to the invoked Web service.</p>
                     <p>When this check box is selected, the <span class="bold"><strong>SOAP
                           message</strong></span> field becomes a drop-down list allowing you to select
                        a <span class="bold"><strong>Document</strong></span> type column to read an input XML
                        file.</p>
                     <div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Warning"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Warning]" src="../images/warning.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p><span class="italic">This option makes sense only when the
                                 <span class="bold"><strong>tSOAP</strong></span> component is connected with
                              an input component the schema of which contains a <span class="bold"><strong>Document</strong></span> type column to read a valid SOAP
                              message.</span></p></td></tr></table></div>
                  </td></tr><tr><td>&nbsp;</td><td valign="top"><span class="italic">Output in Document</span></td><td valign="top">Select this check box to output the response message in XML
                     format.</td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>SOAP message</em></span></p>
                  </td><td valign="top"><p>Type in the SOAP message to be sent to the invoked Web
                        service. The global and context variables can be used when you write a SOAP
                        message.</p><p> For further information about the context variables,
                        see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p>
                  </td></tr><tr><td valign="top"><p><span class="bold"><strong>Advanced
                        settings</strong></span></p>
                  </td><td valign="top"><p><span class="emphasis"><em>Use Kerberos</em></span></p>
                  </td><td valign="top"><p>Select this check box to choose a <span class="bold"><strong>tSetKerberosConfiguration</strong></span> component from the <span class="bold"><strong>Kerberos configuration</strong></span> list. </p>
                     <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>The <span class="bold"><strong>OnSubjobOk</strong></span> trigger of <span class="bold"><strong>tSetKerberosConfiguration</strong></span> should be used for
                           connection with <span class="bold"><strong>tSoap</strong></span>.</p></td></tr></table></div>
                  </td></tr><tr><td><p>&nbsp;</p>
                  </td><td valign="top"><p><span class="emphasis"><em>tStatCatcher Statistics</em></span></p>
                  </td><td valign="top"><p>Select this check box to gather the Job processing
                        metadata at a Job level as well as at each component level.</p>
                  </td></tr><tr><td valign="top"><p><span class="bold"><strong>Usage</strong></span></p>
                  </td><td colspan="2" valign="top"><p>This component can be used as
                        an input or as an intermediate component.</p>
                  </td></tr><tr><td valign="top"><p><span class="bold"><strong>Connections</strong></span></p>
                  </td><td><p>&nbsp;</p>
                  </td><td valign="top"><p>Outgoing links (from one component to another):</p><p>
                        <span class="bold"><strong>Row</strong></span>: Main; Iterate</p><p>
                        <span class="bold"><strong>Trigger</strong></span>: Run if; On Component Ok; On
                        Component Error.</p><p> </p><p> Incoming links (from one
                        component to another):</p><p>
                        <span class="bold"><strong>Row</strong></span>: Main; Iterate</p><p>
                        <span class="bold"><strong>Trigger</strong></span>: Run if; On Component Ok; On
                        Component Error.</p><p> For further information regarding connections,
                        see <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p>
                  </td></tr><tr><td valign="top"><p><span class="bold"><strong>Limitation</strong></span></p>
                  </td><td colspan="2" valign="top"><p>N/A</p>
                  </td></tr></tbody></table></div></div><div class="section" title="Scenario 1: Extracting the weather information using a Web service"><div class="titlepage"><div><div><h3 class="title"><a name="Raa15285"></a>Scenario 1: Extracting the weather information using a Web service</h3></div></div></div><p>This scenario describes a two-component Job that uses a Web service to retrieve the
         weather information of a given American city.</p><p>The Web service to be used is <a class="link" href="http://www.deeptraining.com/webservices/weather.asmx" target="_top">http://www.deeptraining.com/webservices/weather.asmx</a>.</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop the following components from the <span class="bold"><strong>Palette</strong></span>
               onto the design workspace: <span class="bold"><strong>tSOAP</strong></span> and <span class="bold"><strong>tLogRow</strong></span>.</p><div class="mediaobject"><img src="../images/Use_case_tSOAP1.png"></div></li><li class="step" title="Step 2"><p>Right click <span class="bold"><strong>tSOAP</strong></span>, select <span class="bold"><strong>Row &gt; Main</strong></span> from the contextual menu, and click <span class="bold"><strong>tLogRow</strong></span> to connect the components together using a
                  <span class="bold"><strong>Main Row</strong></span> link.</p></li><li class="step" title="Step 3"><p>Double-click <span class="bold"><strong>tSOAP</strong></span> to open its <span class="bold"><strong>Basic settings</strong></span> view and define the component
               properties.</p><div class="mediaobject"><img src="../images/Use_case_tSOAP2.png"></div></li><li class="step" title="Step 4"><p>In <span class="bold"><strong>ENDPOINT</strong></span> field, type in or copy-paste the URL
               address of the Web service to be used between the quotation marks:
                  <span class="emphasis"><em>&#8220;http://www.deeptraining.com/webservices/weather.asmx&#8221;</em></span>.</p></li><li class="step" title="Step 5"><p>In the <span class="bold"><strong>SOAP Action</strong></span> field, type in or copy-paste
               the URL address of the SOAPAction HTTP header field that indicates that you want to
               retrieve the weather information:
                  <span class="emphasis"><em>http://litwinconsulting.com/webservices/GetWeather</em></span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>You can see this address by looking at the WSDL for the Web service you are
                  calling. For the Web service of this example, in a web browser, append
                     <code class="code">?wsdl</code> on the end of the URL of the Web service used in the
                     <span class="bold"><strong>ENDPOINT</strong></span> field, open the corresponding web
                  page, and then see the SOAPAction defined under the operation node:</p><p>
                  </p><pre class="programlisting">&lt;wsdl:operation name="GetWeather"&gt;<span></span>
&lt;soap:operation soapAction="http://litwinconsulting.com/webservices/GetWeather"
style="document"/&gt;</pre><p>
               </p></td></tr></table></div></li><li class="step" title="Step 6"><p>In the <span class="bold"><strong>SOAP version</strong></span> field, select the version of
               the SOAP system being used. In this scenario, the version is <span class="emphasis"><em>SOAP
                  1.1</em></span>.</p></li><li class="step" title="Step 7"><p>In the <span class="bold"><strong>SOAP message</strong></span> field, enter the XML-format
               message used to retrieve the weather information from the invoked Web service. In
               this example, the weather information of Chicago is needed, so the message is:</p><p>
               </p><pre class="programlisting">"&lt;soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\"
xmlns:web=\"http://litwinconsulting.com/webservices/\"&gt;<span></span>
 &lt;soapenv:Header/&gt;<span></span>
  &lt;soapenv:Body&gt;<span></span>
     &lt;web:GetWeather&gt;<span></span>
         &lt;web:City&gt;Chicago&lt;/web:City&gt;<span></span>
      &lt;/web:GetWeather&gt;<span></span>
   &lt;/soapenv:Body&gt;<span></span>
 &lt;/soapenv:Envelope&gt;"</pre><p>
            </p></li><li class="step" title="Step 8"><p>Save your Job and press <span class="bold"><strong>F6</strong></span> to execute it.</p><p>The weather of Chicago is returned and displayed in the console of the <span class="bold"><strong>Run</strong></span> view.</p><div class="mediaobject"><img src="../images/Use_case_tSOAP3.png"></div></li></ol></div></div><div class="section" title="Scenario 2: Using a SOAP message from an XML file to get weather information and saving the information to an XML file"><div class="titlepage"><div><div><h3 class="title"><a name="jzhang-20120418-internet-tsoap_s2"></a>Scenario 2: Using a SOAP message from an XML file to get weather information and saving
         the information to an XML file</h3></div></div></div><p>This scenario describes a three-component Job that uses a SOAP message from an input XML
         file to invoke a Web service for weather information of Paris, and writes the response to
         an XML file.</p><p>As in the previous scenario, the Web service to be used is <a class="link" href="http://www.deeptraining.com/webservices/weather.asmx" target="_top">http://www.deeptraining.com/webservices/weather.asmx</a>.</p><div class="section" title="Dropping and linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d0e222239"></a>Dropping and linking the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop the following components from the <span class="bold"><strong>Palette</strong></span>
                  onto the design workspace: <span class="bold"><strong>tFileInputXML</strong></span>,
                     <span class="bold"><strong>tSOAP</strong></span>, and <span class="bold"><strong>tFileOutputXML</strong></span>.</p></li><li class="step" title="Step 2"><p>Connect the components using <span class="bold"><strong>Main</strong></span> &gt; <span class="bold"><strong>Row</strong></span> links.</p><div class="mediaobject"><img src="../images/use_case-tsoap2-1.png"></div></li></ol></div></div><div class="section" title="Configuring the input component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e222270"></a>Configuring the input component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="bold"><strong>tFileInputXML</strong></span> component to
                  open its <span class="bold"><strong>Basic settings</strong></span> view and define the
                  component properties.</p><div class="mediaobject"><img src="../images/use_case-tsoap2-2.png"></div></li><li class="step" title="Step 2"><p>Click the <span class="bold"><strong>[...]</strong></span> button next to <span class="bold"><strong>Edit schema</strong></span> to open the <span class="bold"><strong>[Schema]</strong></span> dialog box.</p><div class="mediaobject"><img src="../images/use_case-tsoap2-3.png"></div></li><li class="step" title="Step 3"><p>Click the <span class="bold"><strong>[+]</strong></span> button to add a column, give it
                  a name, <span class="italic">getWeather</span> in this example, and select
                     <span class="bold"><strong>Document</strong></span> from the <span class="bold"><strong>Type</strong></span> list. Then, click <span class="bold"><strong>OK</strong></span> to close
                  the dialog box.</p></li><li class="step" title="Step 4"><p>In the <span class="bold"><strong>File name/Stream </strong></span>field, enter the path
                  to the input XML file that contains the SOAP message to be used, or browse to the
                  path by clicking the <span class="bold"><strong>[...]</strong></span> button.</p><p>The input file contains the following SOAP message: </p><pre class="programlisting">&lt;soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/"
    xmlns:web="http://litwinconsulting.com/webservices/"&gt;
    &lt;soapenv:Header/&gt;
    &lt;soapenv:Body&gt;
        &lt;web:GetWeather&gt;
            &lt;web:City&gt;Paris&lt;/web:City&gt;
        &lt;/web:GetWeather&gt;
    &lt;/soapenv:Body&gt;
&lt;/soapenv:Envelope&gt;</pre></li><li class="step" title="Step 5"><p>In the <span class="bold"><strong>Loop XPath query</strong></span> field, enter
                     <code class="code">&#8220;/&#8221;</code> to define the root as the loop node of the input file
                  structure.</p></li><li class="step" title="Step 6"><p>In the <span class="bold"><strong>Mapping</strong></span> table, fill the <span class="bold"><strong>XPath query</strong></span> column with <code class="code">&#8220;.&#8221;</code> to extract all
                  data from context node of the source, and select the <span class="bold"><strong>Get
                     Nodes</strong></span> check box to build a <span class="bold"><strong>Document</strong></span>
                  type data flow. </p></li></ol></div></div><div class="section" title="Configuring the Web service via the tSOAP component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e222359"></a>Configuring the Web service via the tSOAP component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="bold"><strong>tSOAP</strong></span> component to open its
                     <span class="bold"><strong>Basic settings</strong></span> view and define the component
                  properties.</p><div class="mediaobject"><img src="../images/use_case-tsoap2-4.png"></div></li><li class="step" title="Step 2"><p>In <span class="bold"><strong>ENDPOINT</strong></span> field, enter or copy-paste the URL
                  address of the Web service to be used between the quotation marks:
                     <span class="emphasis"><em>&#8220;http://www.deeptraining.com/webservices/weather.asmx&#8221;</em></span>.</p></li><li class="step" title="Step 3"><p>In the <span class="bold"><strong>SOAP Action</strong></span> field, enter or copy-paste
                  the URL address of the SOAPAction HTTP header field that indicates that you want
                  to retrieve the weather information:
                     <span class="emphasis"><em>http://litwinconsulting.com/webservices/GetWeather</em></span>.</p></li><li class="step" title="Step 4"><p>Select the <span class="bold"><strong>Use a message from the input schema</strong></span>
                  check box, and select a <span class="bold"><strong>Document</strong></span> type column from
                  the <span class="bold"><strong>SOAP Message</strong></span> list to read the SOAP message
                  from the input file to send to the Web service. In this example, the input schema
                  has only one column, <span class="italic">getWeather</span>.</p></li></ol></div></div><div class="section" title="Configuring the output component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e222408"></a>Configuring the output component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click the <span class="bold"><strong>tFileOutputXML</strong></span> component to
                  open its <span class="bold"><strong>Basic settings</strong></span> view. </p><div class="mediaobject"><img src="../images/use_case-tsoap2-5.png"></div></li><li class="step" title="Step 2"><p>In the <span class="bold"><strong>File Name</strong></span> field, enter the path to the
                  output XML file.</p></li><li class="step" title="Step 3"><p>Select the <span class="bold"><strong>Incoming record is a document</strong></span> check
                  box to retrieve the incoming data flow as an XML document. Note that a <span class="bold"><strong>Column list</strong></span> appears allowing you choose a column to
                  retrieve data from. In this example, the schema contains only one column. </p></li></ol></div></div><div class="section" title="Executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e222439"></a>Executing the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Press <span class="bold"><strong>Ctrl+S</strong></span> to save your Job.</p></li><li class="step" title="Step 2"><p>Press <span class="bold"><strong>F6</strong></span>, or click <span class="bold"><strong>Run</strong></span> on the <span class="bold"><strong>Run</strong></span> tab to execute the
                  Job.</p><p>The weather of Paris is returned and the information is saved in the defined
                  XML file.</p><div class="mediaobject"><img src="../images/use_case-tsoap2-6.png"></div></li></ol></div></div></div></div></body></html>