<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tMongoDBOutput</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tenterprise-components-rg-en..html" title="Talend Enterprise"><link rel="up" href="ch-bigdata.html" title="Chapter&nbsp;1.&nbsp;Big Data components"><link rel="prev" href="tMongoDBInput.html" title="tMongoDBInput"><link rel="next" href="tMongoDBRow.html" title="tMongoDBRow"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">tMongoDBOutput</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tMongoDBInput.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;1.&nbsp;Big Data components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="tMongoDBRow.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="tMongoDBOutput"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tMongoDBOutput"></a>tMongoDBOutput</h2></div></div></div><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="27"><tr><td><img src="../images/tMongoDBOutput_icon32_white.png" width="27"></td></tr></table></div><div class="warning" title="Warning" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Warning</h3><p>
			<span class="emphasis"><em>This component will be available in the <span class="emphasis"><strong>Palette</strong></span> of the studio on the condition that you have subscribed to
				the relevant edition of <span class="emphasis"><em>Talend Enterprise Data Integration Big Data
				edition</em></span>.</em></span>
		</p></div><div class="section" title="tMongoDBOutput Properties"><div class="titlepage"><div><div><h3 class="title"><a name="d52553e18495"></a>tMongoDBOutput Properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Component family</strong></span>
							</p>
						</td><td valign="top">
							<p>Big Data / MongoDB</p>
						</td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Function</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>tMongoDBOutput</strong></span> executes the
								action defined on the collection in the Mongo database based on the
								flow incoming from the preceding component in the Job.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Purpose</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p>This component executes the action defined on the collection in
								the Mongo database.</p>
						</td></tr><tr><td>
							<p>
								<span class="emphasis"><strong>Basic settings</strong></span>
							</p>
						</td><td>
							<p>
								<span class="emphasis"><em>Use existing connection</em></span>
							</p>
						</td><td valign="top">
							<p>Select this check box and in the <span class="emphasis"><strong>Component
									List</strong></span> click the relevant connection component to reuse
								the connection details you already defined.</p>
							<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>When a Job contains the parent Job and the child Job,
										<span class="emphasis"><strong>Component
										List</strong></span> presents only the connection components in
									the same Job level, so if you need to use an existing connection
									from the other level, you can use <span class="emphasis"><strong>Dynamic
										settings</strong></span> to share the intended connection. In
									this case, ensure that the connection name is unique and
									distinctive all over through the two Job levels. For more
									information about <span class="emphasis"><strong>Dynamic
										settings</strong></span>, see <span class="emphasis"><em>Talend Enterprise Studio User
										Guide</em></span>.</p></div>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Use replica set address</em></span></p>
						</td><td valign="top">
							<p>Select this check box to show the <span class="emphasis"><strong>Replica
									address</strong></span> table.</p>
							<p>In the <span class="emphasis"><strong>Replica address</strong></span> table, you
								can define multiple Mongo database servers for failover.</p>
							<p>Available when the <span class="emphasis"><strong>Use existing
									connection</strong></span> check box is not selected.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Server</em></span> and <span class="emphasis"><em>Port</em></span></p>
						</td><td valign="top">
							<p>IP address and listening port of the database server.</p>
							<p>Available when the <span class="emphasis"><strong>Use existing
									connection</strong></span> or <span class="emphasis"><strong>Use replica set
									address</strong></span> check box is not selected.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Database</em></span></p>
						</td><td valign="top">
							<p>Name of the database.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Required authentication</em></span></p>
						</td><td valign="top">
							<p>Select this check box to enable the database
								authentication.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Username</em></span> and <span class="emphasis"><em>Password</em></span></p>
						</td><td valign="top">
							<p>DB user authentication data.</p>
							<p>Available when the <span class="emphasis"><strong>Required
									authentication</strong></span> check box is selected.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Collection</em></span></p>
						</td><td valign="top">
							<p>Name of the collection in the Mongo database.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p><span class="emphasis"><em>Drop collection if exist</em></span></p>
						</td><td valign="top">
							<p>Select this check box to drop the collection if it already
								exists.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Action on data</em></span>
							</p>
						</td><td valign="top">
							<p>The following operations are available: </p>
							<p>
								<span class="emphasis"><strong>Insert</strong></span>: insert data.</p>
							<p>
								<span class="emphasis"><strong>Update</strong></span>: update data.</p>
							<p>
								<span class="emphasis"><strong>Upsert</strong></span>: update and insert
								data.</p>
							<p>
								<span class="emphasis"><strong>Delete</strong></span>: delete data.</p>
						</td></tr><tr><td valign="top">&nbsp;</td><td valign="top">
							<p><span class="emphasis"><em>Schema</em></span> and <span class="emphasis"><em>Edit
								Schema</em></span></p>
						</td><td valign="top">
							<p>A schema is a row description, i.e. it defines the number of
								fields that will be processed and passed on to the next component. </p>
							
							<p> Click <span class="emphasis"><strong>Edit Schema</strong></span> to make
								changes to the schema. <span>Note that if
									you make changes, the schema automatically becomes
									built-in.</span></p>
							<p> Click <span class="emphasis"><strong>Sync columns</strong></span> to retrieve
								the schema from the previous component connected in the Job.</p>
						</td></tr><tr><td>
							<p>&nbsp;</p>
						</td><td>
							<p>
								<span class="emphasis"><em>Mapping</em></span>
							</p>
						</td><td valign="top">
							<p>Specify the parent node for the column in the Mongo
								database.</p>
							<p>Not available when the <span class="emphasis"><strong>Generate JSON
									Document</strong></span> check box is selected in <span class="emphasis"><strong>Advanced settings</strong></span>.</p>
						</td></tr><tr><td>&nbsp;</td><td valign="top">
							<p>
								<span class="emphasis"><em>Die on error</em></span>
							</p>
						</td><td valign="top">
							<p>This check box is cleared by default, meaning to skip the row on
								error and to complete the process for error-free rows.</p>
						</td></tr><tr><td>
							<span class="emphasis"><strong>Advanced settings</strong></span>
						</td><td valign="top">
							<p>
								<span class="emphasis"><em>Generate JSON Document</em></span></p>
						</td><td valign="top">
							<p>Select this check box for JSON configuration:</p>
							<p><span class="emphasis"><strong>Configure JSON Tree</strong></span>: click the
									<span class="emphasis"><strong>[...]</strong></span> button to open the
								interface for JSON tree configuration. </p>
							<p><span class="emphasis"><strong>Group by</strong></span>: click the <span class="emphasis"><strong>[+]</strong></span> button to add lines and choose the
								input columns for grouping the records.</p>
							<p><span class="emphasis"><strong>Remove root node</strong></span>: select this
								check box to remove the root node. </p>
							<p><span class="emphasis"><strong>Data node</strong></span> and <span class="emphasis"><strong>Query node</strong></span> (available for update and
								upsert actions): type in the name of data node and query node
								configured on the JSON tree. They are not stored in the database and
								are intended solely to start the update and upsert actions.</p>
						</td></tr><tr><td> </td><td valign="top">
							<p>
								<span class="emphasis"><em>tStatCatcher Statistics</em></span></p>
						</td><td valign="top">
							<p>Select this check box to collect the log data at the component
								level.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Usage</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<p><span class="emphasis"><strong>tMongoDBOutput</strong></span> executes the
								action defined on the collection in the Mongo database based on the
								flow incoming from the preceding component in the Job.</p>
						</td></tr><tr><td valign="top">
							<p>
								<span class="emphasis"><strong>Limitation</strong></span>
							</p>
						</td><td colspan="2" valign="top">
							<div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>The "multi" parameter, which allows to update multiple
											documents at a time, is not supported. Therefore, if two
											documents have the same key, the first is always
											updated, but the second never will.</p></li><li class="listitem"><p>For the update operation, the key cannot be a JSON
											array.</p></li></ul></div></div>
						</td></tr></tbody></table></div></div><div class="section" title="Scenario 1: Creating a collection and writing data to it"><div class="titlepage"><div><div><h3 class="title"><a name="andy-20120913-bigdata-tmongodboutput-Creating_collection_and_writing_data_to_it"></a>Scenario 1: Creating a collection and writing data to it</h3></div></div></div><p>This scenario creates the collection <span class="emphasis"><em>blog</em></span> and
			writes post data to it.</p><div class="section" title="Linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d52553e18967"></a>Linking the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop <span class="emphasis"><strong>tMongoDBConnection</strong></span>, <span class="emphasis"><strong>tFixedFlowInput</strong></span>, <span class="emphasis"><strong>tMongoDBOutput</strong></span>, <span class="emphasis"><strong>tMongoDBClose</strong></span>, <span class="emphasis"><strong>tMongoDBInput</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span>
						onto the workspace.</p></li><li class="step" title="Step 2"><p>Rename <span class="emphasis"><strong>tFixedFlowInput</strong></span> as <span class="emphasis"><strong>blog_post_data</strong></span>, <span class="emphasis"><strong>tMongoDBOutput</strong></span> as <span class="emphasis"><strong>write_data_to_collection</strong></span>, <span class="emphasis"><strong>tMongoDBInput</strong></span> as <span class="emphasis"><strong>read_data_from_collection</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span> as <span class="emphasis"><strong>show_data_from_collection</strong></span>.</p></li><li class="step" title="Step 3"><p>Link <span class="emphasis"><strong>tMongoDBConnection</strong></span> to <span class="emphasis"><strong>tFixedFlowInput</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step" title="Step 4"><p>Link <span class="emphasis"><strong>tFixedFlowInput</strong></span> to <span class="emphasis"><strong>tMongoDBOutput</strong></span> using a <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span>
						connection.</p></li><li class="step" title="Step 5"><p>Link <span class="emphasis"><strong>tFixedFlowInput</strong></span> to <span class="emphasis"><strong>tMongoDBInput</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step" title="Step 6"><p>Link <span class="emphasis"><strong>tMongoDBInput</strong></span> to <span class="emphasis"><strong>tMongoDBClose</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step" title="Step 7"><p>Link <span class="emphasis"><strong>tMongoDBInput</strong></span> to <span class="emphasis"><strong>tLogRow</strong></span> using a <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span>
						connection.</p><div class="mediaobject" align="center"><img src="../images/use_case_tmongodboutput_1.png" align="middle"></div></li></ol></div></div><div class="section" title="Configuring the components"><div class="titlepage"><div><div><h4 class="title"><a name="d52553e19088"></a>Configuring the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tMongoDBConnection</strong></span> to open
						its <span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_2.png"></div></li><li class="step" title="Step 2"><p>In the <span class="emphasis"><strong>Server</strong></span> and <span class="emphasis"><strong>Port</strong></span> fields, enter the connection details.</p><p>In the <span class="emphasis"><strong>Database</strong></span> field, enter the name of
						the Mongo database. </p></li><li class="step" title="Step 3"><p>Double-click <span class="emphasis"><strong>tFixedFlowInput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_3.png"></div><p>Select <span class="emphasis"><strong>Use Inline Content (delimited
							file)</strong></span> in the <span class="emphasis"><strong>Mode</strong></span>
						area.</p><p>In the <span class="emphasis"><strong>Content</strong></span> field, enter the data to
						write to the Mongo database, for example:</p><pre class="programlisting">1;Andy;Open Source Outlook;Open Source,Talend;Talend, the leader of the open source world...
3;Andy;ELT Overview;ELT,Talend;Talend, the big name in the ELT circle...
2;Andy;Data Integration Overview;Data Integration,Talend;Talend, the leading player in the DI field...</pre></li><li class="step" title="Step 4"><p>Double-click <span class="emphasis"><strong>tMongoDBOutput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_4.png"></div><p>Select the <span class="emphasis"><strong>Use existing connection</strong></span> and
							<span class="emphasis"><strong>Drop collection if exist</strong></span> check
						boxes.</p><p>In the <span class="emphasis"><strong>Collection</strong></span> field, enter the name
						of the collection, namely <span class="emphasis"><em>blog</em></span>.</p></li><li class="step" title="Step 5"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_5.png"></div></li><li class="step" title="Step 6"><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add five columns
						in the right part, namely <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and
							<span class="emphasis"><em>contents</em></span>, with the type as <span class="emphasis"><em>Integer</em></span> and <span class="emphasis"><em>String</em></span> respectively.</p><p>Click <span class="inlinemediaobject"><img src="../images/button_copy_all_from_out_to_in.png"></span> to copy all the columns to the input table.</p><p>Click <span class="emphasis"><strong>Ok</strong></span> to close the editor.</p></li><li class="step" title="Step 7"><p>The columns now appear in the left part of the <span class="emphasis"><strong>Mapping</strong></span> area.</p><p>For columns <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and <span class="emphasis"><em>contents</em></span>,
						enter their parent node <span class="emphasis"><em>post</em></span>. By doing
						so, those nodes reside under the node <span class="emphasis"><em>post</em></span> in the Mongo collection.</p></li><li class="step" title="Step 8"><p>Double-click <span class="emphasis"><strong>tMongoDBInput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_6.png"></div><p>Select the <span class="emphasis"><strong>Use existing connection</strong></span> check
						box.</p><p>In the <span class="emphasis"><strong>Collection</strong></span> field, enter the name
						of the collection, namely <span class="emphasis"><em>blog</em></span>.</p></li><li class="step" title="Step 9"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_7.png"></div></li><li class="step" title="Step 10"><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add five columns,
						namely <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and <span class="emphasis"><em>contents</em></span>, with the type as <span class="emphasis"><em>Integer</em></span> and <span class="emphasis"><em>String</em></span>
						respectively.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to close the editor.</p></li><li class="step" title="Step 11"><p>The columns now appear in the left part of the <span class="emphasis"><strong>Mapping</strong></span> area.</p><p>For columns <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and <span class="emphasis"><em>contents</em></span>,
						enter their parent node <span class="emphasis"><em>post</em></span> so that the
						data can be retrieved from the correct positions.</p></li><li class="step" title="Step 12"><p>In the <span class="emphasis"><strong>Sort by</strong></span> area, click the <span class="emphasis"><strong>[+]</strong></span> button to add one line and enter <span class="emphasis"><em>id</em></span> under <span class="emphasis"><strong>Column</strong></span>.</p><p>Select <span class="emphasis"><strong>asc</strong></span> from the <span class="emphasis"><strong>Order asc or desc?</strong></span> column to the right of the <span class="emphasis"><em>id</em></span> column. This way, the retrieved records will
						appear in ascending order of the <span class="emphasis"><em>id</em></span>
						column.</p></li></ol></div></div><div class="section" title="Executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d52553e19370"></a>Executing the Job </h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save the Job.</p></li><li class="step" title="Step 2"><p>Press <span class="emphasis"><strong>F6</strong></span> to run the Job.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/use_case_tmongodboutput_8.png" height="360"></td></tr></table></div></li><li class="step" title="Step 3"><p>Switch to the database <span class="emphasis"><em>talend</em></span> and read
						data from the collection <span class="emphasis"><em>blog</em></span> in the
						Mongo command line client. You can find that <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and <span class="emphasis"><em>contents</em></span> all reside under the node <span class="emphasis"><em>post</em></span>. Meanwhile, the records are stored in the same order as
						the source input.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/use_case_tmongodboutput_9.png" height="360"></td></tr></table></div></li></ol></div></div></div><div class="section" title="Scenario 2: Upserting records in a collection"><div class="titlepage"><div><div><h3 class="title"><a name="andy-20120928-bigdata-tmongodboutput-upserting_records_in_collection"></a>Scenario 2: Upserting records in a collection</h3></div></div></div><p>This scenario upserts the collection <span class="emphasis"><em>blog</em></span> as an
			existing record has its author changed and a new record is added. Before the upsert, the
			collection <span class="emphasis"><em>blog</em></span> looks like:</p><pre class="programlisting">1;Andy;Open Source Outlook;Open Source,Talend;Talend, the leader of the open source world...
2;Andy;Data Integration Overview;Data Integration,Talend;Talend, the leading player in the DI field...
3;Andy;ELT Overview;ELT,Talend;Talend, the big name in the ELT circle...</pre><div class="section" title="Linking the components"><div class="titlepage"><div><div><h4 class="title"><a name="d52553e19429"></a>Linking the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop <span class="emphasis"><strong>tMongoDBConnection</strong></span>, <span class="emphasis"><strong>tFixedFlowInput</strong></span>, <span class="emphasis"><strong>tMongoDBOutput</strong></span>, <span class="emphasis"><strong>tMongoDBClose</strong></span>, <span class="emphasis"><strong>tMongoDBInput</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span>
						from the <span class="emphasis"><strong>Palette</strong></span> onto the design
						workspace.</p></li><li class="step" title="Step 2"><p>Rename <span class="emphasis"><strong>tFixedFlowInput</strong></span> as <span class="emphasis"><strong>blog_post_data</strong></span>, <span class="emphasis"><strong>tMongoDBOutput</strong></span> as <span class="emphasis"><strong>write_data_to_collection</strong></span>, <span class="emphasis"><strong>tMongoDBInput</strong></span> as <span class="emphasis"><strong>read_data_from_collection</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span> as <span class="emphasis"><strong>show_data_from_collection</strong></span>.</p></li><li class="step" title="Step 3"><p>Link <span class="emphasis"><strong>tMongoDBConnection</strong></span> to <span class="emphasis"><strong>tFixedFlowInput</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step" title="Step 4"><p>Link <span class="emphasis"><strong>tFixedFlowInput</strong></span> to <span class="emphasis"><strong>tMongoDBOutput</strong></span> using a <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span>
						connection.</p></li><li class="step" title="Step 5"><p>Link <span class="emphasis"><strong>tFixedFlowInput</strong></span> to <span class="emphasis"><strong>tMongoDBInput</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step" title="Step 6"><p>Link <span class="emphasis"><strong>tMongoDBInput</strong></span> to <span class="emphasis"><strong>tMongoDBClose</strong></span> using the <span class="emphasis"><strong>OnSubjobOk</strong></span> trigger.</p></li><li class="step" title="Step 7"><p>Link <span class="emphasis"><strong>tMongoDBInput</strong></span> to <span class="emphasis"><strong>tLogRow</strong></span> using a <span class="emphasis"><strong>Row</strong></span> &gt; <span class="emphasis"><strong>Main</strong></span>
						connection.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_10.png"></div></li></ol></div></div><div class="section" title="Configuring the components"><div class="titlepage"><div><div><h4 class="title"><a name="d52553e19553"></a>Configuring the components</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="emphasis"><strong>tMongoDBConnection</strong></span> to open
						its <span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_11.png"></div></li><li class="step" title="Step 2"><p>In the <span class="emphasis"><strong>Server</strong></span> and <span class="emphasis"><strong>Port</strong></span> fields, enter the connection details.</p><p>In the <span class="emphasis"><strong>Database</strong></span> field, enter the name of
						the Mongo database. </p></li><li class="step" title="Step 3"><p>Double-click <span class="emphasis"><strong>tFixedFlowInput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_12.png"></div><p>Select <span class="emphasis"><strong>Use Inline Content (delimited
							file)</strong></span> in the <span class="emphasis"><strong>Mode</strong></span>
						area.</p><p>In the <span class="emphasis"><strong>Content</strong></span> field, enter the data for
						upserting the Mongo database, for example:</p><pre class="programlisting">1;Andy;Open Source Outlook;Open Source,Talend;Talend, the leader of the open source world...
2;Andy;Data Integration Overview;Data Integration,Talend;Talend, the leading player in the DI field...
3;Anderson;ELT Overview;ELT,Talend;Talend, the big name in the ELT circle...
4;Andy;Big Data Bang;Big Data,Talend;Talend, the driving force for Big Data applications... </pre><p>As shown above, the 3rd record has its author changed and the 4th record
						is new.</p></li><li class="step" title="Step 4"><p>Double-click <span class="emphasis"><strong>tMongoDBOutput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_13.png"></div><p>Select the <span class="emphasis"><strong>Use existing connection</strong></span> and
							<span class="emphasis"><strong>Die on error</strong></span> check boxes.</p><p>In the <span class="emphasis"><strong>Collection</strong></span> field, enter the name
						of the collection, namely <span class="emphasis"><em>blog</em></span>.</p><p>Select <span class="emphasis"><strong>Upsert</strong></span> from the <span class="emphasis"><strong>Action on data</strong></span> list.</p></li><li class="step" title="Step 5"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_5.png"></div></li><li class="step" title="Step 6"><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add five columns
						in the right part, namely <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and
							<span class="emphasis"><em>contents</em></span>, with the type as <span class="emphasis"><em>Integer</em></span> and <span class="emphasis"><em>String</em></span> respectively.</p><p>Click <span class="inlinemediaobject"><img src="../images/button_copy_all_from_out_to_in.png"></span> to copy all the columns to the input table.</p><p>Click <span class="emphasis"><strong>Ok</strong></span> to close the editor.</p></li><li class="step" title="Step 7"><p>In the <span class="emphasis"><strong>Advanced Settings</strong></span> view, select the
							<span class="emphasis"><strong>Generate JSON Document</strong></span> check
						box.</p><p>Select the <span class="emphasis"><strong>Remove root node</strong></span> check box. </p><p>In the <span class="emphasis"><strong>Data node</strong></span> and <span class="emphasis"><strong>Query node</strong></span> fields, enter <span class="emphasis"><em>"data"</em></span> and <span class="emphasis"><em>"query"</em></span>.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_14.png"></div></li><li class="step" title="Step 8"><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Configure JSON Tree</strong></span> to open the configuration
						interface.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/use_case_tmongodboutput_15.png" height="360"></td></tr></table></div></li><li class="step" title="Step 9"><p>Right-click the node <span class="emphasis"><em>rootTag</em></span> and select
							<span class="emphasis"><strong>Add Sub-element</strong></span> from the contextual
						menu.</p><p>In the dialog box that appears, type in <span class="emphasis"><em>data</em></span> for the <span class="emphasis"><strong>Data
						node</strong></span>:</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_16.png"></div><p>Click <span class="emphasis"><strong>OK</strong></span> to close the window.</p><p>Repeat this operation to define <span class="emphasis"><em>query</em></span>
						as the <span class="emphasis"><strong>Query node</strong></span>.</p><p>Right-click the node <span class="emphasis"><em>data</em></span> and select
							<span class="emphasis"><strong>Set As Loop Element</strong></span> from the contextual
						menu.</p></li><li class="step" title="Step 10"><p>Select all the columns under the <span class="emphasis"><strong>Schema
							list</strong></span> and drop them to the <span class="emphasis"><em>data</em></span> node. </p><p>In the window that appears, select <span class="emphasis"><strong>Create as
							sub-element of target node</strong></span>.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_17.png"></div><p>Click <span class="emphasis"><strong>OK</strong></span> to close the window.</p><p>Repeat this operation to drop the <span class="emphasis"><em>id</em></span>
						column from the <span class="emphasis"><strong>Schema list</strong></span> under the
							<span class="emphasis"><em>Query</em></span> node.</p></li><li class="step" title="Step 11"><p>Right-click the node <span class="emphasis"><em>id</em></span> under <span class="emphasis"><em>data</em></span> and select <span class="emphasis"><strong>Add
							Attribute</strong></span> from the contextual menu.</p><p>In the dialog box that appears, type in <span class="emphasis"><em>type</em></span> as the attribute name:</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_18.png"></div><p>Click <span class="emphasis"><strong>OK</strong></span> to close the window.</p><p>Right-click the node <span class="emphasis"><em>@type</em></span> under
							<span class="emphasis"><em>id</em></span> and select <span class="emphasis"><strong>Set A Fix Value</strong></span> from the contextual menu.</p><p>In the dialog box that appears, type in <span class="emphasis"><em>integer</em></span> as the attribute value, ensuring the <span class="emphasis"><em>id</em></span> values are stored as integers in the
						database.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_19.png"></div><p>Click <span class="emphasis"><strong>OK</strong></span> to close the window.</p><p>Repeat this operation to set this attribute for the <span class="emphasis"><em>id</em></span> node under <span class="emphasis"><em>Query</em></span>.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to close the JSON Tree
						configuration interface.</p></li><li class="step" title="Step 12"><p>Double-click <span class="emphasis"><strong>tMongoDBInput</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_20.png"></div><p>Select the <span class="emphasis"><strong>Use existing connection</strong></span> check
						box.</p><p>In the <span class="emphasis"><strong>Collection</strong></span> field, enter the name
						of the collection, namely <span class="emphasis"><em>blog</em></span>.</p><p>Click the <span class="emphasis"><strong>[...]</strong></span> button next to <span class="emphasis"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject"><img src="../images/use_case_tmongodboutput_21.png"></div><p>Click the <span class="emphasis"><strong>[+]</strong></span> button to add five columns,
						namely <span class="emphasis"><em>id</em></span>, <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and <span class="emphasis"><em>contents</em></span>, with the type as <span class="emphasis"><em>Integer</em></span> and <span class="emphasis"><em>String</em></span>
						respectively.</p><p>Click <span class="emphasis"><strong>OK</strong></span> to close the editor.</p><p>The columns now appear in the left part of the <span class="emphasis"><strong>Mapping</strong></span> area.</p><p>For columns <span class="emphasis"><em>author</em></span>, <span class="emphasis"><em>title</em></span>, <span class="emphasis"><em>keywords</em></span> and <span class="emphasis"><em>contents</em></span>,
						enter their parent node <span class="emphasis"><em>post</em></span> so that the
						data can be retrieved from the correct positions.</p></li><li class="step" title="Step 13"><p>Double-click <span class="emphasis"><strong>tLogRow</strong></span> to open its
							<span class="emphasis"><strong>Basic settings</strong></span> view.</p><div class="mediaobject"><img src="../images/use_case_tmongodbrow_8.png"></div><p>In the <span class="emphasis"><strong>Mode</strong></span> area, select <span class="emphasis"><strong>Table (print values in cells of a table</strong></span> for
						better display.</p></li></ol></div></div><div class="section" title="Executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d52553e19989"></a>Executing the Job </h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save the Job.</p></li><li class="step" title="Step 2"><p>Press <span class="emphasis"><strong>F6</strong></span> to run the Job.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/use_case_tmongodboutput_22.png" height="360"></td></tr></table></div><p>As shown above, the 3rd record has its author updated and the 4th record
						is inserted.</p></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tMongoDBInput.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-bigdata.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="tMongoDBRow.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">tMongoDBInput&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tenterprise-components-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;tMongoDBRow</td></tr></table></div></body></html>