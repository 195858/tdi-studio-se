<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tMicrosoftMQInput</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.75.2"><link rel="home" href="bk-tos-components-rg-en..html" title="Talend Open Studio"><link rel="up" href="ch-internet.html" title="Chapter&nbsp;14.&nbsp;Internet components"><link rel="prev" href="tJMSOutput.html" title="tJMSOutput"><link rel="next" href="tMicrosoftMQOutput.html" title="tMicrosoftMQOutput"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div class="navheader"><table width="100%" summary="Navigation header"><tr><th colspan="3" align="center">tMicrosoftMQInput</th></tr><tr><td width="20%" align="left"><a accesskey="p" href="tJMSOutput.html">Prev</a>&nbsp;</td><th width="60%" align="center">Chapter&nbsp;14.&nbsp;Internet components</th><td width="20%" align="right">&nbsp;<a accesskey="n" href="tMicrosoftMQOutput.html">Next</a></td></tr></table><hr></div><div lang="EN" class="section" title="tMicrosoftMQInput"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tMicrosoftMQInput"></a>tMicrosoftMQInput</h2></div></div></div><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="27"><tr><td><img src="../images/tMicrosoftMQInput_icon32_white.png" width="27"></td></tr></table></div><div class="section" title="tMicrosoftMQInput Properties"><div class="titlepage"><div><div><h3 class="title"><a name="d41116e221227"></a>tMicrosoftMQInput Properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col><col><col></colgroup><tbody><tr><td valign="top">
                            <p><span class="emphasis"><strong>Component family</strong></span></p>
                        </td><td valign="top">
                            <p>Internet/MOM and JMS </p>
                        </td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Function</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>This component retrieves the first message in a given Microsoft
                                message queue (only support String).</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Purpose</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>This component allows you to fetch messages one by one in the ID
                                sequence of these messages from the Microsoft message queue. Each
                                execution retrieves only one message.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Basic settings</strong></span></p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>PROPERTY</em></span></p>
                        </td><td valign="top">
                            <p><span>Either <span class="emphasis"><strong>Built-in</strong></span> or <span class="emphasis"><strong>Repository</strong></span></span>.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><strong>Built-in</strong></span>: No property data stored
                                centrally. Enter properties manually</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><strong>Repository</strong></span>: Select the repository
                                file where properties are stored. The fields that come after are
                                pre-filled in using the fetched data.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Host</em></span></p>
                        </td><td valign="top">
                            <p>Type in the Host name or IP address of the host server.</p>
                        </td></tr><tr><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>Queue</em></span></p>
                        </td><td valign="top">
                            <p>Enter the queue name you want to retrieve messages from.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Advanced settings</strong></span></p>
                        </td><td valign="top">
                            <p><span class="emphasis"><em>tStatCatcher Statistics</em></span></p>
                        </td><td valign="top">
                            <p>Select this check box to gather the Job processing metadata at a
                                Job level as well as at each component level.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Usage</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>This component is generally used as a start component of a Job or
                                Subjob. It must be linked to an output component.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Connections</strong></span></p>
                        </td><td>
                            <p>&nbsp;</p>
                        </td><td valign="top">
                            <p>Outgoing links (from one component to another):</p>
                            <p>
                                <span class="emphasis"><strong>Row</strong></span>: Main, Iterate</p>
                            <p>
                                <span class="emphasis"><strong>Trigger</strong></span>: Run if; On Subjob Ok, On
                                Component Ok; On Component Error.</p>
                            <p> </p>
                            <p> Incoming links (from one component to another):</p>
                            <p>
                                <span class="emphasis"><strong>Row</strong></span>: Iterate;</p>
                            <p>
                                <span class="emphasis"><strong>Trigger</strong></span>: Run if, On Subjob Ok, On
                                Component Ok, On Component Error.</p>
                            <p> </p>
                            <p> For further information regarding connections, see
                                        <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.</p>
                        </td></tr><tr><td valign="top">
                            <p><span class="emphasis"><strong>Limitation</strong></span></p>
                        </td><td colspan="2" valign="top">
                            <p>This component supports only String type. Also, it only works with
                                the Windows systems.</p>
                            
                        </td></tr></tbody></table></div></div><div class="section" title="Scenario: Writing and fetching queuing messages from Microsoft message queue"><div class="titlepage"><div><div><h3 class="title"><a name="Raa92810"></a>Scenario: Writing and fetching queuing messages from Microsoft message queue</h3></div></div></div><p>This scenario is made of two Jobs. The first Job posts messages on a Microsoft message
            queue and the second Job fetches the message from the server.</p><div class="section" title="Posting messages on a Microsoft message queue"><div class="titlepage"><div><div><h4 class="title"><a name="d41116e221471"></a>Posting messages on a Microsoft message queue</h4></div></div></div><p>In the first Job, a string message is created using a <span class="emphasis"><strong>tRowGenerator</strong></span> and put on a Microsoft message queue using a <span class="emphasis"><strong>tMicrosoftMQOutput</strong></span>. An intermediary <span class="emphasis"><strong>tLogRow</strong></span> component displays the flow being passed.</p><div class="procedure" title="Procedure&nbsp;14.8.&nbsp;Dropping and linking components"><a name="d41116e221485"></a><p class="title"><b>Procedure&nbsp;14.8.&nbsp;Dropping and linking components</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p> Drop the three components required for the first Job from the <span class="emphasis"><strong>Palette</strong></span> onto the design workspace.</p></li><li class="step" title="Step 2"><p> Connect the components using a <span class="emphasis"><strong>Row</strong></span> &gt;
                            <span class="emphasis"><strong>Main</strong></span> link. </p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftMQ1.png"></div></li></ol></div><div class="procedure" title="Procedure&nbsp;14.9.&nbsp;Configuring the components"><a name="d41116e221506"></a><p class="title"><b>Procedure&nbsp;14.9.&nbsp;Configuring the components</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p> Double-click <span class="emphasis"><strong>tRowGenerator</strong></span> to open its
                        editor.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/Use_Case_tMicrosoftMQ2.png" height="360"></td></tr></table></div></li><li class="step" title="Step 2"><p>Click the plus button to add three rows into the schema table.</p></li><li class="step" title="Step 3"><p> In the <span class="emphasis"><strong>Column</strong></span> column, type in a new name
                        for each row to rename it. Here, we type in <span class="emphasis"><em>ID</em></span>,
                            <span class="emphasis"><em>Name</em></span> and <span class="emphasis"><em>Address</em></span>.</p></li><li class="step" title="Step 4"><p> In the <span class="emphasis"><strong>Type</strong></span> column, select <span class="emphasis"><strong>Integer</strong></span> for the <span class="emphasis"><em>ID</em></span> row from
                        the drop-down list and leave the other rows as <span class="emphasis"><strong>String</strong></span>.</p></li><li class="step" title="Step 5"><p> In the <span class="emphasis"><strong>Functions</strong></span> column, select
                            <code class="code">random</code> for the <span class="emphasis"><em>ID</em></span> row,
                            <code class="code">getFirstName</code> for the <span class="emphasis"><em>Name</em></span> row and
                            <code class="code">getUsCity</code> for the <span class="emphasis"><em>Address</em></span> row. </p></li><li class="step" title="Step 6"><p> In the <span class="emphasis"><strong>Number of Rows for RowGenerator</strong></span>
                        field on the right end of the toolbar, type in <span class="emphasis"><em>12</em></span> to
                        limit the number of rows to be generated. Then, Click <span class="emphasis"><strong>Ok</strong></span> to validate this editing.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><h3 class="title">Note</h3><p>In real case, you may use an input component to load the data of your
                            interest, instead of the <span class="emphasis"><strong>tRowGenerator</strong></span>
                            component.</p></div></li><li class="step" title="Step 7"><p> Double click the <span class="emphasis"><strong>tMicrosoftMQOutput
                        </strong></span>component to open its <span class="emphasis"><strong>Component</strong></span>
                        view.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/Use_Case_tMicrosoftMQ3.png" height="360"></td></tr></table></div></li><li class="step" title="Step 8"><p> In the <span class="emphasis"><strong>Host</strong></span> field, type in the host
                        address. In this example, it is <span class="emphasis"><em>localhost</em></span>.</p></li><li class="step" title="Step 9"><p> In the<span class="emphasis"><strong> Queue</strong></span> field, type in the queue
                        name you want to write message in. In this example, name it
                            <span class="emphasis"><em>AddressQueue</em></span>.</p></li><li class="step" title="Step 10"><p> In <span class="emphasis"><strong>Message column (String Type</strong></span><span class="emphasis"><strong>)</strong></span> field, select <span class="emphasis"><em>Address</em></span> from
                        the drop-down list to determine the message body to be written.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;14.10.&nbsp;Saving and executing the Job"><a name="d41116e221634"></a><p class="title"><b>Procedure&nbsp;14.10.&nbsp;Saving and executing the Job</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save your Job.</p></li><li class="step" title="Step 2"><p>Press <span class="emphasis"><strong>F6</strong></span> or click <span class="emphasis"><strong>Run</strong></span> on the <span class="emphasis"><strong>Run</strong></span> tab to
                        execute the Job.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/Use_Case_tMicrosoftMQ4.png" height="360"></td></tr></table></div><p>You can see that this queue has been created automatically and that the
                        messages have been written.</p></li></ol></div></div><div class="section" title="Fetching the first queuing message from the message queue"><div class="titlepage"><div><div><h4 class="title"><a name="d41116e221660"></a>Fetching the first queuing message from the message queue</h4></div></div></div><p>Now set the second Job in order to fetch the first queuing message from the
                message queue.</p><div class="procedure" title="Procedure&nbsp;14.11.&nbsp;Dropping and linking components"><a name="d41116e221665"></a><p class="title"><b>Procedure&nbsp;14.11.&nbsp;Dropping and linking components</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p> Drop <span class="emphasis"><strong>tMicrosoftMQInput</strong></span> and <span class="emphasis"><strong>tLogRow</strong></span> from the <span class="emphasis"><strong>Palette</strong></span> to the design workspace.</p></li><li class="step" title="Step 2"><p> Connect these two components using a <span class="emphasis"><strong>Row</strong></span>
                        &gt; <span class="emphasis"><strong>Main</strong></span> link.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftMQ5.png"></div></li></ol></div><div class="procedure" title="Procedure&nbsp;14.12.&nbsp;Configuring the components"><a name="d41116e221692"></a><p class="title"><b>Procedure&nbsp;14.12.&nbsp;Configuring the components</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p> Double-click the <span class="emphasis"><strong>tMicrosoftMQInput</strong></span> to
                        open its <span class="emphasis"><strong>Component</strong></span> view.</p><div class="mediaobject"><table border="0" summary="manufactured viewport for HTML img" cellspacing="0" cellpadding="0" width="100%"><tr><td><img src="../images/Use_Case_tMicrosoftMQ6.png" height="360"></td></tr></table></div></li><li class="step" title="Step 2"><p> In the <span class="emphasis"><strong>Host</strong></span> field, type in the host name
                        or address. Here, we type in <span class="emphasis"><em>localhost</em></span>.</p></li><li class="step" title="Step 3"><p> In the <span class="emphasis"><strong>Queue</strong></span> field, type in the queue
                        name from which you want to fetch the message. In this example, it is
                            <span class="emphasis"><em>AddressQueue</em></span>.</p></li></ol></div><div class="procedure" title="Procedure&nbsp;14.13.&nbsp;Saving and executing the Job"><a name="d41116e221725"></a><p class="title"><b>Procedure&nbsp;14.13.&nbsp;Saving and executing the Job</b></p><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Press <span class="emphasis"><strong>Ctrl+S</strong></span> to save your Job.</p></li><li class="step" title="Step 2"><p>Press <span class="emphasis"><strong>F6</strong></span> or click <span class="emphasis"><strong>Run</strong></span> on the <span class="emphasis"><strong>Run</strong></span> tab to
                        execute the Job.</p><div class="mediaobject"><img src="../images/Use_Case_tMicrosoftMQ7.png"></div><p>The message body <span class="emphasis"><em>Atlanta</em></span> fetched from the queue is
                        displayed on the console.</p></li></ol></div></div></div></div><div class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="tJMSOutput.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="u" href="ch-internet.html">Up</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="tMicrosoftMQOutput.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">tJMSOutput&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="bk-tos-components-rg-en..html">Home</a></td><td width="40%" align="right" valign="top">&nbsp;tMicrosoftMQOutput</td></tr></table></div></body></html>