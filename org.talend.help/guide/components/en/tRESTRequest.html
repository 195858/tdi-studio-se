<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>tRESTRequest</title><meta name="generator" content="DocBook XSL-NS Stylesheets V1.76.1"><link rel="home" href="index.html" title="Talend Open Studio"><link rel="up" href="Raa48933.html" title="Chapter&nbsp;10.&nbsp;ESB components"><link rel="prev" href="tESBProviderResponse.html" title="tESBProviderResponse"><link rel="next" href="tRESTResponse.html" title="tRESTResponse"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div lang="EN" class="section" title="tRESTRequest"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="tRESTRequest"></a>tRESTRequest</h2></div></div></div><div class="mediaobject"><img src="../images/tRESTRequest_icon32_white.png"></div><div class="section" title="tRESTRequest properties"><div class="titlepage"><div><div><h3 class="title"><a name="d0e183973"></a>tRESTRequest properties</h3></div></div></div><div class="informaltable"><table border="1"><colgroup><col class="c1"><col class="c2"><col class="c3"></colgroup><tbody><tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Component family</strong></span>
                                                  </p>
                                                </td><td valign="top">
                                                  <p>ESB/REST</p>
                                                </td><td valign="top">&nbsp;</td></tr><tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Function</strong></span>
                                                  </p>
                                                </td><td colspan="2" valign="top">
                                                  <p><span class="bold"><strong>tRESTRequest</strong></span> is a server-side component which
                                accepts the HTTP and/or HTTPS requests from the clients and support
                                GET, POST, PUT and DELETE HTTP methods.</p>
                            <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>To enable the HTTPS support, you have to generate a keystore
                                    and add some HTTPS security configuration properties in the
                                        <span class="italic">org.ops4j.pax.web.cfg</span>
                                    file of your Runtime container before deploying the service on
                                    it. For more information, see the <span class="italic">Talend
                                        ESB Container Administration Guide</span>.</p></td></tr></table></div>
                                                </td></tr><tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Purpose</strong></span>
                                                  </p>
                                                </td><td colspan="2" valign="top">
                                                  <p>This component allows you to receive
                                GET/POST/PUT/DELETE requests from the clients on the server
                                end.</p>
                                                </td></tr><tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Basic settings</strong></span>
                                                  </p>
                                                </td><td valign="top">
                                                  <p>
                                                  <span class="emphasis"><em>REST Endpoint</em></span>
                                                  </p>
                                                </td><td valign="top">
                            <p>Fill this field with the URI location where REST-ful web service
                                will be accessible for requests.</p>
                            <div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If you want your service to be available on both HTTP and
                                    HTTPS, fill the field with a relative path.</p></td></tr></table></div>
                        </td></tr><tr><td>
                                                  <p>&nbsp;</p>
                                                </td><td valign="top">
                                                  <p>
                                                  <span class="emphasis"><em>REST API Mapping</em></span>
                                                  </p>
                                                </td><td valign="top">
                                                  <p>Click the <span class="bold"><strong>[+]</strong></span> button beneath the mapping table to add lines to
                                specify HTTP request:</p>
                                                  <p><span class="bold"><strong>Output
                                Flow</strong></span>: Click the <span class="bold"><strong>[...]</strong></span>
                                button to specify the name of an output flow and set the schema for
                                that output flow in the dialog box afterwards.</p>
                            <p>The schema is not mandatory, so if you do not need to pass
                                additional parameters to the <span class="bold"><strong>tRESTRequest</strong></span> component, you can leave the schema empty.
                                However, you will have to populate the schema if you have URI Path
                                parameters set in the <span class="bold"><strong>URI Pattern</strong></span>
                                field or if you need to add optional request parameters such as URI
                                Query, HTTP Header or Form parameters, to the URI specified in the
                                <span class="bold"><strong>REST Endpoint</strong></span> field. If you specify
                                URI parameters in the output flow schema, you might need to define
                                what type of parameter it is in the <span class="bold"><strong>Comment</strong></span> field of the schema. By default, if you leave
                                the <span class="bold"><strong>Comment</strong></span> field empty, the
                                parameter is considered as a Path parameter. Below is a list of
                                supported <span class="bold"><strong>Comment</strong></span> values:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p>empty or <span class="italic">path</span>
                                        corresponds to the default @PathParam, </p></li><li class="listitem"><p><span class="italic">query</span> corresponds to
                                        @QueryParam, </p></li><li class="listitem"><p><span class="italic">form</span> corresponds to
                                        @FormParam, </p></li><li class="listitem"><p><span class="italic">header</span> corresponds to
                                        @HeaderParam.</p></li></ul></div><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>We recommend you to set the default values of your optional
                                        parameters (Header, Query, Form). To do so, fill in the
                                            <span class="bold"><strong>Default</strong></span> columns of the
                                        schema.</p></td></tr></table></div>
                            <p><span class="bold"><strong>HTTP Verb</strong></span>: Select a HTTP method
                                (GET/POST/PUT/DELETE) from the list.</p>
                                                  <p><span class="bold"><strong>URI
                                                  pattern</strong></span>: Fill this field with REST-ful
                                                  URIs that describe the resource.</p>
                                                </td></tr><tr><td>
                                                  <p>&nbsp;</p>
                                                </td><td valign="top">
                                                  <p>
                                <span class="emphasis"><em>Use HTTP Basic Authentication</em></span>
                            </p>
                                                </td><td valign="top">
                                                  <p>Select this check box to enable the HTTP
                                Basic authentication method for the current service.</p>
                                                </td></tr>
												<tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Advanced settings</strong></span>
                                                  </p>
                                                </td><td valign="top">
                                                  <p>
                                                  <span class="emphasis"><em>tStatCatcher Statistics</em></span>
                                                  </p>
                                                </td><td valign="top">
                                                  <p>Select this check box to gather the Job
                                                  processing metadata at a Job level as well as at
                                                  each component level.</p>
                                                </td></tr><tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Usage</strong></span>
                                                  </p>
                                                </td><td colspan="2" valign="top">
                                                  <p>This component covers the possibility that a
                                    <span class="italic">Talend</span> Job can be
                                wrapped as a service, with the ability to input a request to a
                                service into a Job and return the Job result as a service
                                response.</p>
                                                  <p> The <span class="bold"><strong>tRESTRequest</strong></span> component should be used
                                                  with the <span class="bold"><strong>tRESTResponse</strong></span> component to provide a
                                                  Job result as a response, in case of a
                                                  request-response communication style. </p>
                                                </td></tr><tr><td valign="top">
                                                  <p>
                                                  <span class="bold"><strong>Limitation</strong></span>
                                                  </p>
                                                </td><td colspan="2" valign="top">
                                                  <p>n/a</p>
                                                </td></tr></tbody></table></div></div><div class="section" title="Scenario&nbsp;1: REST service accepting a HTTP request and sending a response"><div class="titlepage"><div><div><h3 class="title"><a name="fhan-20111104-esb-trestrequest-scenario"></a>Scenario&nbsp;1: REST service accepting a HTTP request and sending a
            response</h3></div></div></div><p>This scenario describes the process of accepting an HTTP request from the
            client, processing it and sending the response back.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1.png" align="middle"></div><div class="section" title="Configuring the tRESTRequest component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184263"></a>Configuring the tRESTRequest component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop the following components from the <span class="bold"><strong>Palette</strong></span> onto the design workspace: <span class="bold"><strong>tRESTRequest</strong></span>, <span class="bold"><strong>tXMLMap</strong></span> and
                            <span class="bold"><strong>tRESTResponse</strong></span>.</p></li><li class="step" title="Step 2"><p>Double-click <span class="bold"><strong>tRESTRequest</strong></span> in the design
                        workspace to display its <span class="bold"><strong>Basic settings</strong></span>
                        view.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest2.png" align="middle"></div></li><li class="step" title="Step 3"><p>Fill the <span class="bold"><strong>REST Endpoint</strong></span> field with the URI
                        location where the REST-ful web service will be accessible for requests. For
                        example, <span class="emphasis"><em>"http://192.168.0.235:8088/user"</em></span>.</p><div class="note" title="Note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="16pt"><img alt="[Note]" src="../images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>If you want your service to be available on both HTTP and HTTPS, fill
                            the field with a relative path. For example, if you type in <span class="italic">"/test"</span>, your service will be available on
                            both <span class="italic">http://&lt;DefaultHTTPEnpointAddress&gt;/test</span> and <span class="italic">https://&lt;DefaultHTTPSEnpointAddress&gt;/test</span>, provided
                            that you have configured your Runtime container to support HTTPS. For
                            more information, see the <span class="italic">Talend ESB Container
                                Administration Guide</span>.</p></td></tr></table></div></li><li class="step" title="Step 4"><p>Click the <span class="bold"><strong>[+]</strong></span> button to add one line in
                        the <span class="bold"><strong>REST API Mapping</strong></span> table.</p></li><li class="step" title="Step 5"><p>Select the newly-added line and click the <span class="bold"><strong>[...]</strong></span> button in the <span class="bold"><strong>Output
                            Flow</strong></span> column to add a schema for the output flow.</p><p>In this scenario, the output flow will be named as
                            <span class="emphasis"><em>GetOneUser</em></span>. </p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest3.png" align="middle"></div><p>Then click the <span class="bold"><strong>[+]</strong></span> button to add a new
                        line <span class="emphasis"><em>id</em></span> to the schema in the dialog box.</p></li><li class="step" title="Step 6"><p>Click <span class="bold"><strong>OK</strong></span> to save the schema.</p></li><li class="step" title="Step 7"><p>Select <span class="bold"><strong>GET</strong></span> from the list in the <span class="bold"><strong>HTTP Verb</strong></span> column.</p></li><li class="step" title="Step 8"><p>Fill the field in the <span class="bold"><strong>URI Pattern</strong></span> column
                        with <code class="code">"/{id}/"</code>.</p></li></ol></div></div><div class="section" title="Configuring the tXMLMap component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184382"></a>Configuring the tXMLMap component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Connect <span class="bold"><strong>tRESTRequest</strong></span> to <span class="bold"><strong>tXMLMap</strong></span> using the <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>GetOneUser</strong></span>
                        connection.</p></li><li class="step" title="Step 2"><p>Double-click <span class="bold"><strong>tXMLMap</strong></span> in the design
                        workspace to open the <span class="bold"><strong>Map Editor</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest4.png" align="middle"></div></li><li class="step" title="Step 3"><p>Click the <span class="bold"><strong>[+]</strong></span> button on the top right to
                        add an output and name it as <span class="emphasis"><em>ResponseUsers</em></span>.</p></li><li class="step" title="Step 4"><p>Click the <span class="bold"><strong>[+]</strong></span> button on the bottom right
                        to add two columns for the output.</p><p>Name the first column as <span class="emphasis"><em>body</em></span> and set the <span class="bold"><strong>Type</strong></span> to <span class="bold"><strong>Document</strong></span>.</p><p>Name the second column as <span class="emphasis"><em>string</em></span> and set the
                            <span class="bold"><strong>Type</strong></span> to <span class="bold"><strong>String</strong></span>.</p></li><li class="step" title="Step 5"><p>Right-click on the node <span class="bold"><strong>root</strong></span> and select
                            <span class="bold"><strong>Create Sub-Element</strong></span> to create a
                        sub-element.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest5.png" align="middle"></div><p>Name the sub-element as <span class="emphasis"><em>foo</em></span> in the popup dialog
                        box.</p></li><li class="step" title="Step 6"><p>Right-click on the <span class="emphasis"><em>foo</em></span> node created in the previous
                        step and select <span class="bold"><strong>As loop element</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest6.png" align="middle"></div></li><li class="step" title="Step 7"><p>Select the <span class="italic">id</span> column of the <span class="italic">GetOneUser</span> table to the left and drop it onto
                        the <span class="bold"><strong>Expression</strong></span> field of the <span class="italic">foo</span> node of the <span class="italic">ResponseUsers</span> table to the right.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest9.png" align="middle"></div></li><li class="step" title="Step 8"><p>Click <span class="bold"><strong>OK</strong></span> to save the settings.</p></li></ol></div></div><div class="section" title="Configuring the tRESTResponse component"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184506"></a>Configuring the tRESTResponse component</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Connect <span class="bold"><strong>tXMLMap</strong></span> to <span class="bold"><strong>tRESTResponse</strong></span> using <span class="bold"><strong>Row</strong></span>
                        &gt; <span class="bold"><strong>ResponseUsers</strong></span> connection.</p></li><li class="step" title="Step 2"><p>Click <span class="bold"><strong>Sync columns</strong></span> to retrieve the schema
                        defined in the preceding component.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest7.png" align="middle"></div></li><li class="step" title="Step 3"><p>Select <span class="bold"><strong>OK(200)</strong></span> from the <span class="bold"><strong>Return status code</strong></span> list.</p></li><li class="step" title="Step 4"><p>Leave the rest of the settings as they are.</p></li></ol></div></div><div class="section" title="Saving and executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184546"></a>Saving and executing the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Save the Job and press <span class="bold"><strong>F6</strong></span> to execute
                        it.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest8.png" align="middle"></div></li><li class="step" title="Step 2"><p>Go to your browser if you want to test the service.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest10.png" align="middle"></div><p> The HTTP request for a user id is accepted by the REST service and the
                        HTTP response is sent back to the server.</p></li></ol></div></div></div><div class="section" title="Scenario&nbsp;2: Using URI Query parameters to explore the data of a database"><div class="titlepage"><div><div><h3 class="title"><a name="mlelandais-20120329-esb-trestrequest-scenario2"></a>Scenario&nbsp;2: Using URI Query parameters to explore the data of a database</h3></div></div></div><p>This scenario describes how to use URI query parameters in <span class="bold"><strong>tRESTRequest</strong></span> to explore data of a database, and send the response via the
            <span class="bold"><strong>tRESTResponse</strong></span>.</p><p>To do so, you can create two subjobs linked together by an <span class="bold"><strong>OnSubjobOk</strong></span> connection; this way the two subjobs will be executed
            sequencially. For more information on Trigger connection, see the <span class="emphasis"><em>Talend Open Studio User Guide</em></span>.
            The first subjob will create and populate the database and the second one will allow to
            explore the database through the REST service.</p><div class="mediaobject"><img src="../images/use_case-trestrequest1-1.png"></div><div class="section" title="Creating the first subjob"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184589"></a>Creating the first subjob</h4></div></div></div><p>To do this, proceed as follows:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Drop the following components from the <span class="bold"><strong>Palette</strong></span> onto the design workspace: <span class="bold"><strong>tFixedFlowInput</strong></span> from the <span class="bold"><strong>Misc</strong></span> family and <span class="bold"><strong>tMysqlOutput</strong></span> from the <span class="bold"><strong>Databases</strong></span> &gt; <span class="bold"><strong>Mysql</strong></span>
                        family.</p></li><li class="step" title="Step 2"><p>Link <span class="bold"><strong>tFixedFlowInput</strong></span> to <span class="bold"><strong>tMysqlOutput</strong></span> using a <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Main</strong></span>
                        connection.</p></li><li class="step" title="Step 3"><p>Double-click <span class="bold"><strong>tFixedFlowInput</strong></span> to display
                        its <span class="bold"><strong>Basic settings</strong></span> view:</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-2.png" align="middle"></div></li><li class="step" title="Step 4"><p>Click the <span class="bold"><strong>[...]</strong></span> button next to <span class="bold"><strong>Edit schema</strong></span> to open the schema editor.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-3.png" align="middle"></div></li><li class="step" title="Step 5"><p>In the schema editor, click the <span class="bold"><strong>[+]</strong></span>
                        button three times to add three lines and set them as displayed in the above
                        screenshot.</p></li><li class="step" title="Step 6"><p>Click <span class="bold"><strong>Ok</strong></span>.</p></li><li class="step" title="Step 7"><p>Back to <span class="bold"><strong>tFixedFlowInput</strong></span>
                        <span class="bold"><strong>Basic settings</strong></span> view, in the <span class="bold"><strong>Mode</strong></span> area, select the <span class="bold"><strong>Use
                            inline table</strong></span> option.</p></li><li class="step" title="Step 8"><p>Under the inline table, click the <span class="bold"><strong>[+]</strong></span>
                        button three times to add three rows in the table.</p></li><li class="step" title="Step 9"><p>In the inline table, click the <span class="italic">id</span> field
                        of the first row and type in <span class="italic">1</span>.</p></li><li class="step" title="Step 10"><p>Click the <span class="italic">firstname</span> field of the first
                        row, press <span class="bold"><strong>Ctrl+Space</strong></span> to display the
                        autocompletion list and select the <span class="bold"><strong>TalendDataGenerator.getFirstName()</strong></span> variable in the
                        list.</p></li><li class="step" title="Step 11"><p>Click the <span class="italic">lastname</span> field of the first
                        row, press <span class="bold"><strong>Ctrl+Space</strong></span> to display the
                        autocompletion list and select the <span class="bold"><strong>TalendDataGenerator.getLastName()</strong></span> variable in the
                        list.</p></li><li class="step" title="Step 12"><p>Do the same for the two following rows to obtain the settings displayed in
                        the screenshot.</p></li><li class="step" title="Step 13"><p>Double-click <span class="bold"><strong>tMysqlOutput</strong></span> to display its
                            <span class="bold"><strong>Basic settings</strong></span> view:</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-4.png" align="middle"></div></li><li class="step" title="Step 14"><p>From the <span class="bold"><strong>Property Type</strong></span> list, leave
                            <span class="bold"><strong>Built-in</strong></span> and fill in the <span class="bold"><strong>Host</strong></span>, <span class="bold"><strong>Port</strong></span>,
                            <span class="bold"><strong>Database</strong></span>, <span class="bold"><strong>Username</strong></span> and <span class="bold"><strong>Password</strong></span>
                        fields manually. If you centralized your connection information to the
                        database in the <span class="bold"><strong>Metadata</strong></span> &gt; <span class="bold"><strong>DB Connections</strong></span> node of the <span class="bold"><strong>Repository</strong></span>, you can select <span class="bold"><strong>Repository</strong></span> from the list and the fields will be
                        automatically filled in.</p><p>For more information about storing metadata, see <span class="emphasis"><em>Talend Open Studio User
                            guide</em></span>.</p></li><li class="step" title="Step 15"><p>In the <span class="bold"><strong>Table</strong></span> field, type in the name of
                        the table in which the data will be loaded, for example: <span class="italic">users</span>.</p></li><li class="step" title="Step 16"><p>From the <span class="bold"><strong>Action on table</strong></span> list, select
                            <span class="bold"><strong>Drop table if exists and create</strong></span>, select
                            <span class="bold"><strong>Insert</strong></span> from the <span class="bold"><strong>Action on data</strong></span> list.</p></li><li class="step" title="Step 17"><p>Click <span class="bold"><strong>Sync columns</strong></span> to retrieve the schema
                        coming from the previous component.</p></li></ol></div></div><div class="section" title="Creating the second subjob"><div class="titlepage"><div><div><h4 class="title"><a name="d0e184807"></a>Creating the second subjob</h4></div></div></div><p>To do this, proceed as follows:</p><div class="procedure"><ul class="procedure"><li class="step" title="Step 1"><p>Drop and place the following components as displayed in the first
                            screenshot: </p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p><span class="bold"><strong>tRESTRequest</strong></span> and
                                            <span class="bold"><strong>tRESTResponse</strong></span> from the
                                            <span class="bold"><strong>ESB</strong></span> &gt; <span class="bold"><strong>REST</strong></span> family,</p></li><li class="listitem"><p><span class="bold"><strong>tFlowToIterate</strong></span> from the
                                            <span class="bold"><strong>Orchestration</strong></span>
                                        family,</p></li><li class="listitem"><p><span class="bold"><strong>tMysqlInput</strong></span> from the
                                            <span class="bold"><strong>Databases</strong></span> &gt; <span class="bold"><strong>Mysql</strong></span> family,</p></li><li class="listitem"><p><span class="bold"><strong>tXMLMap</strong></span> from the
                                            <span class="bold"><strong>Processing</strong></span>
                                        family.</p></li></ul></div></li></ul></div><div class="section" title="Configuring the tRESTRequest component"><div class="titlepage"><div><div><h5 class="title"><a name="d0e184858"></a>Configuring the tRESTRequest component</h5></div></div></div><p>To do this, proceed as follows:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>tRESTRequest</strong></span> in the
                                design workspace to display its <span class="bold"><strong>Basic
                                    settings</strong></span> view:</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-5.png" align="middle"></div><p>
                            </p></li><li class="step" title="Step 2"><p>Fill the <span class="bold"><strong>REST Endpoint</strong></span> field with
                                the URI location where the REST-ful web service will be accessible
                                for requests. For example, <span class="italic">"http://localhost:8088/users"</span>.</p></li><li class="step" title="Step 3"><p>Click the <span class="bold"><strong>[+]</strong></span> button to add one
                                line in the <span class="bold"><strong>REST API Mapping</strong></span>
                                table.</p></li><li class="step" title="Step 4"><p>Select the newly-added line and click the <span class="bold"><strong>[...]</strong></span> button in the <span class="bold"><strong>Output
                                    Flow</strong></span> column to add a schema for the output
                                flow.</p></li><li class="step" title="Step 5"><p>In the dialog box, name the output flow <span class="italic">getUsers</span>. A schema editor dialog box appears.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-6.png" align="middle"></div></li><li class="step" title="Step 6"><p>In the schema editor, click the <span class="bold"><strong>[+]</strong></span> button twice to add two lines and set them as
                                displayed in the above screenshot. </p></li><li class="step" title="Step 7"><p>Click <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="Step 8"><p>Back to <span class="bold"><strong>tRESTRequest</strong></span>
                                <span class="bold"><strong>Basic settings</strong></span> view, select
                                    <span class="bold"><strong>GET</strong></span> from the list in the
                                    <span class="bold"><strong>HTTP Verb</strong></span> column.</p></li><li class="step" title="Step 9"><p>Leave the <span class="bold"><strong>URI Pattern</strong></span> column as
                                is.</p></li></ol></div><p>Now that you created the <span class="bold"><strong>tRESTRequest</strong></span> output
                    flow, you can use the corresponding link to connect to the following component:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Connect <span class="bold"><strong>tRESTRequest</strong></span> to <span class="bold"><strong>tFlowToIterate</strong></span> using <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>getUsers</strong></span> connection.</p></li><li class="step" title="Step 2"><p>Leave the <span class="bold"><strong>tFlowToIterate</strong></span> settings
                                as is.</p></li><li class="step" title="Step 3"><p>Connect <span class="bold"><strong>tFlowToIterate</strong></span> to
                                    <span class="bold"><strong>tMysqlInput</strong></span> using <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>Iterate</strong></span> connection.</p></li></ol></div></div><div class="section" title="Configuring the tMysqlInput component"><div class="titlepage"><div><div><h5 class="title"><a name="d0e184994"></a>Configuring the tMysqlInput component</h5></div></div></div><p>To do this, proceed as follows:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Double-click <span class="bold"><strong>tMysqlInput</strong></span> to
                                display its <span class="bold"><strong>Basic settings</strong></span>
                                view:</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-7.png" align="middle"></div></li><li class="step" title="Step 2"><p>From the <span class="bold"><strong>Property Type</strong></span> list,
                                leave <span class="bold"><strong>Built-in</strong></span> and fill in the
                                    <span class="bold"><strong>Host</strong></span>, <span class="bold"><strong>Port</strong></span>, <span class="bold"><strong>Database</strong></span>,
                                    <span class="bold"><strong>Username</strong></span> and <span class="bold"><strong>Password</strong></span> fields manually. If you
                                centralized your connection information to the database in the
                                    <span class="bold"><strong>Metadata</strong></span> &gt; <span class="bold"><strong>DB Connections</strong></span> node of the <span class="bold"><strong>Repository</strong></span>, you can select <span class="bold"><strong>Repository</strong></span> from the list and the fields
                                will be automatically filled in.</p><p>For more information about storing metadata, see <span class="emphasis"><em>Talend Open Studio User guide</em></span>.</p></li><li class="step" title="Step 3"><p>Leave the <span class="bold"><strong>Schema</strong></span> list as
                                    <span class="bold"><strong>Built-in</strong></span> and click the
                                    <span class="bold"><strong>[...]</strong></span> button next to the
                                    <span class="bold"><strong>Edit schema</strong></span> field.</p></li><li class="step" title="Step 4"><p>In the schema editor, define the schema exactly like the one of
                                the <span class="bold"><strong>tFixedFlowInput</strong></span>.</p></li><li class="step" title="Step 5"><p>In the <span class="bold"><strong>Table Name</strong></span> field, fill in
                                the name of the table in which the data are stored: <span class="italic">users</span>.</p></li><li class="step" title="Step 6"><p>Leave the <span class="bold"><strong>Query Type</strong></span> list as
                                    <span class="bold"><strong>Built-in</strong></span> and fill in the
                                    <span class="bold"><strong>Query</strong></span> field with the following
                                SQL query allowing to explore the database data with the URI query
                                set in the <span class="bold"><strong>tRESTRequest</strong></span> component: </p><pre class="programlisting">"select * from users where id &gt;= " + globalMap.get("getUsers.from") + " and  id &lt;= " + globalMap.get("getUsers.to")</pre></li></ol></div></div><div class="section" title="Configuring the tXMLMap component"><div class="titlepage"><div><div><h5 class="title"><a name="d0e185100"></a>Configuring the tXMLMap component</h5></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Right-click <span class="bold"><strong>tMysqlInput</strong></span>, hold and
                            drag to <span class="bold"><strong>tXMLMap</strong></span> to connect the two
                            components together.</p></li><li class="step" title="Step 2"><p>Double-click <span class="bold"><strong>tXMLMap</strong></span> in the design
                            workspace to open the <span class="bold"><strong>Map Editor</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-8.png" align="middle"></div></li><li class="step" title="Step 3"><p>Click the <span class="bold"><strong>[+]</strong></span> button on the top right
                            to add an output and name it as <span class="italic">ResponseUsers</span>.</p></li><li class="step" title="Step 4"><p>Click the <span class="bold"><strong>[+]</strong></span> button on the bottom
                            right to add two columns for the output. </p><p>Name the first column as <span class="italic">body</span> and
                            set the <span class="bold"><strong>Type</strong></span> to <span class="bold"><strong>Document</strong></span>. </p><p>Name the second column as <span class="italic">string</span>
                            and set the <span class="bold"><strong>Type</strong></span> to <span class="bold"><strong>String</strong></span>.</p></li><li class="step" title="Step 5"><p>Right-click on the <span class="bold"><strong>root</strong></span> node, select
                                <span class="bold"><strong>Rename</strong></span> in the list and rename it
                                <span class="italic">users</span></p></li><li class="step" title="Step 6"><p>Right-click on the <span class="bold"><strong>root</strong></span> node and
                            select <span class="bold"><strong>Create Sub-Element</strong></span> to create a
                            sub-element.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-9.png" align="middle"></div><p>Name the sub-element <span class="emphasis"><em>user</em></span> in the popup dialog
                            box.</p></li><li class="step" title="Step 7"><p>Right-click on the <span class="emphasis"><em>user</em></span> node created in the
                            previous step and select <span class="bold"><strong>As loop
                                element</strong></span>.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-10.png" align="middle"></div></li><li class="step" title="Step 8"><p>Select the <span class="italic">id</span> column of the
                                <span class="italic">row2</span> table to the left and drop
                            it onto the <span class="italic">user</span> node of the
                                <span class="italic">ResponseUsers</span> table to the
                            right.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-11.png" align="middle"></div></li><li class="step" title="Step 9"><p>In the <span class="bold"><strong>[Selection]</strong></span> dialog box, select
                            the <span class="bold"><strong>Create as attribute of target</strong></span> node
                            option and click <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="Step 10"><p>Select the <span class="italic">firstname</span> and <span class="italic">lastname</span> columns of the <span class="italic">row2</span> table to the left and drop it onto the
                                <span class="italic">user</span> node of the <span class="italic">ResponseUsers</span> table to the right.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-12.png" align="middle"></div></li><li class="step" title="Step 11"><p>In the <span class="bold"><strong>[Selection]</strong></span> dialog box, select
                            the <span class="bold"><strong>Create as sub-element of target
                                node</strong></span> option and click <span class="bold"><strong>OK</strong></span>.</p></li><li class="step" title="Step 12"><p>Click the wrench icon on the top of the <span class="italic">ResponseUsers</span> table to open the setting panel.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-13.png" align="middle"></div></li><li class="step" title="Step 13"><p>Set the <span class="bold"><strong>All in one</strong></span> feature as
                                <span class="bold"><strong>true</strong></span>, this way all XML data is
                            outputted in one single flow.</p></li><li class="step" title="Step 14"><p>Click <span class="bold"><strong>OK</strong></span> to save the settings.</p></li></ol></div></div><div class="section" title="Configuring the tRESTResponse component"><div class="titlepage"><div><div><h5 class="title"><a name="d0e185289"></a>Configuring the tRESTResponse component</h5></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Connect <span class="bold"><strong>tXMLMap</strong></span> to <span class="bold"><strong>tRESTResponse</strong></span> using <span class="bold"><strong>Row</strong></span> &gt; <span class="bold"><strong>ResponseUsers</strong></span>
                            connection.</p></li><li class="step" title="Step 2"><p>Double-click <span class="bold"><strong>tRESTResponse</strong></span> in the
                            design workspace to display its <span class="bold"><strong>Basic
                                settings</strong></span> view.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-14.png" align="middle"></div></li><li class="step" title="Step 3"><p>Click <span class="bold"><strong>Sync columns</strong></span> to retrieve the
                            schema defined in the preceding component.</p></li><li class="step" title="Step 4"><p>Leave the other settings as they are.</p></li></ol></div></div></div><div class="section" title="Connecting the two subjobs"><div class="titlepage"><div><div><h4 class="title"><a name="d0e185329"></a>Connecting the two subjobs</h4></div></div></div><p>Now that the two subjobs are created, you can connect them together:</p><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Right-click the <span class="bold"><strong>tFixedFlowInput</strong></span>
                            component of the first subjob.</p></li><li class="step" title="Step 2"><p>Select <span class="bold"><strong>Trigger</strong></span> &gt; <span class="bold"><strong>OnSubjobOk</strong></span> on the list.</p></li><li class="step" title="Step 3"><p>Click the <span class="bold"><strong>tRESTRequest</strong></span> component of
                            the second subjob.</p></li></ol></div><p>This way, when executing the job, the second subjob will be executed only if the
                first one's execution succeeded.</p></div><div class="section" title="Saving and executing the Job"><div class="titlepage"><div><div><h4 class="title"><a name="d0e185358"></a>Saving and executing the Job</h4></div></div></div><div class="procedure"><ol class="procedure" type="1"><li class="step" title="Step 1"><p>Save the Job and press <span class="bold"><strong>F6</strong></span> to execute
                        it.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-15.png" align="middle"></div></li><li class="step" title="Step 2"><p>Go to your browser if you want to test the service. </p><p>For example, use the URI query <code class="code">?to=2</code> to retrieve the data of
                        the two first users.</p><div class="mediaobject" align="center"><img src="../images/use_case-trestrequest1-16.png" align="middle"></div><p> The HTTP request for a user id is accepted by the REST service and the
                        HTTP response is sent back to the server.</p></li></ol></div></div></div></div></body></html>