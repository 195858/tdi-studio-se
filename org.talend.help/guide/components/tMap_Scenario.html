<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN" "http://www.w3.org/MarkUp/Wilbur/HTML32.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="GENERATOR" content="Quadralay WebWorks Publisher Standard Edition 8.0.5337.0">
    <meta name="TEMPLATEBASE" content="Simple HTML">
    <meta name="LASTUPDATED" content="10/05/07 18:38:02">
    <title>Scenario 1: Mapping with filter and simple explicit join (Perl) </title>
  </head>

  <body link="#3366CC" vlink="#9999CC" text="#000000" alink="#0000CC" bgcolor="#FFFFFF">

    <!--table width="220" border="0" align="right" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a href="tMap_Prop.html"><img src="images/sprev.gif" border="0" alt="Previous"></a><a href="tMomInput_Prop.html"><img src="images/snext.gif" border="0" alt="Next"></a>
        </td>
      </tr>
    </table-->

    <!--img src="images/wwplogo.gif" width="122" height="63" alt="Put your logo here!">
    <hr align="left"-->

    <blockquote>
<a name="wp1190029"> </a><div><font color="#000000" face="Arial, Verdana, Helvetica, sans-serif" size="2">

</font></div>
<a name="wp1294464"> </a><h3><font color="#666666" face="Arial, Verdana, Helvetica, sans-serif" size="3"><b>
Scenario 1: Mapping with filter and simple explicit join (Perl) 
</b></font></h3>
<a name="wp1287847"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
The job described below aims at reading data from a csv file stored in the Repository, looking up at a reference file also stored remotely, then extracting data from these two files based on defined filters to an output file or a reject file. 
</font></p>
<a name="wp1346033"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
This job is presented in Perl but could also be carried out in Java.
</font></p>
<ul>
<ul>
<a name="wp1190044"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click on <b>File</b> in the Palette of components, select  <b>tFileInputCSV</b> and drop it on the design area. Rename the Label to <i>Cars</i>, either by double-clicking on the label in the workspace or via the <b>View</b> tab of the Properties panel.</font></li>
<a name="wp1190058"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Repeat this operation, and rename this second input component: <i>Owners</i>. </font></li>
<a name="wp1190067"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click on <b>Processing</b> in the Palette of components, select <b>tMap</b> and drop it on the design area. </font></li>
<a name="wp1190071"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Connect the two Input components to the mapping component and customize the row connection labels.</font></li>
<a name="wp1190080"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-1.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190085"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The Cars and Owners delimited files metadata are defined in the Metadata area of the repository. You can hence use their Repository reference in the Properties panel.</font></li>
<a name="wp1190094"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Double-click on <i>Cars</i>, to set the Properties panel.</font></li>
<a name="wp1190101"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-2.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190115"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Select <i>Repository</i> to retrieve <b>Property type</b> as well as <b>Schema type</b>. The rest of the fields gets automatically filled in appropriately when you select the relevant Metadata entry on the list.</font></li>
<a name="wp1190119"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Double-click on the Owners component and repeat the setting operation. Select the corresponding Metadata entry.</font></li>
<a name="wp1190126"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
For further information regarding Metadata creation in the Repository, see <a href="Technical_Process-08.html"><i>Defining Metadata items</i></a> on <a href="Technical_Process-08.html"> </a>.
</font></p>
<a name="wp1190139"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then double-click on the <b>tMap</b> component to open the Mapper. Notice that the Input area is already filled with the Input component metadata tables and that the top table is the Main flow table. </font></li>
<a name="wp1190144"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Notice also that the respective row connection labels display on the top bar of the tables.</font></li>
<a name="wp1190147"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Create a Join between the two tables on the ID_Owner field by simply dragging the top table <i>ID_Owner</i> field to the lookup input table. </font></li>
<a name="wp1190156"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190162"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Define this link as an Inner Join by checking the box.</font></li>
<a name="wp1190170"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click on the <b>Plus</b> button on the Output area of the Mapper to add three Output tables</font></li>
<a name="wp1190177"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-5.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190182"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Drag and drop Input content to fill in the first output schema. For more information regarding data mapping<a href="Technical_Process-11.html">, see&#160;<i>Mapping data flows in a job.</i></a></font></li>
<a name="wp1190189"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click on the plus arrow button to add a filter row. In the <i>Insured</i> table, will be gathered cars and owners data which include an <i>Insurance ID</i>.</font></li>
<a name="wp1190198"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-6.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190203"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Therefore drag the ID_Insurance field to the Filter condition area and enter the formula used meaning `not undefined&#39;: <code>$Owners_data[ID_Insurance] ne &#39;&#39;</code> </font></li>
<a name="wp1190210"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The Reject_NoInsur table is a standard reject output flow containing all data that do not satisfy the required filter condition. Click the orange arrow to set the table as Reject Output.</font></li>
<a name="wp1190219"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-7.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190224"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The third and last table gathers the schema entries  whose Inner Join could not be established. One <i>Owners_ID</i>  from the <i>Car</i> database does not match any <i>Owner_ID</i> from the <i>Owner</i> file.</font></li>
<a name="wp1190229"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click the violet arrow button to set the last table as the Inner Join Reject output flow. </font></li>
<a name="wp1190233"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click OK to validate and come back to the design area.</font></li>
<a name="wp1190239"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Add three <b>tFileOutputDelimited</b> components to the workspace and right-click on the tMap to connect the Mapper with all three output components, using the relevant Row connection. </font></li>
<a name="wp1190245"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Relabel the three output components accordingly.</font></li>
<a name="wp1190252"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-8.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190257"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then double-click on each of them, one after the other, in order to define their respective output filepath. If you want a new file to be created, browse to the destination output folder, and type in  a file name including the extension.</font></li>
<a name="wp1190264"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Check the <b>Include header</b> box to reuse the column labels from the schema as header row in the output file.</font></li>
<a name="wp1190273"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-10.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190282"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Run the Job using the F6 keystroke or via the <b>Run Job</b> panel.</font></li>
<a name="wp1190287"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Output files have been created if need be.</font></li>
<a name="wp1190295"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-1-9.png" border="0" hspace="0" vspace="0"><br>

</font></p>
</ul>
</ul>
<a name="wp1190301"> </a><h3><font color="#666666" face="Arial, Verdana, Helvetica, sans-serif" size="3"><b>
Scenario 2: Mapping with Inner join rejection (Perl)
</b></font></h3>
<a name="wp1294490"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
This scenario, based on scenario 1, adds one input file containing Resellers details and extra fields in the main Output table. Two filters on Inner Joins are added to gather specific rejections.
</font></p>
<ul>
<ul>
<a name="wp1190316"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click on <b>File</b> in the Palette of Components, and drop a <b>tFileInputCSV</b> component on the workspace. </font></li>
<a name="wp1190322"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Connect it to the Mapper and put a label on the component and the connection.</font></li>
<a name="wp1190329"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-2.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190335"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Double-click on the <i>Resellers</i> component, to define the <i>Reseller</i> input properties. </font></li>
<a name="wp1190338"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Browse to the <i>Resellers.csv</i> file. Edit the schema and add the columns as needed to match the file structure.</font></li>
<a name="wp1190347"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-1.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190352"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">You could also create a metadata entry for this file description and select Repository as properties and schema type. For further information<a href="Technical_Process-08.html#wp1037313">, see&#160;<i>Setting up a File Delimited schema.</i></a></font></li>
<a name="wp1190359"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2"> Double-click on the tMap component and notice that the schema is added on the Input area.</font></li>
<a name="wp1190368"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190373"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Create a join between the main input flow and the resellers input. Check the Inner Join box to define that an Inner Join Reject output is to be created.</font></li>
<a name="wp1190379"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Drag &amp; drop the fields from the Resellers table to the main Output table.</font></li>
<a name="wp1190386"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-4.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190389"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
Note:	When two inner joins are defined, you either need to define two different inner join reject tables to differenciate both rejections or if there is only one Inner Join reject output, both Inner Join rejections will be stored in the same output.  
</font></p>
<a name="wp1190396"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">On the output area, click on the plus button to add a new output table.</font></li>
<a name="wp1190400"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Give a name to this new Output connection: <i>Reject_ResellerID</i></font></li>
<a name="wp1190403"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click the Inner Join reject button to define this new output table as Inner Join  Reject output.</font></li>
<a name="wp1190410"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Drag &amp; drop two fields from the main input flow (<i>Cars</i>) to the new reject output table. In this case, if the Inner Join cannot be established, these data (<i>ID_Cars</i> &amp; <i>ID_resellers</i>) will be gathered in the output file and will help identify the bottleneck.</font></li>
<a name="wp1190425"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-5.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190430"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Now apply filters on the two Inner Join reject outputs, in order for to distinguish both types of rejection.</font></li>
<a name="wp1190437"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">In the first Inner Join output table (<i>Reject_OwnerID</i>), click the plus arrow button to add a filter line and fill it in with the following formula to gather only OwnerID-related rejection: <code>not defined $Owners_data[ID_Owner]</code> </font></li>
<a name="wp1190447"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">In the second Inner Join output table (<i>Reject_ResellerID</i>), repeat the same operation using the following formula: <code>not defined $Resellers_data[ID_Reseller]</code> </font></li>
<a name="wp1190459"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-6.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190465"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click OK to validate and close the Mapper editor. </font></li>
<a name="wp1190477"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Right-click on the <b>tMap</b> component, click on <b>Row</b> and select <i>Reject_ResellerID</i> in the list.</font></li>
<a name="wp1190481"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Connect the main row from the Mapper to the Reseller Inner Rejection output component</font></li>
<a name="wp1190490"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-7.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190495"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">For this scenario, remove from the Resellers.csv the rows corresponding to Reseller ID 5 and 8.</font></li>
<a name="wp1190501"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then run the job through a F6 key stroke or from the Run Job panel. </font></li>
<a name="wp1190508"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap2-2-8.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1190514"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The four output files are all created in the defined folder (Outputs).</font></li>
<a name="wp1190520"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Notice in the Inner Join reject output file, <i>NoResellerID.csv</i>, that the ID_Owners field values matching the Reseller ID 5 and 8 were rejected from the cars file to this file.</font></li>
</ul>
</ul>
<a name="wp1190529"> </a><h3><font color="#666666" face="Arial, Verdana, Helvetica, sans-serif" size="3"><b>
Scenario 3: Cascading join mapping
</b></font></h3>
<a name="wp1294496"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
As third advanced use scenario, based on the scenario 2, add a new Input table containing Insurance details for example. 
</font></p>
<a name="wp1190536"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
Set up an Inner Join between two lookup input tables (Owners and Insurance) in the Mapper to create a cascade lookup and hence retrieve Insurance details via the Owners table data.
</font></p>
<a name="wp1342213"> </a><h3><font color="#666666" face="Arial, Verdana, Helvetica, sans-serif" size="3"><b>
Scenario 4: Advanced mapping with filters, explicit joins and Inner join rejection
</b></font></h3>
<a name="wp1346154"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
This scenario introduces a job (in Java) tMap which allows to find the reseller&#39;s customer leads who are owners of a defined make, and have between 2 and 6 children (inclusive), for upsale purpose for example.
</font></p>
<a name="wp1346210"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
</font></p>
<div align="center"><img src="images/UseCase_tmap4-1.png" border="0" hspace="0" vspace="0"></div><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">

</font></p>
<ul>
<ul>
<a name="wp1346232"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Drag and drop the following components from the Palette: <b>tFileInputDelimited</b> (x3), <b>tMap</b>, <b>tFileOutputDelimited</b> (x2)</font></li>
<a name="wp1346263"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Connect the input flow components to the tMap using a <b>Main row</b> connection. Pay attention to the file you connect first as it will automatically be set as <b>Main</b> flow. And all other connections will thus become <b>Lookup</b> flows.</font></li>
<a name="wp1346324"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Define the <b>Properties</b> of each of the Input components. For example, define the <i>Resellers</i> file path used as <b>Main </b>flow in the job.</font></li>
<a name="wp1346354"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-2.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1346759"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Define the delimited file to be used, the Row and the Field Separator, the Header and Footer rows if any.</font></li>
<a name="wp1346769"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2"><b>Edit the Schema</b> if it hasn&#39;t been stored in the <b>Repository</b>. You will retrieve this schema in the <b>Main</b> table at the top of the <b>Input</b> area of the mapper.</font></li>
<a name="wp1346783"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Carry out these previous steps for the other Input components: <i>Cars</i> and <i>Owners</i>. These two <b>Lookup</b> flows will fill in secondary (lookup) tables in the Input area of the Mapper.</font></li>
<a name="wp1346917"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then double-click on the <b>tMap</b> component to launch the Mapper and define the mapping and filters.</font></li>
<a name="wp1346953"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1346986"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">First set the explicite joins between the <b>Main</b> flow and the <b>Lookup</b> flows.</font></li>
<a name="wp1347014"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Simply drag &amp; drop the <i>ID_Resellers</i> <b>column</b> towards the corresponding column and this way fill in the <b>Expression key</b> field of the <b>Lookup</b> table.</font></li>
<a name="wp1347022"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1347112"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The explicit join displays in color along with a hash key.</font></li>
<a name="wp1347124"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then in thr <b>Expr. Key</b> of the <i>Make</i> column, type in (in Java) the filter. In this use case, simply type in <i>&quot;BMW&quot;</i> as the search  is focused on the Owners of this particular Make. </font></li>
<a name="wp1347166"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Implement a cascading join between the two lookup tables <i>Cars</i> and <i>Owners</i>, in order to retrieve owners information regarding the number of children they have. </font></li>
<a name="wp1347200"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1347244"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Simply drag and drop the <i>ID_Owners</i> column from the <i>Cars</i> table towards the <b>Expr. Key</b> field of the <i>id_owner</i> column from the <i>Owners</i> table.</font></li>
<a name="wp1347292"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click the <b>Filter</b> button next to the <b>Inner Join</b> button to display the <b>Filter</b> expression area.</font></li>
<a name="wp1347338"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Type in the <b>Filter</b> statement to narrow down the number of rows loaded in the <b>Lookup</b> flows. In this use case, the statement reads: <code>Owners.Children_Nr &gt; 1 &amp;&amp; Owners.Children_Nr &lt; 6</code> </font></li>
<a name="wp1347435"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then, as you want to reject the null values into a separate table and exclude them from the standard output, check the <b>Inner Join</b> box for each of the filtered <b>Lookup</b> tables.</font></li>
<a name="wp1347472"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1347510"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">In the Inner join, you can then choose to include only a <b>Unique match, the First or Last match or All Matches</b>. In this use case, the <b>All matches</b> option is selected. Thus if several matchs are found in the Inner Join, i.e. rows matching the explicit join as well as the filter, all of them will be added to the output flow (either in Rejection or the regular output). </font></li>
<a name="wp1348114"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Then on the <b>Output</b> area of the <b>Mapper</b>, add two tables, one for the full matches and  one for the rejections.</font></li>
<a name="wp1347576"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Click the plus button to add the tables and give a name to the outputs.</font></li>
<a name="wp1347680"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1347715"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Drag and drop data from the <b>Main</b> and <b>Lookup</b> tables in the Input area, towards the respective output tables, following the type of information you want to fetch.</font></li>
<a name="wp1347740"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">In the rejection table used to direct the non-matches from the external join or the filter, click the <b>Inner Join Reject </b>button (violet arrow) to activate it.</font></li>
<a name="wp1347782"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">On the <b>Designer</b> space, right-click on the <b>tMap</b> and pull the respective output link to the relevant components.</font></li>
<a name="wp1347819"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Define the <b>Properties</b> of the <b>Output</b> components. </font></li>
<a name="wp1347855"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-4.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1347872"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Define the filepath, the expected Row and Field separator. And for this use case, check the Include Header box.</font></li>
<a name="wp1347904"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The <b>Schema</b> should be automatically propagated from the <b>Mapper</b>.</font></li>
<a name="wp1347928"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Save you job, then go to the <b>Run Job</b> tab and check the <b>Statistics</b> box to follow the processing thread.</font></li>
<a name="wp1347951"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap4-5.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1347970"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
The statistics show that several matches were found and therefore the sum of the output rows (Main + rejected) exceeds the <b>Main</b> flow input rows.
</font></p>
</ul>
</ul>
<a name="wp1348316"> </a><h3><font color="#666666" face="Arial, Verdana, Helvetica, sans-serif" size="3"><b>
Scenario 5: Advanced mapping with filters and a check of all rows  
</b></font></h3>
<a name="wp1348360"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
This scenario is a modfied version of the preceding scenario. It describes a job that apply filters and then check each row of loaded lookup rows. 
</font></p>
<a name="wp1348384"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
</font></p>
<div align="center"><img src="images/UseCase_tmap5-1.png" border="0" hspace="0" vspace="0"></div><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">

</font></p>
<ul>
<ul>
<a name="wp1348406"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Take the same job as in <a href="tMap_Scenario.html#wp1342213"><i>Scenario 4: Advanced mapping with filters, explicit joins and Inner join rejection</i></a>.</font></li>
<a name="wp1348431"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">No changes are required in the Input delimited files.</font></li>
<a name="wp1348452"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Launch the Mapper to change the mapping and the filters.</font></li>
<a name="wp1348463"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap5-2.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1348532"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Remove all explicit joins between the <b>Main</b> table and the <i>Cars</i> <b>Lookup</b> table.</font></li>
<a name="wp1348767"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Notice that the <b>All Matches</b> setting changes automatically to <b>All Rows</b>. In fact, as no explicit join is declared (no hash keys), all lookup rows need to be loaded and checked  against all main flow rows.</font></li>
<a name="wp1348546"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Remove the <b>Expr. key</b> filter (<i>&quot;BMW&quot;</i>) from the <i>Cars</i> table.</font></li>
<a name="wp1348602"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap5-2.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1348645"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">And click the <b>Filters</b> button to display the <b>Filter</b> area. Then type in the new filter to narrow down the search to <i>BMW</i> or <i>Mercedes</i> car makes. The statement reads as follows: <code>Cars.Make.equals(&quot;BMW&quot;) ||  Cars.Make.equals(&quot;Mercedes&quot;)</code>  </font></li>
<a name="wp1348741"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">The filter on the <i>Owners</i> <b>Lookup</b> table doesn&#39;t change from the previous scenario.</font></li>
<a name="wp1348871"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Define new file paths for the respective outputs.</font></li>
<a name="wp1348885"> </a><li><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">Save the job and enable the <b>Statistics</b> on the Run Job tab before executing the job.</font></li>
<a name="wp1348907"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap5-4.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1348940"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
The Statistics show that a cartesian product has been carried out between the Main flow rows with the  filtered Lookup rows.
</font></p>
<a name="wp1348968"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap5-3.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1348991"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
The content of the main output flow shows that the filtered rows have correctly been passed on.
</font></p>
<a name="wp1349023"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
<br>
<img src="images/UseCase_tmap5-5.png" border="0" hspace="0" vspace="0"><br>

</font></p>
<a name="wp1349059"> </a><p><font color="Black" face="Arial, Verdana, Helvetica, sans-serif" size="2">
Whereas, the Reject result clearly shows the rows that didn&#39;t match one of the filter. 
</font></p>
</ul>
</ul>
    </blockquote>
    <hr>

    <!--table align="right" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td align="right"><font size="1">
          <a href="http://www.webworks.com"><img src="images/webworks.gif" width="150" height="20" border="0"></a><br>
            Quadralay Corporation<br>
            http://www.webworks.com<br>
            Voice: (512) 719-3399<br>
            Fax: (512) 719-3606<br>
          <a href="mailto:sales@webworks.com">sales@webworks.com</a><br>
        </font></td>
      </tr>
    </table-->

    <!--table width="220" border="0" cellpadding="0" cellspacing="0">
      <tr> 
        <td>
<a href="tMap_Prop.html"><img src="images/sprev.gif" border="0" alt="Previous"></a><a href="tMomInput_Prop.html"><img src="images/snext.gif" border="0" alt="Next"></a>
        </td>
      </tr>
    </table-->
  </body>
</html>
