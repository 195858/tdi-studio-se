<%@ jet 
	imports="
		org.talend.core.model.process.INode 
		org.talend.core.model.metadata.IMetadataTable 
		org.talend.designer.codegen.config.CodeGeneratorArgument
		org.talend.core.model.process.ElementParameterParser 
		java.util.List
	" 
%>
<%
CodeGeneratorArgument codeGenArgument = (CodeGeneratorArgument) argument;
INode node = (INode)codeGenArgument.getArgument();
String cid = node.getUniqueName();
List<IMetadataTable> metadatas = node.getMetadataList();
if ((metadatas!=null)&&(metadatas.size()>0)) {
	IMetadataTable metadata = metadatas.get(0);
	if (metadata!=null) {
		String limitString = ElementParameterParser.getValue(node, "__LIMIT__");
		int limit = limitString.equals("") ? -1 : Integer.parseInt(limitString);
    	int footer = Integer.parseInt(ElementParameterParser.getValue(node, "__FOOTER__"));
    	int randoms = -1;
    	if(ElementParameterParser.getValue(node, "__RANDOM__").equals("true")){
    		randoms = Integer.parseInt(ElementParameterParser.getValue(node, "__NB_RANDOM__"));
    	}
%>
}
delReader_<%=cid %>.close();
<%
		if(randoms >= 0){
%>
globalMap.put("<%=cid %>_NB_LINE", random_size_<%=cid %>);
<%
		}else if(footer > 0 || limit >= 0){
%>
globalMap.put("<%=cid %>_NB_LINE", limit_<%=cid %>);
<%
		}else{
%>
globalMap.put("<%=cid %>_NB_LINE", delReader_<%=cid %>.getProcessedRecordCount());
<%
		}
	}
}
%>      