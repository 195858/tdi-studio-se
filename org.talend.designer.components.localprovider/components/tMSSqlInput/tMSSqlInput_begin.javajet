<%@ jet 
imports="
		org.talend.core.model.process.INode 
		org.talend.core.model.process.ElementParameterParser 
		org.talend.core.model.metadata.IMetadataTable 
		org.talend.core.model.metadata.IMetadataColumn
		org.talend.designer.codegen.config.CodeGeneratorArgument
		org.talend.core.model.process.IConnection
		org.talend.core.model.process.IConnectionCategory
		org.talend.core.model.metadata.builder.database.ExtractMetaDataUtils
		org.talend.core.model.metadata.types.JavaTypesManager
		org.talend.core.model.metadata.types.JavaType		
		java.util.List
		java.util.Map
" 
%>
	<%@ include file="../templates/DB/Input/HelpClass.javajet"%>
<%

	class DBInputBeginUtil extends DefaultDBInputUtil{
	
		public void afterUseExistConnection(INode node) {
			String connection = ElementParameterParser.getValue(node,"__CONNECTION__");
			String conn = "conn_" + connection;
			String schema = "dbschema_" + connection;
%>
			String dbschema_<%=cid%> = (String)globalMap.get("<%=schema%>");
<%
	    }
	
		public void setURL(INode node) {
			
			String dbschema = ElementParameterParser.getValue(node, "__DB_SCHEMA__");
%>
		    String port_<%=cid%> = <%=dbport%>;
		    String dbname_<%=cid%> = <%=dbname%> ;
		    String url_<%=cid %> = "jdbc:jtds:sqlserver://" + <%=dbhost%> ; 
		    if (!"".equals(port_<%=cid%>)) {
		    	url_<%=cid %> += ":" + <%=dbport%>;
		    }
		    if (!"".equals(dbname_<%=cid%>)) {
		    	url_<%=cid%> += "//" + <%=dbname%>; 
		    }
		    url_<%=cid%> += ";appName=" + projectName + ";" + <%=dbproperties%>;
		    String dbschema_<%=cid%> = <%=dbschema%>;
<%		
		}
		
		public String getDirverClassName(INode node){
			return "net.sourceforge.jtds.jdbc.Driver";
		}
		//-----------according schema type to generate ResultSet
	    
	    //---------end according schema type to generate ResultSet
	}//end class
	
	dbInputBeginUtil = new DBInputBeginUtil();
%>
    
	<%@ include file="../templates/DB/Input/AbstractDBInputBegin.javajet"%>




