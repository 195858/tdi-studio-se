<%@ jet 
	imports="
		org.talend.core.model.process.INode 
		org.talend.designer.codegen.config.CodeGeneratorArgument
		org.talend.core.model.process.ElementParameterParser
	" 
%>
<%
	CodeGeneratorArgument codeGenArgument = (CodeGeneratorArgument) argument;
	INode node = (INode)codeGenArgument.getArgument();
	String cid = node.getUniqueName();
	boolean version07 = ("true").equals(ElementParameterParser.getValue(node,"__VERSION_2007__"));
%>
				nb_line_<%=cid%>++;
			}
			globalMap.put("<%=cid %>_NB_LINE",nb_line_<%=cid %>);
		} finally { 
				<%if(!version07){%>
					if(!(source_<%=cid %> instanceof java.io.InputStream)){
						workbook_<%=cid %>.close();
					}
				<%}else{%>
  				if(!(source_<%=cid %> instanceof java.io.InputStream)){
  					workbook_<%=cid %>.getPackage().revert();
  				}
				<%}%>
		}	
		