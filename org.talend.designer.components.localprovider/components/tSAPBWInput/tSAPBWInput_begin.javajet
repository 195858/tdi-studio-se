<%@ jet 
imports="
	org.talend.core.model.process.INode
	org.talend.core.model.process.ElementParameterParser
	org.talend.core.model.metadata.IMetadataTable
	org.talend.core.model.metadata.IMetadataColumn
	org.talend.designer.codegen.config.CodeGeneratorArgument
	org.talend.core.model.process.IConnection
	org.talend.core.model.process.IConnectionCategory
	org.talend.core.model.metadata.types.JavaTypesManager
	java.util.List
	java.util.Map
" 
%>
	<%@ include file="../templates/DB/Input/HelpClass.javajet"%>
<%

	class SAPBWInputBeginUtil extends DefaultDBInputUtil{
		
		public void createConnection(INode node) {
			cid = node.getUniqueName();
			String jdbcUrl = ElementParameterParser.getValue(node, "__URL__");
	    	dbuser = ElementParameterParser.getValue(node, "__USER__");
	 		dbpwd = ElementParameterParser.getValue(node, "__PASS__");
%>
			    java.lang.Class.forName("org.jdbc4olap.jdbc.OlapDriver");
			    String url_<%=cid %> = <%=jdbcUrl %>;
		        String dbUser_<%=cid %> = <%=dbuser %>;
		        String dbPwd_<%=cid %> = <%=dbpwd %>;
		        conn_<%=cid%> = java.sql.DriverManager.getConnection(url_<%=cid %>,dbUser_<%=cid%>,dbPwd_<%=cid%>);
<%
		}
		//-----------according schema type to generate ResultSet
		public void generateTimestampResultSet(String firstConnName, IMetadataColumn column, int currentColNo) {
%>
            java.sql.Timestamp timestamp_<%=cid%> = rs_<%=cid %>.getTimestamp(<%=currentColNo%>);
            if(timestamp_<%=cid%> != null) {
                <%=firstConnName%>.<%=column.getLabel()%> = new java.util.Date(timestamp_<%=cid%>.getTime());
            } else {
                <%=firstConnName%>.<%=column.getLabel()%> =  null;
            }
<%
	    }  
	    //---------end according schema type to generate ResultSet
	       public void afterGenertorType(String firstConnName, IMetadataColumn column, int currentColNo) {
			if (column.isNullable()) {
%>
				if (rs_<%=cid%>.wasNull()) {
					<%=firstConnName%>.<%=column.getLabel()%> = null;
				}
<%
			}
	    }
	}//end class
	
	dbInputBeginUtil = new SAPBWInputBeginUtil();
%>
    
	<%@ include file="../templates/DB/Input/AbstractDBInputBegin.javajet"%>


