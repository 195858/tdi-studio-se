<%@ jet
imports="
    org.talend.core.model.process.INode 
    org.talend.core.model.process.ElementParameterParser
    org.talend.designer.codegen.config.CodeGeneratorArgument
"
%>

<%
        CodeGeneratorArgument codeGenArgument = (CodeGeneratorArgument) argument;
        INode node = (INode)codeGenArgument.getArgument();
        String cid = node.getUniqueName();      

        String localdir = ElementParameterParser.getValue(node, "__LOCALDIR__");
        
        boolean replaceFiles = ElementParameterParser.getValue(node,"__REPLACE_FILES__").equals("true");
%>
<% if(!replaceFiles) {%>        
        String parentPath_<%=cid%> = new java.io.File(<%=localdir %>).getPath();
        java.util.List<String> list_<%=cid%> = new java.util.ArrayList<String>();
        for (int i_<%=cid%> = 0; i_<%=cid%> < sourceFileNames_<%=cid%>.length; i_<%=cid%>++) {
            String fileName_<%=cid%> = sourceFileNames_<%=cid%>[i_<%=cid%>];
            if (!new java.io.File(parentPath_<%=cid%> + "/" + fileName_<%=cid%>).exists()) {
                list_<%=cid%>.add(fileName_<%=cid%>);
            }
        }
        sourceFileNames_<%=cid%> = (String[]) list_<%=cid%>.toArray(new String[0]);
<% }%>

        if(sourceFileNames_<%=cid%>!=null && sourceFileNames_<%=cid%>.length!=0){
            scp_<%=cid%>.get(sourceFileNames_<%=cid%> , <%=localdir %>);
        }